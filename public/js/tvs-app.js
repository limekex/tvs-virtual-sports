(()=>{var P4=Object.create;var N2=Object.defineProperty;var O4=Object.getOwnPropertyDescriptor;var E4=Object.getOwnPropertyNames;var U4=Object.getPrototypeOf,I4=Object.prototype.hasOwnProperty;var G2=(t,a)=>()=>(a||t((a={exports:{}}).exports,a),a.exports);var N4=(t,a,l,i)=>{if(a&&typeof a=="object"||typeof a=="function")for(let e of E4(a))!I4.call(t,e)&&e!==l&&N2(t,e,{get:()=>a[e],enumerable:!(i=O4(a,e))||i.enumerable});return t};var q2=(t,a,l)=>(l=t!=null?P4(U4(t)):{},N4(a||!t||!t.__esModule?N2(l,"default",{value:t,enumerable:!0}):l,t));var a4=G2(M=>{"use strict";var Y1=Symbol.for("react.element"),W4=Symbol.for("react.portal"),_4=Symbol.for("react.fragment"),j4=Symbol.for("react.strict_mode"),K4=Symbol.for("react.profiler"),Q4=Symbol.for("react.provider"),$4=Symbol.for("react.context"),Y4=Symbol.for("react.forward_ref"),X4=Symbol.for("react.suspense"),J4=Symbol.for("react.memo"),t3=Symbol.for("react.lazy"),j2=Symbol.iterator;function c3(t){return t===null||typeof t!="object"?null:(t=j2&&t[j2]||t["@@iterator"],typeof t=="function"?t:null)}var $2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y2=Object.assign,X2={};function G1(t,a,l){this.props=t,this.context=a,this.refs=X2,this.updater=l||$2}G1.prototype.isReactComponent={};G1.prototype.setState=function(t,a){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,a,"setState")};G1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function J2(){}J2.prototype=G1.prototype;function Z2(t,a,l){this.props=t,this.context=a,this.refs=X2,this.updater=l||$2}var f2=Z2.prototype=new J2;f2.constructor=Z2;Y2(f2,G1.prototype);f2.isPureReactComponent=!0;var K2=Array.isArray,t4=Object.prototype.hasOwnProperty,z2={current:null},c4={key:!0,ref:!0,__self:!0,__source:!0};function r4(t,a,l){var i,e={},c=null,d=null;if(a!=null)for(i in a.ref!==void 0&&(d=a.ref),a.key!==void 0&&(c=""+a.key),a)t4.call(a,i)&&!c4.hasOwnProperty(i)&&(e[i]=a[i]);var n=arguments.length-2;if(n===1)e.children=l;else if(1<n){for(var V=Array(n),g=0;g<n;g++)V[g]=arguments[g+2];e.children=V}if(t&&t.defaultProps)for(i in n=t.defaultProps,n)e[i]===void 0&&(e[i]=n[i]);return{$$typeof:Y1,type:t,key:c,ref:d,props:e,_owner:z2.current}}function r3(t,a){return{$$typeof:Y1,type:t.type,key:a,ref:t.ref,props:t.props,_owner:t._owner}}function m2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Y1}function a3(t){var a={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(l){return a[l]})}var Q2=/\/+/g;function x2(t,a){return typeof t=="object"&&t!==null&&t.key!=null?a3(""+t.key):a.toString(36)}function o2(t,a,l,i,e){var c=typeof t;(c==="undefined"||c==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case Y1:case W4:d=!0}}if(d)return d=t,e=e(d),t=i===""?"."+x2(d,0):i,K2(e)?(l="",t!=null&&(l=t.replace(Q2,"$&/")+"/"),o2(e,a,l,"",function(g){return g})):e!=null&&(m2(e)&&(e=r3(e,l+(!e.key||d&&d.key===e.key?"":(""+e.key).replace(Q2,"$&/")+"/")+t)),a.push(e)),1;if(d=0,i=i===""?".":i+":",K2(t))for(var n=0;n<t.length;n++){c=t[n];var V=i+x2(c,n);d+=o2(c,a,l,V,e)}else if(V=c3(t),typeof V=="function")for(t=V.call(t),n=0;!(c=t.next()).done;)c=c.value,V=i+x2(c,n++),d+=o2(c,a,l,V,e);else if(c==="object")throw a=String(t),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return d}function e2(t,a,l){if(t==null)return t;var i=[],e=0;return o2(t,i,"","",function(c){return a.call(l,c,e++)}),i}function i3(t){if(t._status===-1){var a=t._result;a=a(),a.then(function(l){(t._status===0||t._status===-1)&&(t._status=1,t._result=l)},function(l){(t._status===0||t._status===-1)&&(t._status=2,t._result=l)}),t._status===-1&&(t._status=0,t._result=a)}if(t._status===1)return t._result.default;throw t._result}var $={current:null},h2={transition:null},l3={ReactCurrentDispatcher:$,ReactCurrentBatchConfig:h2,ReactCurrentOwner:z2};M.Children={map:e2,forEach:function(t,a,l){e2(t,function(){a.apply(this,arguments)},l)},count:function(t){var a=0;return e2(t,function(){a++}),a},toArray:function(t){return e2(t,function(a){return a})||[]},only:function(t){if(!m2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};M.Component=G1;M.Fragment=_4;M.Profiler=K4;M.PureComponent=Z2;M.StrictMode=j4;M.Suspense=X4;M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l3;M.cloneElement=function(t,a,l){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=Y2({},t.props),e=t.key,c=t.ref,d=t._owner;if(a!=null){if(a.ref!==void 0&&(c=a.ref,d=z2.current),a.key!==void 0&&(e=""+a.key),t.type&&t.type.defaultProps)var n=t.type.defaultProps;for(V in a)t4.call(a,V)&&!c4.hasOwnProperty(V)&&(i[V]=a[V]===void 0&&n!==void 0?n[V]:a[V])}var V=arguments.length-2;if(V===1)i.children=l;else if(1<V){n=Array(V);for(var g=0;g<V;g++)n[g]=arguments[g+2];i.children=n}return{$$typeof:Y1,type:t.type,key:e,ref:c,props:i,_owner:d}};M.createContext=function(t){return t={$$typeof:$4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Q4,_context:t},t.Consumer=t};M.createElement=r4;M.createFactory=function(t){var a=r4.bind(null,t);return a.type=t,a};M.createRef=function(){return{current:null}};M.forwardRef=function(t){return{$$typeof:Y4,render:t}};M.isValidElement=m2;M.lazy=function(t){return{$$typeof:t3,_payload:{_status:-1,_result:t},_init:i3}};M.memo=function(t,a){return{$$typeof:J4,type:t,compare:a===void 0?null:a}};M.startTransition=function(t){var a=h2.transition;h2.transition={};try{t()}finally{h2.transition=a}};M.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};M.useCallback=function(t,a){return $.current.useCallback(t,a)};M.useContext=function(t){return $.current.useContext(t)};M.useDebugValue=function(){};M.useDeferredValue=function(t){return $.current.useDeferredValue(t)};M.useEffect=function(t,a){return $.current.useEffect(t,a)};M.useId=function(){return $.current.useId()};M.useImperativeHandle=function(t,a,l){return $.current.useImperativeHandle(t,a,l)};M.useInsertionEffect=function(t,a){return $.current.useInsertionEffect(t,a)};M.useLayoutEffect=function(t,a){return $.current.useLayoutEffect(t,a)};M.useMemo=function(t,a){return $.current.useMemo(t,a)};M.useReducer=function(t,a,l){return $.current.useReducer(t,a,l)};M.useRef=function(t){return $.current.useRef(t)};M.useState=function(t){return $.current.useState(t)};M.useSyncExternalStore=function(t,a,l){return $.current.useSyncExternalStore(t,a,l)};M.useTransition=function(){return $.current.useTransition()};M.version="18.2.0"});var w2=G2((f3,i4)=>{"use strict";i4.exports=a4()});var I1=new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1";function F(...t){I1&&console.debug("[TVS]",...t)}function I(...t){console.error("[TVS]",...t)}var W2=!!(window.React&&window.ReactDOM),G4=!!(window.wp&&window.wp.element),y1=G4?window.wp.element:{},v1=W2?window.React:y1||{},f1=W2?window.ReactDOM:y1||null,p2=new WeakMap,q4=f1&&typeof f1.createRoot=="function"||y1&&typeof y1.createRoot=="function";function _2(t,a,l){try{let i=p2.get(l);if(i&&typeof i.unmount=="function"?(i.unmount(),p2.delete(l)):f1&&typeof f1.unmountComponentAtNode=="function"&&f1.unmountComponentAtNode(l),q4){let d=(f1&&f1.createRoot||y1&&y1.createRoot)(l);p2.set(l,d),d.render(v1.createElement(t,a));return}let e=f1&&f1.render||y1&&y1.render;if(e){e(v1.createElement(t,a),l);return}I("Ingen render-funksjon tilgjengelig.")}catch(i){I("Mount feilet:",i)}}function N1(t){return new Promise(a=>setTimeout(a,t))}async function C2(t,a,l="operation"){let i;try{return await Promise.race([t,new Promise((e,c)=>{i=setTimeout(()=>c(new Error(l+" timed out")),a)})])}finally{clearTimeout(i)}}function s2({React:t,currentTime:a,duration:l}){let i=t.createElement,e=Math.floor(a/60),c=Math.floor(a%60),d=(V,g)=>V+":"+(g<10?"0":"")+g,n=l>0?a/l*100:0;return i("div",{className:"tvs-progress"},i("div",{className:"tvs-progress__bar"},i("div",{className:"tvs-progress__fill",style:{width:Math.min(n,100)+"%"}})),i("div",{className:"tvs-progress__time"},d(e,c)+" / "+d(Math.floor(l/60),Math.floor(l%60))))}var q1=q2(w2(),1);var B2=q2(w2(),1),F2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},R2=B2.default.createContext&&B2.default.createContext(F2);var C3=["attr","size","title"];function e3(t,a){if(t==null)return{};var l=o3(t,a),i,e;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(e=0;e<c.length;e++)i=c[e],!(a.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(l[i]=t[i])}return l}function o3(t,a){if(t==null)return{};var l={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(a.indexOf(i)>=0)continue;l[i]=t[i]}return l}function n2(){return n2=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i])}return t},n2.apply(this,arguments)}function l4(t,a){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),l.push.apply(l,i)}return l}function v2(t){for(var a=1;a<arguments.length;a++){var l=arguments[a]!=null?arguments[a]:{};a%2?l4(Object(l),!0).forEach(function(i){h3(t,i,l[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):l4(Object(l)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(l,i))})}return t}function h3(t,a,l){return a=n3(a),a in t?Object.defineProperty(t,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[a]=l,t}function n3(t){var a=v3(t,"string");return typeof a=="symbol"?a:a+""}function v3(t,a){if(typeof t!="object"||!t)return t;var l=t[Symbol.toPrimitive];if(l!==void 0){var i=l.call(t,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function C4(t){return t&&t.map((a,l)=>q1.default.createElement(a.tag,v2({key:l},a.attr),C4(a.child)))}function R(t){return a=>q1.default.createElement(H3,n2({attr:v2({},t.attr)},a),C4(t.child))}function H3(t){var a=l=>{var{attr:i,size:e,title:c}=t,d=e3(t,C3),n=e||l.size||"1em",V;return l.className&&(V=l.className),t.className&&(V=(V?V+" ":"")+t.className),q1.default.createElement("svg",n2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},l.attr,i,d,{className:V,style:v2(v2({color:t.color||l.color},l.style),t.style),height:n,width:n,xmlns:"http://www.w3.org/2000/svg"}),c&&q1.default.createElement("title",null,c),t.children)};return R2!==void 0?q1.default.createElement(R2.Consumer,null,l=>a(l)):a(F2)}function e4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"},child:[]}]})(t)}function o4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"},child:[]}]})(t)}function H2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.5374 19.5674C16.7844 21.0831 14.4993 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 14.1361 21.3302 16.1158 20.1892 17.7406L17 12H20C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C14.1502 20 16.1022 19.1517 17.5398 17.7716L18.5374 19.5674Z"},child:[]}]})(t)}function A2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7 19V13H17V19H19V7.82843L16.1716 5H5V19H7ZM4 3H17L21 7V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM9 15V19H15V15H9Z"},child:[]}]})(t)}function h4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM8 7H16V9H8V7ZM8 11H16V13H8V11ZM8 15H16V17H8V15Z"},child:[]}]})(t)}function n4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM16.5 7.5L10 10L7.5 16.5L14 14L16.5 7.5ZM12 13C11.4477 13 11 12.5523 11 12C11 11.4477 11.4477 11 12 11C12.5523 11 13 11.4477 13 12C13 12.5523 12.5523 13 12 13Z"},child:[]}]})(t)}function v4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM15.5 8.5L13.5 13.5L8.5 15.5L10.5 10.5L15.5 8.5Z"},child:[]}]})(t)}function H4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 20.8995L16.9497 15.9497C19.6834 13.2161 19.6834 8.78392 16.9497 6.05025C14.2161 3.31658 9.78392 3.31658 7.05025 6.05025C4.31658 8.78392 4.31658 13.2161 7.05025 15.9497L12 20.8995ZM12 23.7279L5.63604 17.364C2.12132 13.8492 2.12132 8.15076 5.63604 4.63604C9.15076 1.12132 14.8492 1.12132 18.364 4.63604C21.8787 8.15076 21.8787 13.8492 18.364 17.364L12 23.7279ZM12 13C13.1046 13 14 12.1046 14 11C14 9.89543 13.1046 9 12 9C10.8954 9 10 9.89543 10 11C10 12.1046 10.8954 13 12 13ZM12 15C9.79086 15 8 13.2091 8 11C8 8.79086 9.79086 7 12 7C14.2091 7 16 8.79086 16 11C16 13.2091 14.2091 15 12 15Z"},child:[]}]})(t)}function S2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M9.82986 8.78986L7.99998 9.45588V13H5.99998V8.05H6.015L11.2834 6.13247C11.5274 6.03855 11.7922 5.99162 12.0648 6.0008C13.1762 6.02813 14.1522 6.75668 14.4917 7.82036C14.678 8.40431 14.848 8.79836 15.0015 9.0025C15.9138 10.2155 17.3653 11 19 11V13C16.8253 13 14.8823 12.0083 13.5984 10.4526L12.9008 14.4085L15 16.17V23H13V17.1025L10.7307 15.1984L10.003 19.3253L3.10938 18.1098L3.45667 16.1401L8.38071 17.0084L9.82986 8.78986ZM13.5 5.5C12.3954 5.5 11.5 4.60457 11.5 3.5C11.5 2.39543 12.3954 1.5 13.5 1.5C14.6046 1.5 15.5 2.39543 15.5 3.5C15.5 4.60457 14.6046 5.5 13.5 5.5Z"},child:[]}]})(t)}function d2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18 7H22V9H16V3H18V7ZM8 9H2V7H6V3H8V9ZM18 17V21H16V15H22V17H18ZM8 15V21H6V17H2V15H8Z"},child:[]}]})(t)}function V2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 3V5H4V9H2V3H8ZM2 21V15H4V19H8V21H2ZM22 21H16V19H20V15H22V21ZM22 9H20V5H16V3H22V9Z"},child:[]}]})(t)}function d4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM9 9H11V15H9V9ZM13 9H15V15H13V9Z"},child:[]}]})(t)}function y2(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM10.6219 8.41459L15.5008 11.6672C15.6846 11.7897 15.7343 12.0381 15.6117 12.2219C15.5824 12.2658 15.5447 12.3035 15.5008 12.3328L10.6219 15.5854C10.4381 15.708 10.1897 15.6583 10.0672 15.4745C10.0234 15.4088 10 15.3316 10 15.2526V8.74741C10 8.52649 10.1791 8.34741 10.4 8.34741C10.479 8.34741 10.5562 8.37078 10.6219 8.41459Z"},child:[]}]})(t)}function V4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 18.4142L21.1925 22.6067L22.6067 21.1925L2.80769 1.39349L1.39348 2.80771L2.58579 4.00001H2C1.44772 4.00001 1 4.44773 1 5.00001V19C1 19.5523 1.44772 20 2 20H16C16.5523 20 17 19.5523 17 19V18.4142ZM15 16.4142V18H3V6.00001H4.58579L15 16.4142ZM23 18.0397C23 18.2517 22.875 18.4176 22.7083 18.4943L21 16.786V8.84133L17 11.6413V12.786L15 10.786V6.00001H10.214L8.21402 4.00001H16C16.5523 4.00001 17 4.44773 17 5.00001V9.20001L22.2133 5.55073C22.5447 5.31876 23 5.55583 23 5.96034V18.0397Z"},child:[]}]})(t)}function L4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 9.2L22.2133 5.55071C22.4395 5.39235 22.7513 5.44737 22.9096 5.6736C22.9684 5.75764 23 5.85774 23 5.96033V18.0397C23 18.3158 22.7761 18.5397 22.5 18.5397C22.3974 18.5397 22.2973 18.5081 22.2133 18.4493L17 14.8V19C17 19.5523 16.5523 20 16 20H2C1.44772 20 1 19.5523 1 19V5C1 4.44772 1.44772 4 2 4H16C16.5523 4 17 4.44772 17 5V9.2ZM17 12.3587L21 15.1587V8.84131L17 11.6413V12.3587ZM3 6V18H15V6H3Z"},child:[]}]})(t)}function g4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"},child:[]}]})(t)}function u4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 11V13H19V11H5Z"},child:[]}]})(t)}function M4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748ZM10 10V7H12V10H15V12H12V15H10V12H7V10H10Z"},child:[]}]})(t)}function p4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748ZM7 10H15V12H7V10Z"},child:[]}]})(t)}function s4(t){return R({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 22C4 17.5817 7.58172 14 12 14C16.4183 14 20 17.5817 20 22H18C18 18.6863 15.3137 16 12 16C8.68629 16 6 18.6863 6 22H4ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11Z"},child:[]}]})(t)}function D2(){let t=v1.createElement;return t("div",{className:"tvs-loading",role:"status","aria-live":"polite"},t("svg",{viewBox:"0 0 64 64",className:"tvs-runner","aria-hidden":"true"},t("line",{x1:4,y1:60,x2:60,y2:60,stroke:"#bbb",strokeWidth:2,className:"track"}),t("circle",{cx:26,cy:12,r:5,fill:"none",stroke:"#111",strokeWidth:2}),t("line",{x1:26,y1:17,x2:26,y2:35,stroke:"#111",strokeWidth:2}),t("line",{x1:26,y1:22,x2:40,y2:18,stroke:"#111",strokeWidth:2,className:"arm front",style:{transformOrigin:"26px 22px"}}),t("line",{x1:26,y1:22,x2:12,y2:26,stroke:"#111",strokeWidth:2,className:"arm back",style:{transformOrigin:"26px 22px"}}),t("line",{x1:26,y1:35,x2:40,y2:48,stroke:"#111",strokeWidth:2,className:"leg front",style:{transformOrigin:"26px 35px"}}),t("line",{x1:26,y1:35,x2:16,y2:54,stroke:"#111",strokeWidth:2,className:"leg back",style:{transformOrigin:"26px 35px"}})),t("div",null,t("div",{className:"tvs-skel line"}),t("div",{className:"tvs-skel line sm"}),t("div",null,t("span",{className:"tvs-skel block"}),t("span",{className:"tvs-skel block"}),t("span",{className:"tvs-skel block"}))))}function b2({React:t,routeId:a,lastStatus:l,lastError:i,currentTime:e,duration:c}){let{useEffect:d,useRef:n,useState:V,createElement:g}=t;function N(A){let{useEffect:_,useRef:X,useState:k}=A,[d1,S]=k(0),q=X(performance.now()),t1=X(0);return _(()=>{let i1,P=D1=>{t1.current+=1,D1-q.current>=1e3&&(S(t1.current),t1.current=0,q.current=D1),i1=requestAnimationFrame(P)};return i1=requestAnimationFrame(P),()=>cancelAnimationFrame(i1)},[]),d1}let D=N(t),z1=n(null),[Y,H1]=V(!1),[E,J1]=V({x:16,y:16});d(()=>{if(!z1.current)return;let _,X,k,d1,S=!1;function q(P){P.target.closest(".tvs-dev__header")&&(S=!0,_=P.clientX,X=P.clientY,k=E.x,d1=E.y,P.preventDefault())}function t1(P){S&&J1({x:k+(P.clientX-_),y:d1+(P.clientY-X)})}function i1(){S=!1}return window.addEventListener("mousedown",q),window.addEventListener("mousemove",t1),window.addEventListener("mouseup",i1),()=>{window.removeEventListener("mousedown",q),window.removeEventListener("mousemove",t1),window.removeEventListener("mouseup",i1)}},[E]);let J=c>0?(e/c*100).toFixed(1):"0.0",G={env:window.TVS_SETTINGS?.env,version:window.TVS_SETTINGS?.version,restRoot:window.TVS_SETTINGS?.restRoot,user:window.TVS_SETTINGS?.user,routeId:a,lastStatus:l||"idle",lastError:i?String(i):null,currentTime:e?e.toFixed(1):"0.0",duration:c||0,progress:J+"%",fps:D};function x(A,_,X){return g("div",{className:"tvs-dev__row"},g("span",null,A),g("code",{className:X?"tvs-dev__err":""},_))}function W1(){navigator.clipboard.writeText(JSON.stringify({...G,time:new Date().toISOString()},null,2)).catch(console.error)}return g("div",{ref:z1,className:`tvs-dev ${Y?"is-min":""}`,style:{left:E.x+"px",top:E.y+"px"}},g("div",{className:"tvs-dev__header"},g("strong",null,"TVS Dev"),g("div",{className:"tvs-dev__spacer"}),g("span",{className:"tvs-dev__pill"},G.env||"n/a"),g("button",{className:"tvs-dev__btn",onClick:()=>H1(!Y),"aria-label":"Minimize"},"\u2581")),g("div",{className:"tvs-dev__body"},x("Route",G.routeId??"n/a"),x("User",G.user??"guest"),x("REST",G.restRoot??"n/a"),x("Status",G.lastStatus),G.lastError?x("Error",G.lastError,!0):null,x("Duration",G.duration+"s"),x("Current",G.currentTime+"s"),x("Progress",G.progress),x("FPS",String(G.fps)),g("div",{className:"tvs-dev__actions"},g("button",{onClick:W1,className:"tvs-dev__btn"},"Copy debug"),g("button",{onClick:()=>{localStorage.setItem("tvsDev","0"),location.reload()},className:"tvs-dev__btn tvs-dev__btn--ghost"},"Disable"))))}function x4(t){return R({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 320h-96c-17.6 0-32-14.4-32-32s14.4-32 32-32h96s96-107 96-160-43-96-96-96-96 43-96 96c0 25.5 22.2 63.4 45.3 96H320c-52.9 0-96 43.1-96 96s43.1 96 96 96h96c17.6 0 32 14.4 32 32s-14.4 32-32 32H185.5c-16 24.8-33.8 47.7-47.3 64H416c52.9 0 96-43.1 96-96s-43.1-96-96-96zm0-256c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zM96 256c-53 0-96 43-96 96s96 160 96 160 96-107 96-160-43-96-96-96zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(t)}function Z4(t){return R({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"},child:[]}]})(t)}var f4={FaLandmark:"\u{1F3DB}\uFE0F",FaTheaterMasks:"\u{1F3AD}",FaFortAwesome:"\u{1F3F0}",FaChurch:"\u26EA",FaTrain:"\u{1F689}",FaTree:"\u{1F333}",FaMountain:"\u{1F3D4}\uFE0F",FaWater:"\u{1F4A7}",FaBridge:"\u{1F309}",FaMonument:"\u{1F5FF}",FaUniversity:"\u{1F393}",FaHospital:"\u{1F3E5}",FaStore:"\u{1F3EA}",FaCoffee:"\u2615",FaCamera:"\u{1F4F7}"};function k2({routeData:t,routeId:a}){let{useEffect:l,useState:i,useRef:e,createElement:c}=v1,d=new URLSearchParams(window.location.search).get("debug")==="1";function n(...r){d&&console.log(...r)}function V(r,h="success"){typeof window.tvsFlash=="function"&&window.tvsFlash(r,h)}let[g,N]=i(!0),[D,z1]=i(12),[Y,H1]=i(!1),[E,J1]=i(!0),[J,G]=i(!0),[x,W1]=i(!0),[A,_]=i(null),[X,k]=i(0),[d1,S]=i(0),[q,t1]=i(0),[i1,P]=i(0),[D1,u1]=i(0),[m1,_1]=i(!1),[T1,l1]=i(!1),[j1,b1]=i(""),[V1,P1]=i(""),[w1,B1]=i(!1),[C1,t2]=i("Run"),F1=e(null),p=e(null),c1=e(null),w=e(null),c2=e(null),r2=e(null),P2=e(null),e1=e(E),K1=e(J),a2=e(D),O1=e(null),r1=e(null),a1=e(null),R1=e(0),j=e(null),k1=e(null),M1=e(null),C=e(null),o=e(null),Z=e(null),[T,B]=i([]),[A1,o1]=i(!1),K=r=>{M1.current&&(clearTimeout(M1.current),M1.current=null),r===null&&k1.current!==null?(o1(!0),M1.current=setTimeout(()=>{k1.current=null,_(null),o1(!1)},300)):(o1(!1),k1.current=r,_(r))},h1=t?.meta?.gpx_url||"",S1=t?.title||"Route",p1=t?.mapbox_token||"",[Q1,O2]=i(0),s1=Q1>0?Q1:t?.meta?.distance_km||0,L2=s1>0&&D>0?Math.round(s1/D*60):0;l(()=>{e1.current=E},[E]),l(()=>{K1.current=J},[J]),l(()=>{a2.current=D},[D]);function $1(r,h,L,H){let s=(L-r)*Math.PI/180,v=(H-h)*Math.PI/180,u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(r*Math.PI/180)*Math.cos(L*Math.PI/180)*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}function m4(r,h,L,H){let O=(H-h)*Math.PI/180,s=Math.sin(O)*Math.cos(L*Math.PI/180),v=Math.cos(r*Math.PI/180)*Math.sin(L*Math.PI/180)-Math.sin(r*Math.PI/180)*Math.cos(L*Math.PI/180)*Math.cos(O);return(Math.atan2(s,v)*180/Math.PI+360)%360}function w4(r,h,L,H){if(!L||L.length===0)return 0;let O=0,s=1/0;L.forEach((u,L1)=>{let Q=$1(u.lat,u.lng,h,r);Q<s&&(s=Q,O=L1)});let v=0;for(let u=0;u<O&&u<L.length-1;u++)v+=$1(L[u].lat,L[u].lng,L[u+1].lat,L[u+1].lng);return v}l(()=>{!a||j.current||(async()=>{try{n("\u{1F4CA} Pre-loading route distance for routeId:",a);let r=await fetch(`/wp-json/tvs/v1/routes/${a}/gpx-data`);if(!r.ok){console.error("\u274C Failed to pre-fetch GPX data:",r.status,r.statusText);return}let h=await r.json();if(!h.points||h.points.length===0){console.error("\u274C No GPS points in GPX data");return}j.current=h;let L=0;for(let H=0;H<h.points.length-1;H++)L+=$1(h.points[H].lat,h.points[H].lng,h.points[H+1].lat,h.points[H+1].lng);n("\u2705 Pre-calculated distance:",L.toFixed(2),"km"),O2(L)}catch(r){console.error("\u274C Failed to pre-load distance:",r)}})()},[a]),l(()=>{a&&(n("\u{1F4CD} Fetching PoI data..."),(async()=>{try{let r=await fetch(`/wp-json/tvs/v1/routes/${a}/pois`);if(!r.ok){n("\u26A0\uFE0F No PoI data available:",r.status);return}let h=await r.json();n("\u2705 Loaded PoIs:",h.length,"items");let L=h.map(H=>({id:H.id,name:H.name,description:H.description||"",triggerDistanceMeters:H.trigger_distance_m||150,hideDistanceMeters:H.hide_distance_m||100,lng:H.lng,lat:H.lat,icon:H.icon||"\u{1F4CD}",color:H.color||"#8b5cf6",imageUrl:H.image_url||null,imageThumbnail:H.image_thumbnail||null,customIconUrl:H.custom_icon_url||null,iconType:H.icon_type||"library"}));B(L)}catch(r){console.error("\u274C Failed to load PoI data:",r)}})())},[a]),l(()=>()=>{M1.current&&clearTimeout(M1.current)},[]),l(()=>{if(!o.current||!j.current?.points){d&&console.log("Elevation chart: missing canvas or GPX data",{hasCanvas:!!o.current,hasGpxData:!!j.current,hasPoints:!!j.current?.points});return}let r=o.current,h=r.getContext("2d"),L=j.current.points;d&&console.log("Drawing elevation chart with",L.length,"points");let H=r.width,O=r.height;h.clearRect(0,0,H,O);let s=L.map(Q=>Q.ele||0).filter(Q=>Q>0);if(s.length===0){d&&console.log("No elevation data found in GPX points");return}d&&console.log("Elevation range:",Math.min(...s),"-",Math.max(...s));let v=Math.min(...s),L1=Math.max(...s)-v;if(L1===0){d&&console.log("Elevation range is 0, cannot draw chart");return}h.beginPath(),h.strokeStyle="#667eea",h.lineWidth=2,h.fillStyle="rgba(102, 126, 234, 0.2)",L.forEach((Q,x1)=>{if(!Q.ele)return;let m=x1/(L.length-1)*H,f=O-(Q.ele-v)/L1*O;x1===0?h.moveTo(m,f):h.lineTo(m,f)}),h.lineTo(H,O),h.lineTo(0,O),h.closePath(),h.fill(),h.beginPath(),L.forEach((Q,x1)=>{if(!Q.ele)return;let m=x1/(L.length-1)*H,f=O-(Q.ele-v)/L1*O;x1===0?h.moveTo(m,f):h.lineTo(m,f)}),h.stroke(),d&&console.log("Elevation chart drawn successfully")},[g]),l(()=>{if(!g){if(!h1||!window.mapboxgl||!F1.current||!p1){n("\u23F3 Waiting for map initialization:",{gpxUrl:!!h1,mapboxgl:!!window.mapboxgl,mapRef:!!F1.current,mapboxToken:!!p1,isWelcome:g});return}return n("\u{1F5FA}\uFE0F Initializing map..."),(async()=>{try{let r=j.current;if(r)n("\u267B\uFE0F Using cached GPX data");else{n("\u{1F4E5} Fetching GPX data from REST endpoint...");let L=await fetch(`/wp-json/tvs/v1/routes/${a}/gpx-data`);if(!L.ok){console.error("\u274C Failed to fetch GPX data:",L.status,L.statusText),V("Failed to load route data. Please refresh the page.","error");return}r=await L.json(),j.current=r}if(n("\u{1F4E6} GPX data ready:",{points:r.points?.length,first:r.points?.[0],last:r.points?.[r.points?.length-1],gpxUrl:h1}),!r.points||r.points.length===0){console.error("\u274C No GPS points in GPX data"),V("No GPS data found for this route.","error");return}if(Q1===0){let L=0;for(let H=0;H<r.points.length-1;H++)L+=$1(r.points[H].lat,r.points[H].lng,r.points[H+1].lat,r.points[H+1].lng);n("\u2705 Calculated distance during map init:",L.toFixed(2),"km"),O2(L)}window.mapboxgl.accessToken=p1;let h=new window.mapboxgl.Map({container:F1.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[r.points[0].lng,r.points[0].lat],zoom:14,pitch:60,bearing:0});p.current=h,h.on("load",()=>{n("\u{1F6E0}\uFE0F Map loaded, attempting to create GSAP timeline...");let L=r.points.map(s=>[s.lng,s.lat]);h.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:L}}}),h.addLayer({id:"route-line",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ec4899","line-width":6,"line-opacity":1}}),r2.current="route-line",h.addSource("completed-route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[r.points[0].lng,r.points[0].lat]]}}}),h.addLayer({id:"completed-route-line",type:"line",source:"completed-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#84cc16","line-width":6,"line-opacity":1}}),c2.current="completed-route-line";let H=document.createElement("div");H.className="virtual-training-marker",H.style.width="20px",H.style.height="20px",H.style.borderRadius="50%",H.style.backgroundColor="#ff0000",H.style.border="3px solid white",H.style.boxShadow="0 0 10px rgba(0,0,0,0.5)";let O=new window.mapboxgl.Marker(H).setLngLat([r.points[0].lng,r.points[0].lat]).addTo(h);if(c1.current=O,T.forEach(s=>{let v=document.createElement("div");if(v.className="poi-marker",v.style.width="40px",v.style.height="40px",v.style.borderRadius="50%",v.style.backgroundColor=s.color||"#8b5cf6",v.style.border="3px solid white",v.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",v.style.display="flex",v.style.alignItems="center",v.style.justifyContent="center",v.style.cursor="pointer",s.iconType==="custom"&&s.customIconUrl){v.style.fontSize="0",v.style.padding="6px";let u=document.createElement("img");u.src=s.customIconUrl,u.style.width="100%",u.style.height="100%",u.style.objectFit="contain",u.style.filter="drop-shadow(0 1px 2px rgba(0,0,0,0.3))",v.appendChild(u)}else{let u=f4[s.icon]||s.icon||"\u{1F4CD}";v.style.fontSize="20px",v.style.textShadow="0 1px 2px rgba(0,0,0,0.3)",v.innerHTML=u}new window.mapboxgl.Marker(v).setLngLat([s.lng,s.lat]).addTo(h)}),window.gsap){!r.points||r.points.length<2?console.warn("\u274C Not enough route points for animation!"):n("\u2705 Enough route points, initializing smooth timeline...",r.points.length);let s=r.distance_km/D*3600;n("\u{1F552} Timeline duration (s):",s);let v=[0];for(let m=1;m<r.points.length;m++){let f=$1(r.points[m-1].lat,r.points[m-1].lng,r.points[m].lat,r.points[m].lng);v.push(v[m-1]+f)}let u=v[v.length-1];n("\u{1F4CF} Total distance from points:",u.toFixed(3),"km");let L1={lng:r.points[0].lng,lat:r.points[0].lat},Q={bearing:0},x1=window.gsap.timeline({paused:!0,onUpdate:()=>{let m=x1.progress()*u,f=0;for(let z=0;z<v.length-1;z++)if(m>=v[z]&&m<=v[z+1]){f=z;break}let l2=0;if(f<v.length-1){let z=v[f],y=v[f+1]-z;y>0&&(l2=(m-z)/y)}let E1,U1;if(f<r.points.length-1?(E1=r.points[f].lng+(r.points[f+1].lng-r.points[f].lng)*l2,U1=r.points[f].lat+(r.points[f+1].lat-r.points[f].lat)*l2):(E1=r.points[r.points.length-1].lng,U1=r.points[r.points.length-1].lat),c1.current&&c1.current.setLngLat([E1,U1]),K1.current&&f<r.points.length-1){let b=Math.min(m+.02,u),y=f;for(let W=f;W<v.length-1;W++)if(b>=v[W]&&b<=v[W+1]){y=W;break}let n1=0;if(y<v.length-1){let W=v[y],I2=v[y+1]-W;I2>0&&(n1=(b-W)/I2)}let Z1,U;y<r.points.length-1?(Z1=r.points[y].lng+(r.points[y+1].lng-r.points[y].lng)*n1,U=r.points[y].lat+(r.points[y+1].lat-r.points[y].lat)*n1):(Z1=r.points[r.points.length-1].lng,U=r.points[r.points.length-1].lat);let g1=m4(U1,E1,U,Z1);if(C.current!==null){let W=g1-C.current;W>180&&(W-=360),W<-180&&(W+=360),g1=C.current+W*.15}Q.bearing=g1,C.current=g1}e1.current&&p.current&&p.current.jumpTo({center:[E1,U1],bearing:K1.current?Q.bearing:0});let u2=r.points.slice(0,f+1).map(z=>[z.lng,z.lat]);if(u2.push([E1,U1]),u2.length>0&&p.current&&p.current.getSource("completed-route")?.setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:u2}}),k(m),Z.current&&u>0){let z=m/u*100;Z.current.style.left=`${z}%`,d&&Math.random()<.01&&console.log("Marker position:",z.toFixed(2)+"%")}if(r.points[f]?.ele!==void 0){let z=r.points[f].ele;f<r.points.length-1&&r.points[f+1]?.ele!==void 0&&(z=r.points[f].ele+(r.points[f+1].ele-r.points[f].ele)*l2),S(Math.round(z));let y=Math.min(m+.2,u),n1=0,Z1=0;for(let U=f;U<r.points.length-1;U++){let g1=v[U],W=v[U+1];if(g1>y)break;W<=y&&r.points[U]?.ele!==void 0&&r.points[U+1]?.ele!==void 0&&(n1+=r.points[U+1].ele-r.points[U].ele,Z1++)}if(Z1>0){let U=(y-m)*1e3;if(U>0){let g1=n1/U*100;t1(Math.round(g1))}}}let M2=0;r1.current&&(M2=(Date.now()-r1.current-R1.current)/1e3,P(M2));let T4=u-m,U2=a2.current;if(U2>0){let z=T4/U2*3600,b=M2+z;u1(b)}T.forEach(z=>{let b=w4(z.lng,z.lat,r.points,f),y=(z.triggerDistanceMeters||150)/1e3,n1=(z.hideDistanceMeters||100)/1e3,Z1=m>=b-y&&m<=b,U=m>b&&m<=b+n1,g1=m>b+n1;Z1||U?k1.current?.id!==z.id&&(n("\u2705 Showing PoI:",z.name,{currentDist:m.toFixed(2),poiDist:b.toFixed(2),phase:Z1?"approaching":"passed",triggerRange:`${(b-y).toFixed(2)} - ${b.toFixed(2)}`,hideRange:`${b.toFixed(2)} - ${(b+n1).toFixed(2)}`}),K(z)):k1.current?.id===z.id&&g1&&(n("\u274C Hiding PoI:",z.name,{currentDist:m.toFixed(2),poiDist:b.toFixed(2),hideThreshold:(b+n1).toFixed(2)}),K(null))})}});x1.to(L1,{lng:r.points[r.points.length-1].lng,lat:r.points[r.points.length-1].lat,duration:s,ease:"none"},0),w.current=x1,O1.current=D,n("\u{1F3AC} GSAP smooth timeline created:",{keyframes:1}),n("\u{1F4CD} timelineRef.current set:",!!w.current),n("\u26A1 Initial speed stored:",D)}})}catch(r){console.error("\u274C Failed to load GPX data:",r),V("Error loading route data: "+r.message,"error")}})(),()=>{p.current&&p.current.remove(),w.current&&w.current.kill()}}},[h1,a,p1,g]);function B4(){n("\u25B6\uFE0F Start Training clicked"),n("  - Timeline exists:",!!w.current),n("  - Map exists:",!!p.current),n("  - Marker exists:",!!c1.current),n("  - GSAP available:",!!window.gsap),N(!1);let r=s1/D*3600;u1(r),setTimeout(()=>{w.current&&i2()},100)}function i2(){if(w.current){if(Y)w.current.pause(),a1.current=Date.now(),V("Activity paused");else if(r1.current){if(a1.current){let r=Date.now()-a1.current;R1.current+=r,a1.current=null,V("Activity resumed")}w.current.play()}else if(r1.current=Date.now(),R1.current=0,V("Activity started"),n("\u{1F3AC} First play detected, preparing flyTo..."),n("  - Map instance:",!!p.current),n("  - Marker:",!!c1.current),n("  - Timeline:",!!w.current),p.current&&c1.current&&w.current){let r=c1.current.getLngLat();n("\u2708\uFE0F Starting flyTo animation (2s):",{lng:r.lng,lat:r.lat,zoom:16,currentZoom:p.current.getZoom()}),w.current.pause(),p.current.flyTo({center:[r.lng,r.lat],zoom:16,pitch:60,duration:2e3,essential:!0}),setTimeout(()=>{w.current&&(n("\u25B6\uFE0F Starting timeline after flyTo complete"),w.current.play())},2100)}else console.warn("\u26A0\uFE0F Cannot execute flyTo - waiting for map/marker/timeline..."),w.current&&w.current.play();H1(!Y)}}function F4(){if(!w.current)return;w.current.restart(),H1(!0),k(0),P(0),K(null),r1.current=Date.now(),a1.current=null,R1.current=0;let r=s1/a2.current*3600;u1(r),V("Activity restarted")}function R4(){if(p.current){let r=e1.current;e1.current=!1,p.current.zoomIn(),setTimeout(()=>{e1.current=r},100)}}function A4(){if(p.current){let r=e1.current;e1.current=!1,p.current.zoomOut(),setTimeout(()=>{e1.current=r},100)}}function S4(){let r=Math.min(D+1,50);if(z1(r),w.current&&O1.current){let h=r/O1.current;w.current.timeScale(h),n(`\u26A1 Speed increased to ${r} km/h (timeScale: ${h.toFixed(2)})`),V(`Speed increased to ${r} km/h`,"success")}}function y4(){let r=Math.max(D-1,1);if(z1(r),w.current&&O1.current){let h=r/O1.current;w.current.timeScale(h),n(`\u26A1 Speed decreased to ${r} km/h (timeScale: ${h.toFixed(2)})`),V(`Speed decreased to ${r} km/h`,"warning")}}function D4(){if(!p.current||!r2.current)return;let r=x?"none":"visible";p.current.setLayoutProperty("route-line","visibility",r),W1(!x)}function b4(){b1(X.toFixed(3));let r=Math.round(i1),h=Math.floor(r/3600),L=Math.floor(r%3600/60),H=r%60;h>0?P1(`${h}:${L.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`):P1(`${L}:${H.toString().padStart(2,"0")}`),l1(!0),Y&&w.current&&(w.current.pause(),a1.current=Date.now(),H1(!1))}async function k4(){if(!j1||!V1){V("Please enter both distance and time","error");return}B1(!0);try{let r=parseFloat(j1)*1e3,h;if(V1.includes(":")){let s=V1.split(":").map(v=>parseInt(v.trim())||0);if(s.length===3){let[v,u,L1]=s;h=v*3600+u*60+L1}else if(s.length===2){let[v,u]=s;h=v*60+u}else h=0}else h=parseInt(V1)||0;if(r<=0||h<=0){V("Distance and time must be greater than zero","error"),B1(!1);return}let L=new Date().toISOString(),H=await fetch("/wp-json/tvs/v1/activities",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||""},body:JSON.stringify({route_id:a,route_name:S1,activity_date:L,started_at:L,ended_at:L,duration_s:h,distance_m:r,visibility:"private",activity_type:C1,is_virtual:!0})});if(!H.ok){let s=await H.json().catch(()=>({}));throw new Error(s.message||"Failed to save activity")}let O=await H.json();n("\u2705 Activity saved:",O),l1(!1),B1(!1),w.current&&(w.current.pause(),w.current.progress(0)),N(!0),H1(!1),k(0),P(0),u1(0),K(null),r1.current=null,a1.current=null,R1.current=0,V("Activity saved successfully! \u{1F389}","success"),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(r){console.error("Failed to save activity:",r),V("Failed to save activity: "+(r?.message||"Unknown error"),"error"),B1(!1)}}function E2(){let r=document.querySelector(".tvs-virtual-training");r&&(m1?(document.exitFullscreen&&document.exitFullscreen(),_1(!1)):(r.requestFullscreen&&r.requestFullscreen(),_1(!0)))}l(()=>{function r(){_1(!!document.fullscreenElement)}return document.addEventListener("fullscreenchange",r),()=>document.removeEventListener("fullscreenchange",r)},[]),l(()=>{function r(h){(h.key==="f"||h.key==="F")&&(g||E2())}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[g,m1]);function g2(r){let h=Math.floor(r/60),L=Math.floor(r%60);return`${h}:${L.toString().padStart(2,"0")}`}return g?p1?c("div",{className:"tvs-virtual-training tvs-virtual-training--welcome"},c("div",{className:"tvs-panel tvs-welcome-panel"},c("h2",{className:"tvs-welcome-title"},S1),c("div",{className:"tvs-welcome-stats"},c("div",{className:"tvs-stat-card"},c("span",{className:"tvs-stat-label"},"Distance"),c("span",{className:"tvs-stat-value"},s1>0?`${s1.toFixed(2)} km`:"Loading...")),c("div",{className:"tvs-stat-card"},c("span",{className:"tvs-stat-label"},"Est. Duration"),c("span",{className:"tvs-stat-value"},L2>0?`${L2} min`:"--"))),c("div",{className:"tvs-speed-section"},c("label",{className:"tvs-speed-label"},c("span",{className:"tvs-speed-title"},"Set your initial speed"),c("span",{className:"tvs-speed-hint"},"You can increase/decrease during the activity according to your treadmill speed")),c("div",{className:"tvs-speed-input-group"},c("input",{type:"number",className:"tvs-input tvs-speed-input",value:D,onChange:r=>z1(Number(r.target.value)||12),min:1,max:50,step:.5}),c("span",{className:"tvs-speed-unit"},"km/h"))),c("button",{className:"tvs-btn tvs-btn--primary tvs-welcome-btn",onClick:B4,disabled:s1<=0},s1>0?"Start Training":"Loading route data..."))):c("div",{className:"tvs-virtual-training tvs-virtual-training--welcome"},c("div",{className:"virtual-training-welcome"},c("h2",null,"\u26A0\uFE0F Configuration Required"),c("p",{style:{color:"#e53e3e",marginBottom:"1rem"}},"Mapbox access token is missing. Please configure it in TVS Settings."),c("p",null,"Administrators: Go to TVS \u2192 Settings and add your Mapbox token."))):c("div",{className:`tvs-virtual-training ${m1?"tvs-virtual-training--fullscreen":""}`},c("div",{ref:F1,className:"virtual-training-map",style:{width:"100%",height:m1?"calc(100vh - 80px)":"70vh"}}),c("div",{className:"training-stats"},c("div",{className:"stat-item"},c("span",{className:"stat-label"},"Distance"),c("span",{className:"stat-value"},`${g?"0.00":X.toFixed(2)} / ${s1.toFixed(2)} km`)),c("div",{className:"stat-item"},c("span",{className:"stat-label"},"Time"),c("span",{className:"stat-value"},`${g?"0:00":g2(i1)} / ${g2(g?L2*60:D1)}`)),c("div",{className:"stat-item"},c("span",{className:"stat-label"},"Speed"),c("span",{className:"stat-value"},`${D} km/h`)),c("div",{className:"stat-item"},c("span",{className:"stat-label"},"Elevation"),c("span",{className:"stat-value"},`${d1} m`)),c("div",{className:"stat-item"},c("span",{className:"stat-label"},"Gradient"),c("span",{className:"stat-value",style:{color:q>0?"#f56565":q<0?"#48bb78":"white"}},`${q>0?"+":""}${q}%`)),c("div",{className:"elevation-chart-container"},c("canvas",{ref:o,className:"elevation-chart",width:300,height:80}),c("div",{ref:Z,className:"elevation-marker",style:{left:"0%"}}))),!Y&&!g&&c("div",{className:"training-overlay-start",onClick:i2},c("div",{className:"overlay-content"},c("button",{className:"overlay-play-btn",onClick:i2},c(y2,{size:64})),c("div",{style:{fontSize:20,fontWeight:600,marginTop:16}},"Push play to start"))),A&&c("div",{className:`poi-popup tvs-panel tvs-panel--elevated${A1?" poi-popup--hiding":""}`},A.imageThumbnail&&c("div",{className:"poi-image"},c("img",{src:A.imageThumbnail,alt:A.name})),c("div",{className:"poi-content"},c("div",{className:"poi-header"},A.iconType==="custom"&&A.customIconUrl?c("div",{className:"poi-icon poi-icon-custom",style:{backgroundColor:A.color||"#8b5cf6"}},c("img",{src:A.customIconUrl,alt:"Icon",style:{width:"100%",height:"100%",objectFit:"contain",filter:"brightness(0) invert(1)"}})):c("div",{className:"poi-icon",style:{backgroundColor:A.color||"#8b5cf6"}},f4[A.icon]||A.icon||"\u{1F4CD}"),c("h3",{className:"poi-title"},A.name)),A.description&&c("p",{className:"poi-description"},A.description))),c("div",{className:"training-controls"},c("button",{className:"control-btn",onClick:i2,title:Y?"Pause":"Play"},c(Y?d4:y2,{size:24})),c("button",{className:"control-btn",onClick:y4,title:"Decrease Speed"},c(u4,{size:24})),c("button",{className:"control-btn",onClick:S4,title:"Increase Speed"},c(g4,{size:24})),c("button",{className:"control-btn",onClick:A4,title:"Zoom Out"},c(p4,{size:24})),c("button",{className:"control-btn",onClick:R4,title:"Zoom In"},c(M4,{size:24})),c("button",{className:`control-btn ${E?"active":""}`,onClick:()=>J1(!E),title:E?"Camera Follow On":"Camera Follow Off"},c(E?L4:V4,{size:24})),c("button",{className:`control-btn ${J?"active":""}`,onClick:()=>G(!J),title:J?"Compass Mode On":"Compass Mode Off",disabled:!E},c(J?n4:v4,{size:24})),c("button",{className:`control-btn ${x?"active":""}`,onClick:D4,title:x?"Hide Route Line":"Show Route Line"},c(x4,{size:20})),c("button",{className:"control-btn",onClick:F4,title:"Restart"},c(H2,{size:24})),c("button",{className:"control-btn save-btn",onClick:b4,title:"Save Activity",disabled:g||X<.1},c(Z4,{size:24})),c("button",{className:"control-btn",onClick:E2,title:m1?"Exit Fullscreen":"Fullscreen"},c(m1?d2:V2,{size:24}))),T1&&c("div",{className:"save-modal-overlay",onClick:()=>l1(!1)},c("div",{className:"save-modal",onClick:r=>r.stopPropagation()},c("h3",null,"\u{1F4BE} Save Activity"),c("p",null,`Enter actual data from your ${C1==="Ride"?"bike/trainer":"treadmill"}:`),c("div",{className:"modal-field"},c("label",null,"Activity Type"),c("div",{className:"activity-type-selector",style:{display:"flex",gap:"8px",marginTop:"8px"}},["Walk","Run","Ride"].map(r=>c("button",{key:r,type:"button",className:`activity-type-btn ${C1===r?"active":""}`,onClick:()=>t2(r),style:{flex:1,padding:"12px",border:C1===r?"2px solid #3b82f6":"2px solid #e5e7eb",borderRadius:"8px",background:C1===r?"#eff6ff":"white",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",transition:"all 0.2s"}},c("span",{style:{fontSize:"24px"}},r==="Walk"?"\u{1F6B6}":r==="Run"?"\u{1F3C3}":"\u{1F6B4}"),c("span",{style:{fontSize:"14px",fontWeight:C1===r?"600":"400"}},r))))),c("div",{className:"modal-field"},c("label",null,"Distance (km)"),c("input",{type:"text",value:j1,onChange:r=>b1(r.target.value),placeholder:"8.234"}),c("small",{style:{color:"#718096",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"}},"Supports decimals (e.g., 8.234 km)")),c("div",{className:"modal-field"},c("label",null,"Time (H:MM:SS, MM:SS, or seconds)"),c("input",{type:"text",value:V1,onChange:r=>P1(r.target.value),placeholder:"1:23:45 or 45:23"}),c("small",{style:{color:"#718096",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"}},"Format: H:MM:SS (e.g., 1:23:45), MM:SS (e.g., 45:23), or just seconds (e.g., 2723)")),c("div",{className:"modal-buttons"},c("button",{className:"btn-secondary",onClick:()=>l1(!1),disabled:w1},"Cancel"),c("button",{className:"btn-primary",onClick:k4,disabled:w1},w1?"Saving...":"Save Activity")))))}var X1=Number(new URLSearchParams(location.search).get("tvsslow")||0);function T2({initialData:t,routeId:a}){let{useEffect:l,useState:i,useRef:e,createElement:c}=v1,[d,n]=i(t||null),[V,g]=i(null),[N,D]=i(!1),[z1,Y]=i(!1),[H1,E]=i(null),[J1,J]=i(null),[G,x]=i(t?"inline":"loading"),[W1,A]=i(null),[_,X]=i(0),[k,d1]=i(!1),[S,q]=i(!1),[t1,i1]=i(!0),[P,D1]=i(!0),[u1,m1]=i(!0),[_1,T1]=i(!1),[l1,j1]=i("Run"),[b1,V1]=i(""),[P1,w1]=i(""),[B1,C1]=i(!1),t2=e(null),F1=e(null);function p(C,o="success"){typeof window.tvsFlash=="function"&&window.tvsFlash(C,o)}l(()=>{let C=new URLSearchParams(location.search).get("tvsforcefetch")==="1";if(d&&!C){F("Har inline payload, skipper fetch.",d);return}if(!a){g("Mangler routeId \u2013 hverken inline payload eller data-route-id.");return}(async()=>{try{F("Henter rute via REST:",a," (tvsslow:",X1,"ms)"),x("loading"),X1&&await N1(X1);let Z=await(await fetch(`/wp-json/tvs/v1/routes/${encodeURIComponent(a)}`,{credentials:"same-origin"})).json();F("REST OK:",Z),n(Z),x("ok")}catch(o){I("REST FAIL:",o),g("Kunne ikke hente rutedata."),A(o?.message||String(o)),x("error")}})()},[a]),l(()=>{if(!d)return;let C=t2.current;if(!C)return;let o=null,Z=!1;function T(){return new Promise((B,A1)=>{if(window.Vimeo&&window.Vimeo.Player)return B();let o1=document.querySelector('script[src="https://player.vimeo.com/api/player.js"]');if(o1){o1.addEventListener("load",()=>B()),o1.addEventListener("error",()=>A1(new Error("Vimeo API failed to load")));return}let K=document.createElement("script");K.src="https://player.vimeo.com/api/player.js",K.async=!0,K.onload=()=>B(),K.onerror=()=>A1(new Error("Vimeo API failed to load")),document.head.appendChild(K)})}return(async()=>{try{if(await T(),Z)return;o=new window.Vimeo.Player(C),F1.current=o,F("Vimeo Player constructed"),o.getDuration().catch(()=>{});try{await o.ready(),Z||(d1(!0),F("Vimeo Player ready"))}catch(B){I("Vimeo ready() rejected:",B)}o.on("timeupdate",B=>{typeof B?.seconds=="number"&&X(B.seconds)})}catch{I("Vimeo API init failed")}})(),()=>{Z=!0;try{o&&o.off&&o.off("timeupdate"),o&&o.destroy&&o.destroy()}catch{}F1.current=null,d1(!1)}},[d]),l(()=>{async function C(Z){if((Z.key==="f"||Z.key==="F")&&Z.target.tagName!=="INPUT"&&Z.target.tagName!=="TEXTAREA"){Z.preventDefault();let T=!S;if(T&&!k){p("Please wait for video to load","warning");return}if(q(T),T){await N1(100);try{let B=document.querySelector(".tvs-app");B&&B.requestFullscreen&&await B.requestFullscreen()}catch(B){console.warn("Fullscreen not supported or denied:",B)}}else if(document.fullscreenElement)try{await document.exitFullscreen()}catch(B){console.warn("Error exiting fullscreen:",B)}}if(Z.key==="Escape"&&S&&(q(!1),document.fullscreenElement))try{await document.exitFullscreen()}catch(T){console.warn("Error exiting fullscreen:",T)}}function o(){!document.fullscreenElement&&S&&q(!1)}return window.addEventListener("keydown",C),document.addEventListener("fullscreenchange",o),()=>{window.removeEventListener("keydown",C),document.removeEventListener("fullscreenchange",o)}},[S,k]);async function c1(C=8e3){let o=Date.now();for(;Date.now()-o<C;){let Z=F1.current;if(Z)try{return await Z.ready(),d1(!0),Z}catch{}await N1(100)}throw new Error("Video player is not ready")}function w(C){let o=d?.meta||{},Z=Number(o.duration_s||0),T=Number(o.distance_m||0);if(Z>0&&T>0&&C>=0){let B=Math.min(1,C/Z);return Math.round(T*B)}return 0}async function c2(){try{D(!0),F("Start clicked");let C=await c1();x("starting");try{await C2(C.play(),4e3,"play()"),F("Playback started")}catch(o){throw I("play() failed:",o),p("Could not start playback: "+(o?.message||String(o)),"error"),o}try{let o=await C2(C.getCurrentTime(),1500,"getCurrentTime");typeof o=="number"&&o>.5?(await N1(150),await C2(C.setCurrentTime(0),2e3,"setCurrentTime(0)"),F("Seeked to 0")):F("Already at start, skipping seek")}catch(o){F("Post-play seek skipped:",o?.message||String(o))}E(new Date),Y(!0),x("running"),p("Activity started")}catch(C){I("Start session failed:",C),p("Player not ready yet. Please wait a moment and try again.","error"),x("error")}finally{D(!1)}}async function r2(){try{D(!0),F("Resume clicked");let C=await c1();x("starting");try{await C.play(),F("Playback resumed")}catch(o){throw I("resume play() failed:",o),p("Could not resume playback: "+(o?.message||String(o)),"error"),o}Y(!0),x("running"),p("Activity resumed")}catch(C){I("Resume session failed:",C),p("Player not ready yet. Please wait a moment and try again.","error"),x("error")}finally{D(!1)}}async function P2(){try{F("Pause clicked");let C=await c1();try{await C.pause(),F("Playback paused")}catch(o){throw I("pause() failed:",o),p("Failed to pause: "+(o?.message||String(o)),"error"),o}Y(!1),x("paused"),p("Activity paused")}catch(C){I("[TVS] Pause failed:",C),x("error")}}async function e1(){try{F("Finish clicked");let C=await c1();x("pausing");try{await C.pause(),F("Playback paused before save dialog")}catch(o1){I("pause before save dialog failed:",o1)}let o=await C.getCurrentTime(),Z=Math.max(0,Math.floor(o||0)),T=w(Z),B=Math.floor(Z/60),A1=Z%60;V1(`${B}:${A1.toString().padStart(2,"0")}`),w1((T/1e3).toFixed(2)),T1(!0)}catch(C){I("[TVS] Failed to open save dialog:",C),p("Failed to open save dialog: "+(C?.message||String(C)),"error"),x("error")}}async function K1(){try{C1(!0);let C=0;if(b1.includes(":")){let h1=b1.split(":").map(S1=>parseInt(S1.trim())||0);if(h1.length===3){let[S1,p1,Q1]=h1;C=S1*3600+p1*60+Q1}else if(h1.length===2){let[S1,p1]=h1;C=S1*60+p1}else C=0}else C=parseInt(b1)||0;let o=Math.round(parseFloat(P1)*1e3);if(o<=0||C<=0){p("Distance and time must be greater than zero","error"),C1(!1);return}let Z=new Date().toISOString(),T=H1?H1.toISOString():new Date(Date.now()-C*1e3).toISOString(),B=new Date(new Date(T).getTime()+C*1e3).toISOString(),A1={route_id:d.id,route_name:d.title||"Unknown Route",activity_date:Z,started_at:T,ended_at:B,duration_s:C,distance_m:o,visibility:"private",activity_type:l1,is_virtual:!1},o1=window.TVS_SETTINGS?.nonce||"";X1&&await N1(X1);let K=await fetch("/wp-json/tvs/v1/activities",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":o1},credentials:"same-origin",body:JSON.stringify(A1)});if(!K.ok){let h1=await K.json();throw new Error(h1.message||`HTTP ${K.status}`)}await K.json(),T1(!1),C1(!1),V1(""),w1(""),p("Activity saved! \u{1F389}","success"),x("ok"),Y(!1),E(null),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(C){I("[TVS] Save activity failed:",C),p("Failed to save activity: "+(C?.message||String(C)),"error"),A(C?.message||String(C)),x("error"),C1(!1)}}async function a2(C){try{J(C),x("uploading");let o=await fetch(`/wp-json/tvs/v1/activities/${C}/strava`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||""},credentials:"same-origin"}),Z=await o.json();if(!o.ok)throw new Error(Z.message||"Upload failed");p("Uploaded to Strava!"),x("ok"),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(o){I("Strava upload FAIL:",o),p("Failed to upload to Strava: "+(o?.message||String(o)),"error"),A(o?.message||String(o)),x("error")}finally{J(null)}}if(V)return c("div",{className:"tvs-route tvs-error"},String(V));if(!d)return v1.createElement(D2,null);let O1=d.title||"Route",r1=d.meta||{},a1=r1.vimeo_id?String(r1.vimeo_id):"",R1=r1.gpx_url||"",j=Number(r1.duration_s||0),k1=!!window.TVS_SETTINGS?.user;if(!a1&&R1)return c(k2,{routeData:d,routeId:a});if(!a1&&!R1)return c("div",{className:"tvs-route tvs-fallback"},c("p",null,"This route has no video or GPX data available."));let M1=k1?z1?[c("button",{key:"pause",className:"tvs-btn tvs-btn--warning",onClick:P2,disabled:N||!k,"aria-label":"Pause activity",title:"Pause activity"},c(s4,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"PAUSE")),c("button",{key:"finish",className:"tvs-btn tvs-btn--success",onClick:e1,disabled:N||!k,"aria-label":"Finish and save activity",title:"Finish and save activity"},N?[c("span",{className:"tvs-spinner","aria-hidden":"true"}),c("span",{className:"tvs-btn__label"},"SAVE")]:[c(A2,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"SAVE")])]:_>0&&H1&&(j===0||_<j-.5)?[c("button",{key:"resume",className:"tvs-btn tvs-btn--primary",onClick:r2,disabled:N||!k,"aria-label":"Resume activity",title:"Resume activity"},N?[c("span",{className:"tvs-spinner","aria-hidden":"true"}),c("span",{className:"tvs-btn__label"},"RESUME")]:[c(S2,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"RESUME")]),c("button",{key:"finish",className:"tvs-btn tvs-btn--success",onClick:e1,disabled:N||!k,"aria-label":"Finish and save activity",title:"Finish and save activity"},N?[c("span",{className:"tvs-spinner","aria-hidden":"true"}),c("span",{className:"tvs-btn__label"},"SAVE")]:[c(A2,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"SAVE")]),c("button",{key:"restart",className:"tvs-btn tvs-btn--outline",onClick:c2,disabled:N||!k,"aria-label":"Restart from beginning",title:"Restart from beginning"},N?[c("span",{className:"tvs-spinner","aria-hidden":"true"}),c("span",{className:"tvs-btn__label"},"BEGINNING")]:[c(H2,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"BEGINNING")])]:c("button",{className:"tvs-btn tvs-btn--primary",onClick:c2,disabled:N||!k,"aria-label":"Start activity",title:"Start activity"},N?[c("span",{className:"tvs-spinner","aria-hidden":"true"}),c("span",{className:"tvs-btn__label"},"START")]:[c(S2,{"aria-hidden":!0}),c("span",{className:"tvs-btn__label"},"START")]):c("div",{className:"tvs-alert tvs-alert--warning"},c("div",{className:"tvs-row tvs-mb-2"},c("span",{className:"tvs-badge tvs-badge-warning"},"Warning"),c("strong",null," You must be logged in")),c("p",null,"Please ",c("a",{href:"/login"},"log in")," to create activities and upload to Strava. Don't have an account? ",c("a",{href:"/register"},"Register here"),"."));return c("div",{className:`tvs-app${S?" tvs-app--cinematic":""}`},c("div",{key:"video-container",className:S?"tvs-video-container":"tvs-panel tvs-app__container"},a1?c("div",{className:S?"tvs-video tvs-video--cinematic":"tvs-video"},c("iframe",{ref:t2,width:560,height:315,src:"https://player.vimeo.com/video/"+encodeURIComponent(a1)+"?controls=0&title=0&byline=0&portrait=0&pip=0&playsinline=1&dnt=1&transparent=0&muted=0",frameBorder:0,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})):null,S&&t1&&c("div",{key:"minimap",className:"tvs-video-overlay tvs-video-overlay--minimap"},c("div",{className:"tvs-overlay-placeholder"},"Mini-map")),S&&P&&c("div",{key:"routeinfo",className:"tvs-video-overlay tvs-video-overlay--routeinfo"},c("div",{className:"tvs-overlay-placeholder"},"Route Info")),!S&&c(s2,{React:v1,currentTime:_,duration:j}),!S&&(new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1")?c("div",{className:"tvs-meta"},c("pre",null,JSON.stringify(r1,null,2))):null,!S&&c("div",{className:"tvs-btns"},M1,c("button",{className:"tvs-btn tvs-btn--outline tvs-cinematic-toggle",onClick:async()=>{if(!k){p("Please wait for video to load","warning");return}q(!0);try{let C=document.querySelector(".tvs-app");C&&C.requestFullscreen&&await C.requestFullscreen()}catch(C){console.warn("Fullscreen not supported or denied:",C)}},"aria-label":"Enter cinematic mode",title:"Enter cinematic mode (F)",disabled:!k},c(V2,{"aria-hidden":!0})))),S?c("div",{className:`tvs-control-panel${u1?"":" tvs-control-panel--hidden"}`,style:j>0?{"--progress":`${Math.min(_/j*100,100)}%`}:void 0},c("button",{className:"tvs-control-panel-tab",onClick:()=>m1(C=>!C),"aria-label":u1?"Hide controls":"Show controls",title:u1?"Hide controls":"Show controls"},c(u1?e4:o4,{"aria-hidden":!0})),c("div",{className:"tvs-control-panel-content"},c("div",{className:"tvs-btns"},M1),c("div",{className:"tvs-cinematic-controls"},c("button",{className:"tvs-btn tvs-btn--outline",onClick:()=>i1(C=>!C),"aria-label":t1?"Hide minimap":"Show minimap",title:t1?"Hide minimap":"Show minimap"},c(H4,{"aria-hidden":!0})),c("button",{className:"tvs-btn tvs-btn--outline",onClick:()=>D1(C=>!C),"aria-label":P?"Hide route info":"Show route info",title:P?"Hide route info":"Show route info"},c(h4,{"aria-hidden":!0})),c("button",{className:"tvs-btn tvs-btn--outline tvs-exit-cinematic",onClick:async()=>{if(q(!1),document.fullscreenElement)try{await document.exitFullscreen()}catch(C){console.warn("Error exiting fullscreen:",C)}},"aria-label":"Exit cinematic mode (press F or Escape)",title:"Exit cinematic mode (press F or Escape)"},c(d2,{"aria-hidden":!0}))))):null,I1?c(b2,{React:v1,routeId:a,lastStatus:G,lastError:W1,currentTime:_,duration:j}):null,_1&&c("div",{className:"save-modal-overlay",onClick:()=>T1(!1)},c("div",{className:"save-modal",onClick:C=>C.stopPropagation()},c("h3",null,"\u{1F4BE} Save Activity"),c("p",null,`Enter actual data from your ${l1==="Ride"?"bike/trainer":"treadmill"}:`),c("div",{className:"modal-field"},c("label",null,"Activity Type"),c("div",{className:"activity-type-selector",style:{display:"flex",gap:"8px",marginTop:"8px"}},["Walk","Run","Ride"].map(C=>c("button",{key:C,type:"button",className:`activity-type-btn ${l1===C?"active":""}`,onClick:()=>j1(C),style:{flex:1,padding:"12px",border:l1===C?"2px solid #3b82f6":"2px solid #e5e7eb",borderRadius:"8px",background:l1===C?"#eff6ff":"white",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",transition:"all 0.2s"}},c("span",{style:{fontSize:"24px"}},C==="Walk"?"\u{1F6B6}":C==="Run"?"\u{1F3C3}":"\u{1F6B4}"),c("span",{style:{fontSize:"14px",fontWeight:l1===C?"600":"400"}},C))))),c("div",{className:"modal-field"},c("label",null,"Distance (km)"),c("input",{type:"text",value:P1,onChange:C=>w1(C.target.value),placeholder:"8.234"}),c("small",{style:{color:"#718096",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"}},"Supports decimals (e.g., 8.234 km)")),c("div",{className:"modal-field"},c("label",null,"Time (H:MM:SS, MM:SS, or seconds)"),c("input",{type:"text",value:b1,onChange:C=>V1(C.target.value),placeholder:"1:23:45 or 45:23"}),c("small",{style:{color:"#718096",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"}},"Format: H:MM:SS (e.g., 1:23:45), MM:SS (e.g., 45:23), or just seconds (e.g., 2723)")),c("div",{className:"modal-buttons"},c("button",{className:"btn-secondary",onClick:()=>{T1(!1),V1(""),w1("")},disabled:B1},"Cancel"),c("button",{className:"btn-primary",onClick:K1,disabled:B1},B1?"Saving...":"Save Activity")))))}I1||document.addEventListener("keydown",t=>{if(t.key==="`"){try{localStorage.setItem("tvsDev","1")}catch{}location.reload()}});function z4(){let t=document.getElementById("tvs-app-root");if(t){let a=window.tvs_route_payload||null,l=t.getAttribute("data-route-id")||a&&a.id;F("\u{1F680} Boot Debug:"),F("  - Mount element:",!!t),F("  - Route ID:",l),F("  - window.tvs_route_payload:",window.tvs_route_payload),F("  - Inline payload:",a),F("Boot \u2192 routeId:",l,"inline payload:",!!a),_2(T2,{initialData:a,routeId:l},t)}}I1?F("Debug mode enabled."):document.addEventListener("keydown",function(t){if(t.key==="`"){let a=new URL(location.href);a.searchParams.set("tvsdebug","1"),location.href=a.toString()}});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",z4):z4();})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
//# sourceMappingURL=tvs-app.js.map
