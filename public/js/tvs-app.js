(()=>{var M2=Object.create;var D1=Object.defineProperty;var g2=Object.getOwnPropertyDescriptor;var Z2=Object.getOwnPropertyNames;var l2=Object.getPrototypeOf,c2=Object.prototype.hasOwnProperty;var T1=(t,C)=>()=>(C||t((C={exports:{}}).exports,C),C.exports);var u2=(t,C,a,i)=>{if(C&&typeof C=="object"||typeof C=="function")for(let e of Z2(C))!c2.call(t,e)&&e!==a&&D1(t,e,{get:()=>C[e],enumerable:!(i=g2(C,e))||i.enumerable});return t};var E1=(t,C,a)=>(a=t!=null?M2(l2(t)):{},u2(C||!t||!t.__esModule?D1(a,"default",{value:t,enumerable:!0}):a,t));var $1=T1(n=>{"use strict";var Q=Symbol.for("react.element"),h2=Symbol.for("react.portal"),v2=Symbol.for("react.fragment"),x2=Symbol.for("react.strict_mode"),s2=Symbol.for("react.profiler"),f2=Symbol.for("react.provider"),w2=Symbol.for("react.context"),B2=Symbol.for("react.forward_ref"),R2=Symbol.for("react.suspense"),F2=Symbol.for("react.memo"),m2=Symbol.for("react.lazy"),I1=Symbol.iterator;function S2(t){return t===null||typeof t!="object"?null:(t=I1&&t[I1]||t["@@iterator"],typeof t=="function"?t:null)}var O1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G1=Object.assign,W1={};function j(t,C,a){this.props=t,this.context=C,this.refs=W1,this.updater=a||O1}j.prototype.isReactComponent={};j.prototype.setState=function(t,C){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,C,"setState")};j.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function j1(){}j1.prototype=j.prototype;function c1(t,C,a){this.props=t,this.context=C,this.refs=W1,this.updater=a||O1}var u1=c1.prototype=new j1;u1.constructor=c1;G1(u1,j.prototype);u1.isPureReactComponent=!0;var N1=Array.isArray,z1=Object.prototype.hasOwnProperty,d1={current:null},q1={key:!0,ref:!0,__self:!0,__source:!0};function K1(t,C,a){var i,e={},r=null,L=null;if(C!=null)for(i in C.ref!==void 0&&(L=C.ref),C.key!==void 0&&(r=""+C.key),C)z1.call(C,i)&&!q1.hasOwnProperty(i)&&(e[i]=C[i]);var g=arguments.length-2;if(g===1)e.children=a;else if(1<g){for(var o=Array(g),M=0;M<g;M++)o[M]=arguments[M+2];e.children=o}if(t&&t.defaultProps)for(i in g=t.defaultProps,g)e[i]===void 0&&(e[i]=g[i]);return{$$typeof:Q,type:t,key:r,ref:L,props:e,_owner:d1.current}}function y2(t,C){return{$$typeof:Q,type:t.type,key:C,ref:t.ref,props:t.props,_owner:t._owner}}function p1(t){return typeof t=="object"&&t!==null&&t.$$typeof===Q}function b2(t){var C={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return C[a]})}var _1=/\/+/g;function l1(t,C){return typeof t=="object"&&t!==null&&t.key!=null?b2(""+t.key):C.toString(36)}function V1(t,C,a,i,e){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var L=!1;if(t===null)L=!0;else switch(r){case"string":case"number":L=!0;break;case"object":switch(t.$$typeof){case Q:case h2:L=!0}}if(L)return L=t,e=e(L),t=i===""?"."+l1(L,0):i,N1(e)?(a="",t!=null&&(a=t.replace(_1,"$&/")+"/"),V1(e,C,a,"",function(M){return M})):e!=null&&(p1(e)&&(e=y2(e,a+(!e.key||L&&L.key===e.key?"":(""+e.key).replace(_1,"$&/")+"/")+t)),C.push(e)),1;if(L=0,i=i===""?".":i+":",N1(t))for(var g=0;g<t.length;g++){r=t[g];var o=i+l1(r,g);L+=V1(r,C,a,o,e)}else if(o=S2(t),typeof o=="function")for(t=o.call(t),g=0;!(r=t.next()).done;)r=r.value,o=i+l1(r,g++),L+=V1(r,C,a,o,e);else if(r==="object")throw C=String(t),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.");return L}function H1(t,C,a){if(t==null)return t;var i=[],e=0;return V1(t,i,"","",function(r){return C.call(a,r,e++)}),i}function k2(t){if(t._status===-1){var C=t._result;C=C(),C.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=C)}if(t._status===1)return t._result.default;throw t._result}var v={current:null},L1={transition:null},P2={ReactCurrentDispatcher:v,ReactCurrentBatchConfig:L1,ReactCurrentOwner:d1};n.Children={map:H1,forEach:function(t,C,a){H1(t,function(){C.apply(this,arguments)},a)},count:function(t){var C=0;return H1(t,function(){C++}),C},toArray:function(t){return H1(t,function(C){return C})||[]},only:function(t){if(!p1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};n.Component=j;n.Fragment=v2;n.Profiler=s2;n.PureComponent=c1;n.StrictMode=x2;n.Suspense=R2;n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P2;n.cloneElement=function(t,C,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=G1({},t.props),e=t.key,r=t.ref,L=t._owner;if(C!=null){if(C.ref!==void 0&&(r=C.ref,L=d1.current),C.key!==void 0&&(e=""+C.key),t.type&&t.type.defaultProps)var g=t.type.defaultProps;for(o in C)z1.call(C,o)&&!q1.hasOwnProperty(o)&&(i[o]=C[o]===void 0&&g!==void 0?g[o]:C[o])}var o=arguments.length-2;if(o===1)i.children=a;else if(1<o){g=Array(o);for(var M=0;M<o;M++)g[M]=arguments[M+2];i.children=g}return{$$typeof:Q,type:t.type,key:e,ref:r,props:i,_owner:L}};n.createContext=function(t){return t={$$typeof:w2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:f2,_context:t},t.Consumer=t};n.createElement=K1;n.createFactory=function(t){var C=K1.bind(null,t);return C.type=t,C};n.createRef=function(){return{current:null}};n.forwardRef=function(t){return{$$typeof:B2,render:t}};n.isValidElement=p1;n.lazy=function(t){return{$$typeof:m2,_payload:{_status:-1,_result:t},_init:k2}};n.memo=function(t,C){return{$$typeof:F2,type:t,compare:C===void 0?null:C}};n.startTransition=function(t){var C=L1.transition;L1.transition={};try{t()}finally{L1.transition=C}};n.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};n.useCallback=function(t,C){return v.current.useCallback(t,C)};n.useContext=function(t){return v.current.useContext(t)};n.useDebugValue=function(){};n.useDeferredValue=function(t){return v.current.useDeferredValue(t)};n.useEffect=function(t,C){return v.current.useEffect(t,C)};n.useId=function(){return v.current.useId()};n.useImperativeHandle=function(t,C,a){return v.current.useImperativeHandle(t,C,a)};n.useInsertionEffect=function(t,C){return v.current.useInsertionEffect(t,C)};n.useLayoutEffect=function(t,C){return v.current.useLayoutEffect(t,C)};n.useMemo=function(t,C){return v.current.useMemo(t,C)};n.useReducer=function(t,C,a){return v.current.useReducer(t,C,a)};n.useRef=function(t){return v.current.useRef(t)};n.useState=function(t){return v.current.useState(t)};n.useSyncExternalStore=function(t,C,a){return v.current.useSyncExternalStore(t,C,a)};n.useTransition=function(){return v.current.useTransition()};n.version="18.2.0"});var h1=T1((K2,Q1)=>{"use strict";Q1.exports=$1()});var G=new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1";function u(...t){G&&console.debug("[TVS]",...t)}function p(...t){console.error("[TVS]",...t)}var U1=!!(window.React&&window.ReactDOM),d2=!!(window.wp&&window.wp.element),A=d2?window.wp.element:{},k=U1?window.React:A||{},b=U1?window.ReactDOM:A||null,g1=new WeakMap,p2=b&&typeof b.createRoot=="function"||A&&typeof A.createRoot=="function";function A1(t,C,a){try{let i=g1.get(a);if(i&&typeof i.unmount=="function"?(i.unmount(),g1.delete(a)):b&&typeof b.unmountComponentAtNode=="function"&&b.unmountComponentAtNode(a),p2){let L=(b&&b.createRoot||A&&A.createRoot)(a);g1.set(a,L),L.render(k.createElement(t,C));return}let e=b&&b.render||A&&A.render;if(e){e(k.createElement(t,C),a);return}p("Ingen render-funksjon tilgjengelig.")}catch(i){p("Mount feilet:",i)}}function W(t){return new Promise(C=>setTimeout(C,t))}async function e1(t,C,a="operation"){let i;try{return await Promise.race([t,new Promise((e,r)=>{i=setTimeout(()=>r(new Error(a+" timed out")),C)})])}finally{clearTimeout(i)}}function Z1({React:t,currentTime:C,duration:a}){let i=t.createElement,e=Math.floor(C/60),r=Math.floor(C%60),L=(o,M)=>o+":"+(M<10?"0":"")+M,g=a>0?C/a*100:0;return i("div",{className:"tvs-progress"},i("div",{className:"tvs-progress__bar"},i("div",{className:"tvs-progress__fill",style:{width:Math.min(g,100)+"%"}})),i("div",{className:"tvs-progress__time"},L(e,r)+" / "+L(Math.floor(a/60),Math.floor(a%60))))}var z=E1(h1());var v1=E1(h1()),x1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s1=v1.default.createContext&&v1.default.createContext(x1);var I=function(){return I=Object.assign||function(t){for(var C,a=1,i=arguments.length;a<i;a++){C=arguments[a];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(t[e]=C[e])}return t},I.apply(this,arguments)},D2=function(t,C){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&C.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,i=Object.getOwnPropertySymbols(t);e<i.length;e++)C.indexOf(i[e])<0&&Object.prototype.propertyIsEnumerable.call(t,i[e])&&(a[i[e]]=t[i[e]]);return a};function Y1(t){return t&&t.map(function(C,a){return z.default.createElement(C.tag,I({key:a},C.attr),Y1(C.child))})}function m(t){return function(C){return z.default.createElement(T2,I({attr:I({},t.attr)},C),Y1(t.child))}}function T2(t){var C=function(a){var i=t.attr,e=t.size,r=t.title,L=D2(t,["attr","size","title"]),g=e||a.size||"1em",o;return a.className&&(o=a.className),t.className&&(o=(o?o+" ":"")+t.className),z.default.createElement("svg",I({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,i,L,{className:o,style:I(I({color:t.color||a.color},a.style),t.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),r&&z.default.createElement("title",null,r),t.children)};return s1!==void 0?z.default.createElement(s1.Consumer,null,function(a){return C(a)}):C(x1)}function X1(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.9997 13.1714L16.9495 8.22168L18.3637 9.63589L11.9997 15.9999L5.63574 9.63589L7.04996 8.22168L11.9997 13.1714Z"}}]})(t)}function J1(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z"}}]})(t)}function t2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.5374 19.5674C16.7844 21.0831 14.4993 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 14.1361 21.3302 16.1158 20.1892 17.7406L17 12H20C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C14.1502 20 16.1022 19.1517 17.5398 17.7716L18.5374 19.5674Z"}}]})(t)}function f1(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 19V13H17V19H19V7.82843L16.1716 5H5V19H7ZM4 3H17L21 7V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM9 15V19H15V15H9Z"}}]})(t)}function C2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM8 7H16V9H8V7ZM8 11H16V13H8V11ZM8 15H16V17H8V15Z"}}]})(t)}function r2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 20.8995L16.9497 15.9497C19.6834 13.2161 19.6834 8.78392 16.9497 6.05025C14.2161 3.31658 9.78392 3.31658 7.05025 6.05025C4.31658 8.78392 4.31658 13.2161 7.05025 15.9497L12 20.8995ZM12 23.7279L5.63604 17.364C2.12132 13.8492 2.12132 8.15076 5.63604 4.63604C9.15076 1.12132 14.8492 1.12132 18.364 4.63604C21.8787 8.15076 21.8787 13.8492 18.364 17.364L12 23.7279ZM12 13C13.1046 13 14 12.1046 14 11C14 9.89543 13.1046 9 12 9C10.8954 9 10 9.89543 10 11C10 12.1046 10.8954 13 12 13ZM12 15C9.79086 15 8 13.2091 8 11C8 8.79086 9.79086 7 12 7C14.2091 7 16 8.79086 16 11C16 13.2091 14.2091 15 12 15Z"}}]})(t)}function w1(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M9.82986 8.78986L7.99998 9.45588V13H5.99998V8.05H6.015L11.2834 6.13247C11.5274 6.03855 11.7922 5.99162 12.0648 6.0008C13.1762 6.02813 14.1522 6.75668 14.4917 7.82036C14.678 8.40431 14.848 8.79836 15.0015 9.0025C15.9138 10.2155 17.3653 11 19 11V13C16.8253 13 14.8823 12.0083 13.5984 10.4526L12.9008 14.4085L15 16.17V23H13V17.1025L10.7307 15.1984L10.003 19.3253L3.10938 18.1098L3.45667 16.1401L8.38071 17.0084L9.82986 8.78986ZM13.5 5.5C12.3954 5.5 11.5 4.60457 11.5 3.5C11.5 2.39543 12.3954 1.5 13.5 1.5C14.6046 1.5 15.5 2.39543 15.5 3.5C15.5 4.60457 14.6046 5.5 13.5 5.5Z"}}]})(t)}function a2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18 7H22V9H16V3H18V7ZM8 9H2V7H6V3H8V9ZM18 17V21H16V15H22V17H18ZM8 15V21H6V17H2V15H8Z"}}]})(t)}function i2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M8 3V5H4V9H2V3H8ZM2 21V15H4V19H8V21H2ZM22 21H16V19H20V15H22V21ZM22 9H20V5H16V3H22V9Z"}}]})(t)}function e2(t){return m({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 22C4 17.5817 7.58172 14 12 14C16.4183 14 20 17.5817 20 22H18C18 18.6863 15.3137 16 12 16C8.68629 16 6 18.6863 6 22H4ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11Z"}}]})(t)}function B1(){let t=k.createElement;return t("div",{className:"tvs-loading",role:"status","aria-live":"polite"},t("svg",{viewBox:"0 0 64 64",className:"tvs-runner","aria-hidden":"true"},t("line",{x1:4,y1:60,x2:60,y2:60,stroke:"#bbb",strokeWidth:2,className:"track"}),t("circle",{cx:26,cy:12,r:5,fill:"none",stroke:"#111",strokeWidth:2}),t("line",{x1:26,y1:17,x2:26,y2:35,stroke:"#111",strokeWidth:2}),t("line",{x1:26,y1:22,x2:40,y2:18,stroke:"#111",strokeWidth:2,className:"arm front",style:{transformOrigin:"26px 22px"}}),t("line",{x1:26,y1:22,x2:12,y2:26,stroke:"#111",strokeWidth:2,className:"arm back",style:{transformOrigin:"26px 22px"}}),t("line",{x1:26,y1:35,x2:40,y2:48,stroke:"#111",strokeWidth:2,className:"leg front",style:{transformOrigin:"26px 35px"}}),t("line",{x1:26,y1:35,x2:16,y2:54,stroke:"#111",strokeWidth:2,className:"leg back",style:{transformOrigin:"26px 35px"}})),t("div",null,t("div",{className:"tvs-skel line"}),t("div",{className:"tvs-skel line sm"}),t("div",null,t("span",{className:"tvs-skel block"}),t("span",{className:"tvs-skel block"}),t("span",{className:"tvs-skel block"}))))}function R1({React:t,routeId:C,lastStatus:a,lastError:i,currentTime:e,duration:r}){let{useEffect:L,useRef:g,useState:o,createElement:M}=t;function B(T){let{useEffect:R,useRef:y,useState:h}=T,[E,d]=h(0),F=y(performance.now()),S=y(0);return R(()=>{let U,s=K=>{S.current+=1,K-F.current>=1e3&&(d(S.current),S.current=0,F.current=K),U=requestAnimationFrame(s)};return U=requestAnimationFrame(s),()=>cancelAnimationFrame(U)},[]),E}let P=B(t),X=g(null),[N,q]=o(!1),[D,m1]=o({x:16,y:16});L(()=>{if(!X.current)return;let R,y,h,E,d=!1;function F(s){s.target.closest(".tvs-dev__header")&&(d=!0,R=s.clientX,y=s.clientY,h=D.x,E=D.y,s.preventDefault())}function S(s){d&&m1({x:h+(s.clientX-R),y:E+(s.clientY-y)})}function U(){d=!1}return window.addEventListener("mousedown",F),window.addEventListener("mousemove",S),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousedown",F),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",U)}},[D]);let J=r>0?(e/r*100).toFixed(1):"0.0",x={env:window.TVS_SETTINGS?.env,version:window.TVS_SETTINGS?.version,restRoot:window.TVS_SETTINGS?.restRoot,user:window.TVS_SETTINGS?.user,routeId:C,lastStatus:a||"idle",lastError:i?String(i):null,currentTime:e?e.toFixed(1):"0.0",duration:r||0,progress:J+"%",fps:P};function Z(T,R,y){return M("div",{className:"tvs-dev__row"},M("span",null,T),M("code",{className:y?"tvs-dev__err":""},R))}function n1(){navigator.clipboard.writeText(JSON.stringify({...x,time:new Date().toISOString()},null,2)).catch(console.error)}return M("div",{ref:X,className:`tvs-dev ${N?"is-min":""}`,style:{left:D.x+"px",top:D.y+"px"}},M("div",{className:"tvs-dev__header"},M("strong",null,"TVS Dev"),M("div",{className:"tvs-dev__spacer"}),M("span",{className:"tvs-dev__pill"},x.env||"n/a"),M("button",{className:"tvs-dev__btn",onClick:()=>q(!N),"aria-label":"Minimize"},"\u2581")),M("div",{className:"tvs-dev__body"},Z("Route",x.routeId??"n/a"),Z("User",x.user??"guest"),Z("REST",x.restRoot??"n/a"),Z("Status",x.lastStatus),x.lastError?Z("Error",x.lastError,!0):null,Z("Duration",x.duration+"s"),Z("Current",x.currentTime+"s"),Z("Progress",x.progress),Z("FPS",String(x.fps)),M("div",{className:"tvs-dev__actions"},M("button",{onClick:n1,className:"tvs-dev__btn"},"Copy debug"),M("button",{onClick:()=>{localStorage.setItem("tvsDev","0"),location.reload()},className:"tvs-dev__btn tvs-dev__btn--ghost"},"Disable"))))}var Y=Number(new URLSearchParams(location.search).get("tvsslow")||0);function F1({initialData:t,routeId:C}){let{useEffect:a,useState:i,useRef:e,createElement:r}=k,[L,g]=i(t||null),[o,M]=i(null),[B,P]=i(!1),[X,N]=i(!1),[q,D]=i(null),[m1,J]=i(null),[x,Z]=i(t?"inline":"loading"),[n1,T]=i(null),[R,y]=i(0),[h,E]=i(!1),[d,F]=i(!1),[S,U]=i(!0),[s,K]=i(!0),[t1,V2]=i(!0),S1=e(null),o1=e(null);function f(V,H="success"){typeof window.tvsFlash=="function"&&window.tvsFlash(V,H)}a(()=>{let V=new URLSearchParams(location.search).get("tvsforcefetch")==="1";if(L&&!V){u("Har inline payload, skipper fetch.",L);return}if(!C){M("Mangler routeId \u2013 hverken inline payload eller data-route-id.");return}(async()=>{try{u("Henter rute via REST:",C," (tvsslow:",Y,"ms)"),Z("loading"),Y&&await W(Y);let l=await(await fetch(`/wp-json/tvs/v1/routes/${encodeURIComponent(C)}`,{credentials:"same-origin"})).json();u("REST OK:",l),g(l),Z("ok")}catch(H){p("REST FAIL:",H),M("Kunne ikke hente rutedata."),T(H?.message||String(H)),Z("error")}})()},[C]),a(()=>{if(!L)return;let V=S1.current;if(!V)return;let H=null,l=!1;function w(){return new Promise((c,a1)=>{if(window.Vimeo&&window.Vimeo.Player)return c();let $=document.querySelector('script[src="https://player.vimeo.com/api/player.js"]');if($){$.addEventListener("load",()=>c()),$.addEventListener("error",()=>a1(new Error("Vimeo API failed to load")));return}let _=document.createElement("script");_.src="https://player.vimeo.com/api/player.js",_.async=!0,_.onload=()=>c(),_.onerror=()=>a1(new Error("Vimeo API failed to load")),document.head.appendChild(_)})}return(async()=>{try{if(await w(),l)return;H=new window.Vimeo.Player(V),o1.current=H,u("Vimeo Player constructed"),H.getDuration().catch(()=>{});try{await H.ready(),l||(E(!0),u("Vimeo Player ready"))}catch(c){p("Vimeo ready() rejected:",c)}H.on("timeupdate",c=>{typeof c?.seconds=="number"&&y(c.seconds)})}catch{p("Vimeo API init failed")}})(),()=>{l=!0;try{H&&H.off&&H.off("timeupdate"),H&&H.destroy&&H.destroy()}catch{}o1.current=null,E(!1)}},[L]),a(()=>{async function V(l){if((l.key==="f"||l.key==="F")&&l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"){l.preventDefault();let w=!d;if(w&&!h){f("Please wait for video to load","warning");return}if(F(w),w){await W(100);try{let c=document.querySelector(".tvs-app");c&&c.requestFullscreen&&await c.requestFullscreen()}catch(c){console.warn("Fullscreen not supported or denied:",c)}}else if(document.fullscreenElement)try{await document.exitFullscreen()}catch(c){console.warn("Error exiting fullscreen:",c)}}if(l.key==="Escape"&&d&&(F(!1),document.fullscreenElement))try{await document.exitFullscreen()}catch(w){console.warn("Error exiting fullscreen:",w)}}function H(){!document.fullscreenElement&&d&&F(!1)}return window.addEventListener("keydown",V),document.addEventListener("fullscreenchange",H),()=>{window.removeEventListener("keydown",V),document.removeEventListener("fullscreenchange",H)}},[d,h]);async function C1(V=8e3){let H=Date.now();for(;Date.now()-H<V;){let l=o1.current;if(l)try{return await l.ready(),E(!0),l}catch{}await W(100)}throw new Error("Video player is not ready")}function L2(V){let H=L?.meta||{},l=Number(H.duration_s||0),w=Number(H.distance_m||0);if(l>0&&w>0&&V>=0){let c=Math.min(1,V/l);return Math.round(w*c)}return 0}async function y1(){try{P(!0),u("Start clicked");let V=await C1();Z("starting");try{await e1(V.play(),4e3,"play()"),u("Playback started")}catch(H){throw p("play() failed:",H),f("Could not start playback: "+(H?.message||String(H)),"error"),H}try{let H=await e1(V.getCurrentTime(),1500,"getCurrentTime");typeof H=="number"&&H>.5?(await W(150),await e1(V.setCurrentTime(0),2e3,"setCurrentTime(0)"),u("Seeked to 0")):u("Already at start, skipping seek")}catch(H){u("Post-play seek skipped:",H?.message||String(H))}D(new Date),N(!0),Z("running"),f("Activity started")}catch(V){p("Start session failed:",V),f("Player not ready yet. Please wait a moment and try again.","error"),Z("error")}finally{P(!1)}}async function n2(){try{P(!0),u("Resume clicked");let V=await C1();Z("starting");try{await V.play(),u("Playback resumed")}catch(H){throw p("resume play() failed:",H),f("Could not resume playback: "+(H?.message||String(H)),"error"),H}N(!0),Z("running"),f("Activity resumed")}catch(V){p("Resume session failed:",V),f("Player not ready yet. Please wait a moment and try again.","error"),Z("error")}finally{P(!1)}}async function o2(){try{u("Pause clicked");let V=await C1();try{await V.pause(),u("Playback paused")}catch(H){throw p("pause() failed:",H),f("Failed to pause: "+(H?.message||String(H)),"error"),H}N(!1),Z("paused"),f("Activity paused")}catch(V){p("[TVS] Pause failed:",V),Z("error")}}async function b1(){try{P(!0),u("Finish clicked");let V=await C1();Z("saving");try{await V.pause(),u("Playback paused before save")}catch(M1){p("pause before save failed:",M1)}let H=await V.getCurrentTime(),l=Math.max(0,Math.floor(H||0)),w=q?q.toISOString():new Date(Date.now()-l*1e3).toISOString(),c=new Date(new Date(w).getTime()+l*1e3).toISOString(),a1=L2(l),$={route_id:L.id,route_name:L.title||"Unknown Route",activity_date:new Date().toISOString(),started_at:w,ended_at:c,duration_s:l,distance_m:a1,visibility:"private"},_=window.TVS_SETTINGS?.nonce||"";Y&&await W(Y);let i1=await fetch("/wp-json/tvs/v1/activities",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":_},credentials:"same-origin",body:JSON.stringify($)});if(!i1.ok){let M1=await i1.json();throw new Error(M1.message||`HTTP ${i1.status}`)}await i1.json(),f("Activity saved!"),Z("ok"),N(!1),D(null),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(V){p("[TVS] Save activity failed:",V),f("Failed to save activity: "+(V?.message||String(V)),"error"),T(V?.message||String(V)),Z("error")}finally{P(!1)}}async function E2(V){try{J(V),Z("uploading");let H=await fetch(`/wp-json/tvs/v1/activities/${V}/strava`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||""},credentials:"same-origin"}),l=await H.json();if(!H.ok)throw new Error(l.message||"Upload failed");f("Uploaded to Strava!"),Z("ok"),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(H){p("Strava upload FAIL:",H),f("Failed to upload to Strava: "+(H?.message||String(H)),"error"),T(H?.message||String(H)),Z("error")}finally{J(null)}}if(o)return r("div",{className:"tvs-route tvs-error"},String(o));if(!L)return k.createElement(B1,null);let U2=L.title||"Route",r1=L.meta||{},k1=r1.vimeo_id?String(r1.vimeo_id):"",O=Number(r1.duration_s||0),P1=!!window.TVS_SETTINGS?.user?X?[r("button",{key:"pause",className:"tvs-btn tvs-btn--warning",onClick:o2,disabled:B||!h,"aria-label":"Pause activity",title:"Pause activity"},r(e2,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"PAUSE")),r("button",{key:"finish",className:"tvs-btn tvs-btn--success",onClick:b1,disabled:B||!h,"aria-label":"Finish and save activity",title:"Finish and save activity"},B?[r("span",{className:"tvs-spinner","aria-hidden":"true"}),r("span",{className:"tvs-btn__label"},"SAVE")]:[r(f1,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"SAVE")])]:R>0&&q&&(O===0||R<O-.5)?[r("button",{key:"resume",className:"tvs-btn tvs-btn--primary",onClick:n2,disabled:B||!h,"aria-label":"Resume activity",title:"Resume activity"},B?[r("span",{className:"tvs-spinner","aria-hidden":"true"}),r("span",{className:"tvs-btn__label"},"RESUME")]:[r(w1,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"RESUME")]),r("button",{key:"finish",className:"tvs-btn tvs-btn--success",onClick:b1,disabled:B||!h,"aria-label":"Finish and save activity",title:"Finish and save activity"},B?[r("span",{className:"tvs-spinner","aria-hidden":"true"}),r("span",{className:"tvs-btn__label"},"SAVE")]:[r(f1,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"SAVE")]),r("button",{key:"restart",className:"tvs-btn tvs-btn--outline",onClick:y1,disabled:B||!h,"aria-label":"Restart from beginning",title:"Restart from beginning"},B?[r("span",{className:"tvs-spinner","aria-hidden":"true"}),r("span",{className:"tvs-btn__label"},"BEGINNING")]:[r(t2,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"BEGINNING")])]:r("button",{className:"tvs-btn tvs-btn--primary",onClick:y1,disabled:B||!h,"aria-label":"Start activity",title:"Start activity"},B?[r("span",{className:"tvs-spinner","aria-hidden":"true"}),r("span",{className:"tvs-btn__label"},"START")]:[r(w1,{"aria-hidden":!0}),r("span",{className:"tvs-btn__label"},"START")]):r("div",{className:"tvs-alert tvs-alert--warning"},r("div",{className:"tvs-row tvs-mb-2"},r("span",{className:"tvs-badge tvs-badge-warning"},"Warning"),r("strong",null," You must be logged in")),r("p",null,"Please ",r("a",{href:"/login"},"log in")," to create activities and upload to Strava. Don't have an account? ",r("a",{href:"/register"},"Register here"),"."));return r("div",{className:`tvs-app${d?" tvs-app--cinematic":""}`},r("div",{key:"video-container",className:d?"tvs-video-container":"tvs-panel tvs-app__container"},k1?r("div",{className:d?"tvs-video tvs-video--cinematic":"tvs-video"},r("iframe",{ref:S1,width:560,height:315,src:"https://player.vimeo.com/video/"+encodeURIComponent(k1)+"?controls=0&title=0&byline=0&portrait=0&pip=0&playsinline=1&dnt=1&transparent=0&muted=0",frameBorder:0,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})):null,d&&S&&r("div",{key:"minimap",className:"tvs-video-overlay tvs-video-overlay--minimap"},r("div",{className:"tvs-overlay-placeholder"},"Mini-map")),d&&s&&r("div",{key:"routeinfo",className:"tvs-video-overlay tvs-video-overlay--routeinfo"},r("div",{className:"tvs-overlay-placeholder"},"Route Info")),!d&&r(Z1,{React:k,currentTime:R,duration:O}),!d&&(new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1")?r("div",{className:"tvs-meta"},r("pre",null,JSON.stringify(r1,null,2))):null,!d&&r("div",{className:"tvs-btns"},P1,r("button",{className:"tvs-btn tvs-btn--outline tvs-cinematic-toggle",onClick:async()=>{if(!h){f("Please wait for video to load","warning");return}F(!0);try{let V=document.querySelector(".tvs-app");V&&V.requestFullscreen&&await V.requestFullscreen()}catch(V){console.warn("Fullscreen not supported or denied:",V)}},"aria-label":"Enter cinematic mode",title:"Enter cinematic mode (F)",disabled:!h},r(i2,{"aria-hidden":!0})))),d?r("div",{className:`tvs-control-panel${t1?"":" tvs-control-panel--hidden"}`,style:O>0?{"--progress":`${Math.min(R/O*100,100)}%`}:void 0},r("button",{className:"tvs-control-panel-tab",onClick:()=>V2(V=>!V),"aria-label":t1?"Hide controls":"Show controls",title:t1?"Hide controls":"Show controls"},r(t1?X1:J1,{"aria-hidden":!0})),r("div",{className:"tvs-control-panel-content"},r("div",{className:"tvs-btns"},P1),r("div",{className:"tvs-cinematic-controls"},r("button",{className:"tvs-btn tvs-btn--outline",onClick:()=>U(V=>!V),"aria-label":S?"Hide minimap":"Show minimap",title:S?"Hide minimap":"Show minimap"},r(r2,{"aria-hidden":!0})),r("button",{className:"tvs-btn tvs-btn--outline",onClick:()=>K(V=>!V),"aria-label":s?"Hide route info":"Show route info",title:s?"Hide route info":"Show route info"},r(C2,{"aria-hidden":!0})),r("button",{className:"tvs-btn tvs-btn--outline tvs-exit-cinematic",onClick:async()=>{if(F(!1),document.fullscreenElement)try{await document.exitFullscreen()}catch(V){console.warn("Error exiting fullscreen:",V)}},"aria-label":"Exit cinematic mode (press F or Escape)",title:"Exit cinematic mode (press F or Escape)"},r(a2,{"aria-hidden":!0}))))):null,G?r(R1,{React:k,routeId:C,lastStatus:x,lastError:n1,currentTime:R,duration:O}):null)}G||document.addEventListener("keydown",t=>{if(t.key==="`"){try{localStorage.setItem("tvsDev","1")}catch{}location.reload()}});function H2(){let t=document.getElementById("tvs-app-root");if(t){let C=window.tvs_route_payload||null,a=t.getAttribute("data-route-id")||C&&C.id;u("Boot \u2192 routeId:",a,"inline payload:",!!C),A1(F1,{initialData:C,routeId:a},t)}}G?u("Debug mode enabled."):document.addEventListener("keydown",function(t){if(t.key==="`"){let C=new URL(location.href);C.searchParams.set("tvsdebug","1"),location.href=C.toString()}});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",H2):H2();})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
//# sourceMappingURL=tvs-app.js.map
