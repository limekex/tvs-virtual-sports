{
  "version": 3,
  "sources": ["../../src/utils/debug.js", "../../src/utils/reactMount.js", "../../src/components/ExerciseSearchDropdown.js", "../../src/components/WorkoutCircuit.js", "../../src/components/ManualActivityTracker.js", "../../src/blocks/manual-activity-tracker/view.js"],
  "sourcesContent": ["// Debug utilities for TVS app\nexport const DEBUG =\n  new URLSearchParams(location.search).get(\"tvsdebug\") === \"1\" ||\n  window.TVS_DEBUG === true ||\n  localStorage.getItem(\"tvsDev\") === \"1\";\n\nexport function log(...args) {\n  if (DEBUG) console.debug(\"[TVS]\", ...args);\n}\n\nexport function err(...args) {\n  console.error(\"[TVS]\", ...args);\n}\n", "// React mount helper paired to the active renderer\nimport { log, err } from './debug.js';\n\nconst hasWindowReact = !!(window.React && window.ReactDOM);\nconst hasWpElement = !!(window.wp && window.wp.element);\nconst wpEl = hasWpElement ? window.wp.element : {};\nconst React = hasWindowReact ? window.React : (wpEl || {});\nconst ReactDOM = hasWindowReact ? window.ReactDOM : (wpEl || null);\n\n// Track mounted roots to safely unmount/re-mount\nconst tvsRoots = new WeakMap();\nconst hasCreateRoot =\n  (ReactDOM && typeof ReactDOM.createRoot === 'function') ||\n  (wpEl && typeof wpEl.createRoot === 'function');\n\nexport function mountReact(Component, props, node) {\n  try {\n    // Unmount existing root if present\n    const existingRoot = tvsRoots.get(node);\n    if (existingRoot && typeof existingRoot.unmount === 'function') {\n      existingRoot.unmount();\n      tvsRoots.delete(node);\n    }\n\n    // Use createRoot API (React 18+)\n    if (hasCreateRoot) {\n      const createRoot = (ReactDOM && ReactDOM.createRoot) || (wpEl && wpEl.createRoot);\n      const root = createRoot(node);\n      tvsRoots.set(node, root);\n      root.render(React.createElement(Component, props));\n      return;\n    }\n\n    // Fallback to legacy API (React <18) - unmount first if needed\n    if (ReactDOM && typeof ReactDOM.unmountComponentAtNode === 'function') {\n      ReactDOM.unmountComponentAtNode(node);\n    }\n\n    const legacyRender = (ReactDOM && ReactDOM.render) || (wpEl && wpEl.render);\n    if (legacyRender) {\n      legacyRender(React.createElement(Component, props), node);\n      return;\n    }\n    err('Ingen render-funksjon tilgjengelig.');\n  } catch (e) {\n    err('Mount feilet:', e);\n  }\n}\n\nexport { React, ReactDOM, wpEl };\n", "/**\n * ExerciseSearchDropdown Component\n *\n * Autocomplete dropdown for exercise library search.\n * Features:\n * - Debounced search (300ms)\n * - Min 2 characters required\n * - Keyboard navigation (arrow keys, enter, escape)\n * - Shows category and difficulty badges\n * - Click outside to close\n * - Loading states\n * - Uses React Portal to escape stacking context issues\n *\n * @package TVS_Virtual_Sports\n * @since 1.3.0\n */\n\nimport { React, ReactDOM } from '../utils/reactMount.js';\n\nconst { useState, useEffect, useRef } = React;\n\n/**\n * Debounce utility\n */\nfunction useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n\n/**\n * ExerciseSearchDropdown Component\n *\n * @param {Object} props\n * @param {string} props.value - Current input value\n * @param {Function} props.onChange - Input change handler (value)\n * @param {Function} props.onSelect - Exercise selection handler ({id, name, default_metric})\n * @param {string} props.placeholder - Input placeholder\n * @param {string} props.className - Additional CSS class\n */\nfunction ExerciseSearchDropdown({ value, onChange, onSelect, placeholder = 'Search exercises...', className = '' }) {\n  const [results, setResults] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const [error, setError] = useState('');\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0 });\n\n  const inputRef = useRef(null);\n  const dropdownRef = useRef(null);\n\n  const debouncedSearchTerm = useDebounce(value, 300);\n\n  // Update dropdown position when shown\n  useEffect(() => {\n    if (showDropdown && inputRef.current) {\n      const rect = inputRef.current.getBoundingClientRect();\n      setDropdownPosition({\n        top: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        width: rect.width,\n      });\n    }\n  }, [showDropdown]);\n\n  // Recalculate position on scroll/resize\n  useEffect(() => {\n    if (!showDropdown) return;\n\n    const updatePosition = () => {\n      if (inputRef.current) {\n        const rect = inputRef.current.getBoundingClientRect();\n        setDropdownPosition({\n          top: rect.bottom + window.scrollY,\n          left: rect.left + window.scrollX,\n          width: rect.width,\n        });\n      }\n    };\n\n    window.addEventListener('scroll', updatePosition, true);\n    window.addEventListener('resize', updatePosition);\n\n    return () => {\n      window.removeEventListener('scroll', updatePosition, true);\n      window.removeEventListener('resize', updatePosition);\n    };\n  }, [showDropdown]);\n\n  // Search exercises when debounced term changes\n  useEffect(() => {\n    const searchExercises = async () => {\n      if (debouncedSearchTerm.length < 2) {\n        setResults([]);\n        setShowDropdown(false);\n        setError('');\n        return;\n      }\n\n      setIsSearching(true);\n      setError('');\n\n      try {\n        const url = `${window.TVS_SETTINGS.restRoot}tvs/v1/exercises/search?q=${encodeURIComponent(debouncedSearchTerm)}&limit=10`;\n        \n        const response = await fetch(url, {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-WP-Nonce': window.TVS_SETTINGS.nonce,\n          },\n        });\n\n        if (!response.ok) {\n          throw new Error(`Search failed: ${response.status}`);\n        }\n\n        const data = await response.json();\n        setResults(data.results || []); // API returns 'results' not 'exercises'\n        setShowDropdown(true);\n        setSelectedIndex(-1);\n      } catch (err) {\n        console.error('Exercise search error:', err);\n        setError('Search failed. Try again.');\n        setResults([]);\n        setShowDropdown(false);\n      } finally {\n        setIsSearching(false);\n      }\n    };\n\n    searchExercises();\n  }, [debouncedSearchTerm]);\n\n  // Click outside to close dropdown\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (\n        dropdownRef.current &&\n        !dropdownRef.current.contains(event.target) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target)\n      ) {\n        setShowDropdown(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // Keyboard navigation\n  const handleKeyDown = (e) => {\n    if (!showDropdown || results.length === 0) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setSelectedIndex((prev) => (prev < results.length - 1 ? prev + 1 : prev));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setSelectedIndex((prev) => (prev > 0 ? prev - 1 : -1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < results.length) {\n          handleSelect(results[selectedIndex]);\n        }\n        break;\n      case 'Escape':\n        e.preventDefault();\n        setShowDropdown(false);\n        setSelectedIndex(-1);\n        break;\n      default:\n        break;\n    }\n  };\n\n  // Handle exercise selection\n  const handleSelect = (exercise) => {\n    console.log('Exercise selected:', exercise);\n    onSelect({\n      id: exercise.id,\n      name: exercise.name,\n      default_metric: exercise.default_metric || 'reps',\n    });\n    setResults([]);\n    setShowDropdown(false);\n    setSelectedIndex(-1);\n    // Note: Don't clear input here - let parent component handle it\n  };\n\n  // Difficulty badge color\n  const getDifficultyColor = (difficulty) => {\n    switch (difficulty) {\n      case 'beginner':\n        return '#10b981'; // green\n      case 'intermediate':\n        return '#f59e0b'; // orange\n      case 'advanced':\n        return '#ef4444'; // red\n      default:\n        return '#6b7280'; // gray\n    }\n  };\n\n  // Render dropdown with React Portal to escape stacking contexts\n  const renderDropdown = () => {\n    if (!showDropdown || results.length === 0) return null;\n\n    return ReactDOM.createPortal(\n      React.createElement(\n        'div',\n        {\n          ref: dropdownRef,\n          className: 'tvs-exercise-dropdown',\n          style: {\n            position: 'absolute',\n            top: `${dropdownPosition.top}px`,\n            left: `${dropdownPosition.left}px`,\n            width: `${dropdownPosition.width}px`,\n            zIndex: 999999,\n          },\n        },\n        results.map((exercise, idx) =>\n          React.createElement(\n            'div',\n            {\n              key: exercise.id,\n              className: `tvs-exercise-result ${idx === selectedIndex ? 'tvs-exercise-result-selected' : ''}`,\n              onClick: () => handleSelect(exercise),\n              onMouseEnter: () => setSelectedIndex(idx),\n            },\n            React.createElement(\n              'div',\n              null,\n              React.createElement(\n                'div',\n                null,\n                React.createElement(\n                  'div',\n                  null,\n                  exercise.name\n                ),\n                React.createElement(\n                  'div',\n                  null,\n                  exercise.category && React.createElement(\n                    'span',\n                    {\n                      className: 'tvs-badge tvs-badge-category',\n                    },\n                    exercise.category\n                  ),\n                  exercise.difficulty && React.createElement(\n                    'span',\n                    {\n                      className: 'tvs-badge tvs-badge-difficulty',\n                      style: {\n                        background: getDifficultyColor(exercise.difficulty),\n                      },\n                    },\n                    exercise.difficulty\n                  ),\n                  exercise.default_metric && React.createElement(\n                    'span',\n                    {\n                      className: 'tvs-badge-metric',\n                    },\n                    exercise.default_metric === 'reps' ? '\uD83D\uDD22 Reps' : '\u23F1 Time'\n                  )\n                )\n              )\n            )\n          )\n        ),\n        results.length === 0 && !isSearching && debouncedSearchTerm.length >= 2 && React.createElement(\n          'div',\n          { style: { padding: '12px 16px', color: 'var(--tvs-text-secondary)', fontSize: '14px' } },\n          'No exercises found'\n        )\n      ),\n      document.body\n    );\n  };\n\n  return React.createElement(\n    'div',\n    { className: `tvs-exercise-search-container ${className}` },\n    React.createElement('input', {\n      ref: inputRef,\n      type: 'text',\n      placeholder,\n      value,\n      onChange: (e) => onChange(e.target.value),\n      onKeyDown: handleKeyDown,\n      onFocus: () => {\n        if (results.length > 0) setShowDropdown(true);\n      },\n      className: 'tvs-exercise-input tvs-input-name',\n      autoComplete: 'off',\n    }),\n    isSearching && React.createElement(\n      'div',\n      { className: 'tvs-search-spinner' },\n      '\uD83D\uDD0D'\n    ),\n    error && React.createElement(\n      'div',\n      { className: 'tvs-search-error' },\n      error\n    ),\n    renderDropdown()\n  );\n}\n\n// Export as default for import in ManualActivityTracker\nexport default ExerciseSearchDropdown;\n", "/**\n * WorkoutCircuit Component\n * \n * Renders a single circuit with exercises, allowing add/remove/edit operations.\n * Supports both reps-based and time-based exercises.\n */\n\nimport ExerciseSearchDropdown from './ExerciseSearchDropdown.js';\n\nconst { useState } = window.React;\nconst React = window.React;\n\nconst WorkoutCircuit = ({\n  circuit,\n  isActive,\n  onUpdate,\n  onRemove,\n  onSetActive,\n  canRemove = true\n}) => {\n  const [currentExerciseName, setCurrentExerciseName] = useState('');\n  const [currentExerciseId, setCurrentExerciseId] = useState(null);\n  const [currentReps, setCurrentReps] = useState(10);\n  const [currentWeight, setCurrentWeight] = useState(0);\n  const [currentMetricType, setCurrentMetricType] = useState('reps');\n  const [isEditingName, setIsEditingName] = useState(false);\n  const [editName, setEditName] = useState(circuit.name);\n\n  const handleAddExercise = () => {\n    if (!currentExerciseName.trim()) return;\n\n    const newExercise = {\n      name: currentExerciseName.trim(),\n      exercise_id: currentExerciseId,\n      reps: currentReps,\n      weight: currentWeight,\n      metric_type: currentMetricType\n    };\n\n    onUpdate({\n      ...circuit,\n      exercises: [...circuit.exercises, newExercise]\n    });\n\n    // Reset form\n    setCurrentExerciseName('');\n    setCurrentExerciseId(null);\n    setCurrentReps(10);\n    setCurrentWeight(0);\n    setCurrentMetricType('reps');\n  };\n\n  const handleRemoveExercise = (index) => {\n    onUpdate({\n      ...circuit,\n      exercises: circuit.exercises.filter((_, i) => i !== index)\n    });\n  };\n\n  const handleUpdateSets = (sets) => {\n    onUpdate({\n      ...circuit,\n      sets: Math.max(1, parseInt(sets) || 1)\n    });\n  };\n\n  const handleSaveName = () => {\n    if (editName.trim()) {\n      onUpdate({\n        ...circuit,\n        name: editName.trim()\n      });\n    }\n    setIsEditingName(false);\n  };\n\n  const calculateTotals = () => {\n    const totalRepsPerRound = circuit.exercises.reduce((sum, ex) => {\n      return sum + (ex.metric_type === 'reps' ? ex.reps : 0);\n    }, 0);\n    \n    const totalVolumePerRound = circuit.exercises.reduce((sum, ex) => {\n      return sum + (ex.reps * ex.weight);\n    }, 0);\n\n    return {\n      totalReps: totalRepsPerRound * circuit.sets,\n      totalVolume: totalVolumePerRound * circuit.sets\n    };\n  };\n\n  const totals = calculateTotals();\n\n  return React.createElement(\n    'div',\n    { \n      className: `tvs-circuit-container ${isActive ? 'tvs-circuit-active' : ''}`,\n      onClick: () => !isActive && onSetActive(circuit.id)\n    },\n    \n    // Circuit header\n    React.createElement(\n      'div',\n      { className: 'tvs-circuit-header' },\n      \n      // Circuit name (editable with visual cue)\n      !isEditingName \n        ? React.createElement(\n            'div',\n            { \n              className: 'tvs-circuit-name-wrapper',\n              onClick: () => {\n                setEditName(circuit.name);\n                setIsEditingName(true);\n              },\n              title: 'Click to edit circuit name'\n            },\n            React.createElement('h4', { className: 'tvs-circuit-name' }, circuit.name),\n            React.createElement('span', { className: 'tvs-circuit-edit-icon' }, '\u270E')\n          )\n        : React.createElement('input', {\n            type: 'text',\n            value: editName,\n            onChange: (e) => setEditName(e.target.value),\n            onBlur: handleSaveName,\n            onKeyDown: (e) => {\n              if (e.key === 'Enter') handleSaveName();\n              if (e.key === 'Escape') {\n                setEditName(circuit.name);\n                setIsEditingName(false);\n              }\n            },\n            className: 'tvs-circuit-name-edit',\n            autoFocus: true\n          }),\n      \n      // Circuit sets/rounds\n      React.createElement(\n        'div',\n        { className: 'tvs-circuit-sets' },\n        React.createElement('input', {\n          type: 'number',\n          value: circuit.sets,\n          min: '1',\n          onChange: (e) => handleUpdateSets(e.target.value),\n          className: 'tvs-circuit-sets-input',\n          title: 'Number of rounds'\n        }),\n        React.createElement('span', null, circuit.sets === 1 ? ' round' : ' rounds')\n      ),\n      \n      // Remove circuit button\n      canRemove && React.createElement(\n        'button',\n        {\n          className: 'tvs-btn-icon tvs-circuit-remove',\n          onClick: (e) => {\n            e.stopPropagation();\n            if (confirm(`Remove ${circuit.name}?`)) {\n              onRemove(circuit.id);\n            }\n          },\n          title: 'Remove circuit'\n        },\n        '\u2715'\n      )\n    ),\n\n    // Exercise list\n    circuit.exercises.length > 0 && React.createElement(\n      'div',\n      { className: 'tvs-circuit-exercises' },\n      circuit.exercises.map((exercise, idx) =>\n        React.createElement(\n          'div',\n          { key: idx, className: 'tvs-circuit-exercise-item' },\n          React.createElement('span', { className: 'tvs-exercise-number' }, `${idx + 1}.`),\n          React.createElement('span', { className: 'tvs-exercise-name' }, exercise.name),\n          React.createElement(\n            'span',\n            { className: 'tvs-exercise-stats' },\n            `${exercise.reps}${exercise.metric_type === 'time' ? 's' : ''}${exercise.weight > 0 ? ` @ ${exercise.weight}kg` : ' (bodyweight)'}`\n          ),\n          React.createElement(\n            'button',\n            {\n              className: 'tvs-btn-icon',\n              onClick: () => handleRemoveExercise(idx),\n              title: 'Remove exercise'\n            },\n            '\u2715'\n          )\n        )\n      )\n    ),\n\n    // Add exercise form (only show when circuit is active)\n    isActive && React.createElement(\n      'div',\n      { className: 'tvs-circuit-add-exercise' },\n      \n      // Form header\n      React.createElement(\n        'div',\n        { className: 'tvs-exercise-form-header' },\n        React.createElement('label', { className: 'tvs-form-label tvs-form-label-name' }, 'Exercise'),\n        React.createElement(\n          'label',\n          { className: 'tvs-form-label tvs-form-label-reps' },\n          React.createElement(\n            'span',\n            { className: 'tvs-metric-type-toggle' },\n          React.createElement(\n            'button',\n            {\n              type: 'button',\n              className: currentMetricType === 'reps' ? 'tvs-toggle-btn tvs-toggle-active' : 'tvs-toggle-btn',\n              onClick: () => setCurrentMetricType('reps'),\n              title: 'Repetitions'\n            },\n            '\uD83D\uDD22'\n          ),\n          React.createElement(\n            'button',\n            {\n              type: 'button',\n              className: currentMetricType === 'time' ? 'tvs-toggle-btn tvs-toggle-active' : 'tvs-toggle-btn',\n              onClick: () => setCurrentMetricType('time'),\n              title: 'Time (seconds)'\n            },\n            '\u23F1'\n          )\n          )\n        ),\n        React.createElement('label', { className: 'tvs-form-label tvs-form-label-weight' }, 'Weight (0 = bodyweight)')\n      ),\n      \n      // Form inputs\n      React.createElement(\n        'div',\n        { className: 'tvs-exercise-form-inputs' },\n        React.createElement(ExerciseSearchDropdown, {\n          value: currentExerciseName,\n          onChange: (value) => {\n            setCurrentExerciseName(value);\n            if (currentExerciseId) setCurrentExerciseId(null);\n          },\n          onSelect: (exercise) => {\n            setCurrentExerciseName(exercise.name);\n            setCurrentExerciseId(exercise.id);\n            setCurrentMetricType(exercise.default_metric || 'reps');\n            if (exercise.default_metric === 'time') {\n              setCurrentReps(60);\n            } else {\n              setCurrentReps(10);\n            }\n          },\n          placeholder: 'Search exercise...',\n          className: 'tvs-exercise-search'\n        }),\n        React.createElement('input', {\n          type: 'number',\n          placeholder: currentMetricType === 'reps' ? '10' : '60',\n          value: currentReps,\n          min: '1',\n          onChange: (e) => setCurrentReps(Math.max(1, parseInt(e.target.value) || 1)),\n          className: 'tvs-exercise-number tvs-input-reps',\n          title: currentMetricType === 'reps' ? 'Repetitions' : 'Seconds'\n        }),\n        React.createElement('input', {\n          type: 'number',\n          placeholder: '0',\n          value: currentWeight,\n          min: '0',\n          step: '0.5',\n          onChange: (e) => setCurrentWeight(Math.max(0, parseFloat(e.target.value) || 0)),\n          className: 'tvs-exercise-number tvs-input-weight'\n        })\n      ),\n      \n      // Add button (separate from grid)\n      React.createElement(\n        'button',\n        {\n          className: 'tvs-btn tvs-btn-secondary tvs-btn-add-exercise',\n          onClick: handleAddExercise,\n          disabled: !currentExerciseName.trim()\n        },\n        '+ Add'\n      )\n    ),\n\n    // Circuit summary\n    circuit.exercises.length > 0 && React.createElement(\n      'div',\n      { className: 'tvs-circuit-summary' },\n      React.createElement('span', null, `${circuit.exercises.length} exercises`),\n      React.createElement('span', null, '\u2022'),\n      React.createElement('span', null, `${totals.totalReps} reps`),\n      totals.totalVolume > 0 && React.createElement(React.Fragment, null,\n        React.createElement('span', null, '\u2022'),\n        React.createElement('span', null, `${totals.totalVolume}kg volume`)\n      )\n    )\n  );\n};\n\nexport default WorkoutCircuit;\n", "import { DEBUG, log } from '../utils/debug.js';\nimport ExerciseSearchDropdown from './ExerciseSearchDropdown.js';\nimport WorkoutCircuit from './WorkoutCircuit.js';\n\nconst { useState, useEffect, useRef } = window.React;\n\n/**\n * Helper to make authenticated API requests\n */\nasync function apiFetch(url, options = {}) {\n  const fullUrl = url.startsWith('/wp-json') ? url : `/wp-json${url}`;\n  const response = await fetch(fullUrl, {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      'X-WP-Nonce': window.TVS_SETTINGS?.nonce || '',\n      ...options.headers,\n    },\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json().catch(() => ({}));\n    throw new Error(errorData.message || `HTTP ${response.status}: ${response.statusText}`);\n  }\n\n  return response.json();\n}\n\n/**\n * ManualActivityTracker - Main component for Issue #21\n * \n * Allows users to track manual indoor activities (treadmill, stationary bike, etc.)\n * Features:\n * - Activity type selection (Run, Ride, Walk, Hike, Swim, Workout)\n * - Live dashboard with timer and metrics\n * - Speed, incline, cadence, power controls\n * - Auto-save every 30 seconds\n * - Session recovery from localStorage\n * - Pause/Resume/Finish controls\n * - Strava upload option after finish\n */\nexport default function ManualActivityTracker({\n  React,\n  title,\n  showTypeSelector,\n  allowedTypes,\n  autoStart,\n  defaultType,\n}) {\n  const [step, setStep] = useState('select'); // 'select', 'tracking', 'calibration', 'finished'\n  const [mode, setMode] = useState('live'); // 'live' or 'retrospective'\n  const [selectedType, setSelectedType] = useState(defaultType);\n  const [calibratedValues, setCalibratedValues] = useState(null); // For storing calibrated values before finish\n  const [sessionId, setSessionId] = useState(null);\n  const [sessionData, setSessionData] = useState(null);\n  const [isPaused, setIsPaused] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [activityId, setActivityId] = useState(null);\n  const [permalink, setPermalink] = useState(null);\n  const [uploadingToStrava, setUploadingToStrava] = useState(false);\n  const [showConfirmModal, setShowConfirmModal] = useState(false);\n  const [showCancelModal, setShowCancelModal] = useState(false);\n  const [editingField, setEditingField] = useState(null); // Track which field is being edited\n  const [editValue, setEditValue] = useState(''); // Temporary edit value\n  const [editingMainTimer, setEditingMainTimer] = useState(false); // Track if main timer is being edited\n\n  // Metrics state\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [distance, setDistance] = useState(0);\n  const [speed, setSpeed] = useState(0);\n  const [pace, setPace] = useState(0);\n  const [incline, setIncline] = useState(0);\n  const [cadence, setCadence] = useState(0);\n  const [power, setPower] = useState(0);\n  const [laps, setLaps] = useState(0);\n  const [poolLength, setPoolLength] = useState(25); // meters\n  \n  // Circuit-based workout structure\n  const [workoutCircuits, setWorkoutCircuits] = useState([\n    { id: 1, name: 'Circuit 1', sets: 1, exercises: [] }\n  ]); // Array of circuits, each with id, name, sets (rounds), and exercises array\n  const [activeCircuitId, setActiveCircuitId] = useState(1); // Which circuit we're adding exercises to\n  \n  // Backward compatibility: Keep old format for migration\n  const [workoutExercises, setWorkoutExercises] = useState([]); // Array of {name, sets, reps, weight, exercise_id}\n  \n  const [currentExerciseName, setCurrentExerciseName] = useState('');\n  const [currentExerciseId, setCurrentExerciseId] = useState(null); // ID from library (if selected)\n  const [currentSets, setCurrentSets] = useState(3);\n  const [currentReps, setCurrentReps] = useState(10);\n  const [currentWeight, setCurrentWeight] = useState(0);\n  const [currentMetricType, setCurrentMetricType] = useState('reps'); // 'reps' or 'time'\n\n  // Calibration state (for live mode before finishing)\n  const [calibDuration, setCalibDuration] = useState(0);\n  const [calibDistance, setCalibDistance] = useState(0);\n  const [calibIncline, setCalibIncline] = useState(0);\n  const [calibCadence, setCalibCadence] = useState(0);\n  const [calibPower, setCalibPower] = useState(0);\n  const [calibLaps, setCalibLaps] = useState(0);\n  const [calibNotes, setCalibNotes] = useState('');\n  const [calibRating, setCalibRating] = useState(0);\n\n  const timerRef = useRef(null);\n  const autoSaveRef = useRef(null);\n  const startTimeRef = useRef(null);\n  const containerRef = useRef(null);\n  const wakeLockRef = useRef(null);\n\n  // Auto-scroll to top when step changes\n  useEffect(() => {\n    if (containerRef.current) {\n      containerRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    }\n  }, [step]);\n\n  // Auto-calculate distance and pace for Swim activities\n  useEffect(() => {\n    if (selectedType === 'Swim' && laps > 0 && poolLength > 0) {\n      const distanceKm = parseFloat((laps * poolLength / 1000).toFixed(2));\n      setDistance(distanceKm);\n      \n      // Calculate pace (seconds per lap) if we have duration\n      if (elapsedTime > 0 && laps > 0) {\n        const paceValue = Math.round(elapsedTime / laps);\n        setPace(paceValue);\n      }\n    }\n  }, [laps, poolLength, elapsedTime, selectedType]);\n\n  // Auto-start if configured (only in live mode)\n  useEffect(() => {\n    if (autoStart && !showTypeSelector && mode === 'live') {\n      handleStartActivity(defaultType);\n    }\n  }, []);\n\n  // Check for saved session on mount\n  useEffect(() => {\n    const saved = localStorage.getItem('tvs_manual_session');\n    if (saved) {\n      try {\n        const data = JSON.parse(saved);\n        if (data.sessionId && data.type) {\n          // Prompt user to recover session\n          if (confirm('You have an unfinished activity. Do you want to continue?')) {\n            setSessionId(data.sessionId);\n            setSelectedType(data.type);\n            setMode(data.mode || 'live');\n            setElapsedTime(data.elapsed_time || 0);\n            setDistance(data.distance || 0);\n            setSpeed(data.speed || 0);\n            setPace(data.pace || 0);\n            setIncline(data.incline || 0);\n            setCadence(data.cadence || 0);\n            setPower(data.power || 0);\n            setStep('tracking');\n            if (mode === 'live') {\n              startTimeRef.current = Date.now() - (data.elapsed_time || 0) * 1000;\n              startTimer();\n            }\n          } else {\n            localStorage.removeItem('tvs_manual_session');\n          }\n        }\n      } catch (e) {\n        if (DEBUG) log('Failed to parse saved session:', e);\n        localStorage.removeItem('tvs_manual_session');\n      }\n    }\n  }, []);\n\n  // Timer logic\n  const startTimer = () => {\n    if (timerRef.current || mode === 'retrospective') return; // Don't start timer in retrospective mode\n    timerRef.current = setInterval(() => {\n      if (startTimeRef.current) {\n        const elapsed = Math.floor((Date.now() - startTimeRef.current) / 1000);\n        setElapsedTime(elapsed);\n      }\n    }, 1000);\n  };\n\n  // Auto-calculate distance from speed and elapsed time (live mode only)\n  useEffect(() => {\n    if (mode === 'live' && step === 'tracking' && !isPaused && speed > 0 && elapsedTime > 0) {\n      const distanceKm = (speed * elapsedTime) / 3600;\n      setDistance(parseFloat(distanceKm.toFixed(2)));\n    }\n  }, [mode, step, isPaused, speed, elapsedTime]);\n\n  const stopTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n  };\n\n  // Auto-save logic (every 30 seconds)\n  useEffect(() => {\n    if (step === 'tracking' && sessionId && !isPaused) {\n      autoSaveRef.current = setInterval(() => {\n        handleUpdateSession(false); // Silent update, no flash message\n      }, 30000);\n    }\n    return () => {\n      if (autoSaveRef.current) {\n        clearInterval(autoSaveRef.current);\n        autoSaveRef.current = null;\n      }\n    };\n  }, [step, sessionId, isPaused, elapsedTime, distance, speed, pace, incline, cadence, power]);\n\n  // Save to localStorage whenever metrics change\n  useEffect(() => {\n    if (step === 'tracking' && sessionId) {\n      localStorage.setItem('tvs_manual_session', JSON.stringify({\n        sessionId,\n        type: selectedType,\n        mode,\n        elapsed_time: elapsedTime,\n        distance,\n        speed,\n        pace,\n        incline,\n        cadence,\n        power,\n      }));\n    }\n  }, [step, sessionId, elapsedTime, distance, speed, pace, incline, cadence, power]);\n\n  // Wake Lock helpers\n  const requestWakeLock = async () => {\n    try {\n      if ('wakeLock' in navigator && mode === 'live') {\n        wakeLockRef.current = await navigator.wakeLock.request('screen');\n        if (DEBUG) log('Wake Lock activated');\n      }\n    } catch (err) {\n      if (DEBUG) log('Wake Lock error:', err);\n    }\n  };\n\n  const releaseWakeLock = async () => {\n    try {\n      if (wakeLockRef.current) {\n        await wakeLockRef.current.release();\n        wakeLockRef.current = null;\n        if (DEBUG) log('Wake Lock released');\n      }\n    } catch (err) {\n      if (DEBUG) log('Wake Lock release error:', err);\n    }\n  };\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      stopTimer();\n      if (autoSaveRef.current) clearInterval(autoSaveRef.current);\n      releaseWakeLock();\n    };\n  }, []);\n\n  // API: Start session\n  const handleStartActivity = async (type) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiFetch('/tvs/v1/activities/manual/start', {\n        method: 'POST',\n        body: JSON.stringify({ type }),\n      });\n\n      if (result.success && result.session_id) {\n        setSessionId(result.session_id);\n        setSessionData(result.session_data);\n        setSelectedType(type);\n        setStep('tracking');\n        if (mode === 'live') {\n          startTimeRef.current = Date.now();\n          startTimer();\n          requestWakeLock();\n        }\n        if (typeof window.tvsFlash === 'function') {\n          window.tvsFlash(`${type} activity started!`, 'success');\n        }\n      } else {\n        throw new Error(data.message || 'Failed to start activity');\n      }\n    } catch (err) {\n      setError(err.message);\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash(err.message, 'error');\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // API: Update session metrics\n  const handleUpdateSession = async (showMessage = true) => {\n    if (!sessionId) return;\n\n    try {\n      const payload = {\n        elapsed_time: elapsedTime,\n        distance,\n        speed,\n        pace,\n        incline,\n        cadence,\n        power,\n      };\n\n      // Add workout-specific data\n      if (selectedType === 'Workout') {\n        payload.circuits = workoutCircuits; // Array of {id, name, sets, exercises[]}\n        \n        // Backward compatibility: Also save as flat exercise list\n        payload.exercises = workoutCircuits.flatMap(circuit => \n          circuit.exercises.map(ex => ({\n            ...ex,\n            sets: circuit.sets, // Use circuit sets (rounds)\n            circuit_name: circuit.name\n          }))\n        );\n      }\n\n      // Add swim-specific data\n      if (selectedType === 'Swim') {\n        payload.laps = laps;\n        payload.pool_length = poolLength;\n      }\n\n      const result = await apiFetch(`/tvs/v1/activities/manual/${sessionId}`, {\n        method: 'PATCH',\n        body: JSON.stringify(payload),\n      });\n\n      if (result.success) {\n        setSessionData(result.session_data);\n        if (showMessage && typeof window.tvsFlash === 'function') {\n          window.tvsFlash('\uD83D\uDCBE Progress saved', 'success');\n        }\n      }\n    } catch (err) {\n      if (DEBUG) log('Failed to update session:', err);\n    }\n  };\n\n  // API: Finish activity\n  const handleFinishActivity = async () => {\n    if (!sessionId) return;\n\n    // If we have calibrated values, update session with those first\n    if (calibratedValues) {\n      // Update state with calibrated values\n      if (calibratedValues.duration !== undefined) setElapsedTime(calibratedValues.duration);\n      if (calibratedValues.distance !== undefined) setDistance(calibratedValues.distance);\n      if (calibratedValues.incline !== undefined) setIncline(calibratedValues.incline);\n      if (calibratedValues.cadence !== undefined) setCadence(calibratedValues.cadence);\n      if (calibratedValues.power !== undefined) setPower(calibratedValues.power);\n      if (calibratedValues.laps !== undefined) setLaps(calibratedValues.laps);\n      \n      // Wait a tick for state to update\n      await new Promise(resolve => setTimeout(resolve, 10));\n    }\n\n    // Final update before finishing\n    await handleUpdateSession(false);\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const payload = {};\n      \n      // Add notes and rating if provided\n      if (calibratedValues?.notes) {\n        payload.notes = calibratedValues.notes;\n      }\n      if (calibratedValues?.rating) {\n        payload.rating = calibratedValues.rating;\n      }\n\n      const result = await apiFetch(`/tvs/v1/activities/manual/${sessionId}/finish`, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n      });\n\n      if (result.success && result.activity_id) {\n        setActivityId(result.activity_id);\n        setPermalink(result.permalink);\n        setStep('finished');\n        stopTimer();\n        releaseWakeLock();\n        localStorage.removeItem('tvs_manual_session');\n        \n        // Dispatch event to update My Activities block\n        window.dispatchEvent(new CustomEvent('tvs:activity-updated'));\n        \n        if (typeof window.tvsFlash === 'function') {\n          window.tvsFlash('\uD83C\uDF89 Activity saved successfully!', 'success');\n        }\n      } else {\n        throw new Error(data.message || 'Failed to finish activity');\n      }\n    } catch (err) {\n      setError(err.message);\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash(err.message, 'error');\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Upload to Strava\n  const uploadToStrava = async () => {\n    if (!activityId) return;\n    try {\n      setUploadingToStrava(true);\n      const response = await fetch(`/wp-json/tvs/v1/activities/${activityId}/strava`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-WP-Nonce': window.TVS_SETTINGS?.nonce || ''\n        },\n        credentials: 'same-origin',\n      });\n      const result = await response.json();\n      if (!response.ok) {\n        throw new Error(result.message || 'Upload failed');\n      }\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash('\uD83D\uDC4D Uploaded to Strava!', 'success');\n      }\n      window.dispatchEvent(new CustomEvent('tvs:activity-updated'));\n    } catch (err) {\n      console.error('Strava upload failed:', err);\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash('Failed to upload to Strava: ' + (err?.message || String(err)), 'error');\n      }\n    } finally {\n      setUploadingToStrava(false);\n    }\n  };\n\n  // Cancel activity (retrospective mode)\n  const handleCancelActivity = () => {\n    setShowCancelModal(true);\n  };\n\n  const handleConfirmCancel = () => {\n    // Clear localStorage\n    localStorage.removeItem('tvsManualActivitySession');\n    \n    // Reset to initial state\n    setSelectedType('');\n    setElapsedTime(0);\n    setDistance(0);\n    setSpeed(0);\n    setIncline(0);\n    setCadence(0);\n    setPower(0);\n    setLaps(0);\n    setPoolLength(25);\n    \n    // Reset circuits to default\n    setWorkoutCircuits([\n      { id: Date.now(), name: 'Circuit 1', sets: 1, exercises: [] }\n    ]);\n    setActiveCircuitId(Date.now());\n    \n    // Clear old format (backward compatibility)\n    setWorkoutExercises([]);\n    \n    setCurrentExerciseName('');\n    setCurrentSets(3);\n    setCurrentReps(10);\n    setCurrentWeight(0);\n    setCurrentMetricType('reps');\n    setIsPaused(false);\n    setSessionId(null);\n    setStep('select');\n    setShowCancelModal(false);\n    \n    if (typeof window.tvsFlash === 'function') {\n      window.tvsFlash('Activity cancelled', 'info');\n    }\n  };\n\n  // Pause/Resume\n  const handleTogglePause = () => {\n    if (isPaused) {\n      // Resume\n      startTimeRef.current = Date.now() - elapsedTime * 1000;\n      setIsPaused(false);\n      startTimer();\n      requestWakeLock();\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash('\u25B6\uFE0F Activity resumed', 'success');\n      }\n    } else {\n      // Pause\n      stopTimer(); // Stop the timer interval\n      setIsPaused(true);\n      releaseWakeLock();\n      if (typeof window.tvsFlash === 'function') {\n        window.tvsFlash('\u23F8 Activity paused', 'info');\n      }\n    }\n  };\n\n  // Format time as HH:MM:SS\n  const formatTime = (seconds) => {\n    const h = Math.floor(seconds / 3600);\n    const m = Math.floor((seconds % 3600) / 60);\n    const s = seconds % 60;\n    return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n  };\n\n  // Format pace as MM:SS (no hours, for pace display)\n  const formatTimePace = (totalMinutes) => {\n    // totalMinutes is a decimal like 6.5 (6 min 30 sec per km)\n    const m = Math.floor(totalMinutes);\n    const s = Math.round((totalMinutes - m) * 60);\n    return `${m}:${s.toString().padStart(2, '0')}`;\n  };\n\n  // Parse time string (h:mm:ss, mm:ss, or ss) to seconds\n  const parseTimeInput = (input) => {\n    if (!input) return 0;\n    const parts = input.split(':').map(p => parseInt(p, 10) || 0);\n    if (parts.length === 3) {\n      // h:mm:ss\n      return parts[0] * 3600 + parts[1] * 60 + parts[2];\n    } else if (parts.length === 2) {\n      // mm:ss\n      return parts[0] * 60 + parts[1];\n    } else {\n      // just seconds\n      return parts[0];\n    }\n  };\n\n  // Handle inline edit save\n  const handleInlineEdit = (field, value) => {\n    switch (field) {\n      case 'duration':\n        const seconds = parseTimeInput(value);\n        setElapsedTime(Math.max(0, seconds));\n        break;\n      case 'distance':\n        setDistance(Math.max(0, parseFloat(value) || 0));\n        break;\n      case 'speed':\n        setSpeed(Math.max(0, parseFloat(value) || 0));\n        break;\n      case 'incline':\n        setIncline(Math.max(-5, Math.min(15, parseFloat(value) || 0)));\n        break;\n      case 'cadence':\n        setCadence(Math.max(0, parseInt(value, 10) || 0));\n        break;\n      case 'power':\n        setPower(Math.max(0, parseInt(value, 10) || 0));\n        break;\n      case 'laps':\n        setLaps(Math.max(0, parseInt(value, 10) || 0));\n        break;\n    }\n    setEditingField(null);\n    setEditValue('');\n  };\n\n  // Calculate pace from speed\n  useEffect(() => {\n    if (speed > 0) {\n      setPace(parseFloat((60 / speed).toFixed(2)));\n    } else {\n      setPace(0);\n    }\n  }, [speed]);\n\n  // Get metrics configuration based on activity type\n  const getMetricsConfig = () => {\n    const baseConfig = {\n      'Run': { display: ['distance', 'speed', 'pace', 'incline'], controls: ['speed', 'incline', 'cadence'] },\n      'Walk': { display: ['distance', 'speed', 'pace', 'incline'], controls: ['speed', 'incline', 'cadence'] },\n      'Hike': { display: ['distance', 'speed', 'pace', 'incline'], controls: ['speed', 'incline', 'cadence'] },\n      'Ride': { display: ['distance', 'speed', 'incline', 'cadence'], controls: ['speed', 'incline', 'cadence', 'power'] },\n      'Swim': { display: ['laps', 'poolLength', 'distance', 'pace'], controls: ['laps', 'poolLength'] },\n      'Workout': { display: [], controls: [] }\n    };\n\n    const config = baseConfig[selectedType] || { display: ['distance', 'speed', 'pace'], controls: ['speed'] };\n    \n    // In retrospective mode, replace speed controls with distance and duration\n    if (mode === 'retrospective') {\n      if (['Run', 'Walk', 'Hike', 'Ride'].includes(selectedType)) {\n        config.controls = ['distance', 'duration', 'incline', 'cadence'];\n        if (selectedType === 'Ride') config.controls.push('power');\n      } else if (selectedType === 'Swim') {\n        config.controls = ['laps', 'poolLength', 'duration'];\n      } else if (selectedType === 'Workout') {\n        config.controls = ['duration'];\n      }\n    }\n    \n    return config;\n  };\n\n  const metricsConfig = getMetricsConfig();\n\n  // Render metrics based on activity type\n  const renderMetric = (type) => {\n    const metricDefs = {\n      distance: { label: 'Distance (km)', value: distance.toFixed(2) },\n      speed: { label: 'Speed (km/h)', value: speed.toFixed(1) },\n      pace: { label: selectedType === 'Swim' ? 'Pace (sec/lap)' : 'Pace (min/km)', value: pace > 0 ? (selectedType === 'Swim' ? pace : formatTimePace(pace)) : '\u2014' },\n      incline: { label: 'Incline (%)', value: incline.toFixed(1) },\n      cadence: { label: selectedType === 'Run' ? 'Cadence (SPM)' : 'Cadence (RPM)', value: cadence },\n      laps: { label: 'Laps', value: laps },\n      poolLength: { label: 'Pool Length (m)', value: poolLength }\n    };\n    \n    const metric = metricDefs[type];\n    if (!metric) return null;\n    \n    return React.createElement(\n      'div',\n      { className: 'tvs-metric', key: type },\n      React.createElement('label', null, metric.label),\n      React.createElement('div', { className: 'tvs-metric-value' }, metric.value)\n    );\n  };\n\n  // Render control based on activity type\n  const renderControl = (type) => {\n    const controls = {\n      distance: {\n        label: 'Distance (km)',\n        value: distance.toFixed(2),\n        onDecrease: () => setDistance(Math.max(0, parseFloat((distance - 0.1).toFixed(2)))),\n        onIncrease: () => setDistance(parseFloat((distance + 0.1).toFixed(2)))\n      },\n      duration: {\n        label: 'Duration (h:mm:ss)',\n        value: formatTime(elapsedTime),\n        onDecrease: () => setElapsedTime(Math.max(0, elapsedTime - 60)),\n        onIncrease: () => setElapsedTime(elapsedTime + 60)\n      },\n      speed: {\n        label: 'Speed (km/h)',\n        value: speed.toFixed(1),\n        onDecrease: () => setSpeed(Math.max(0, speed - 0.5)),\n        onIncrease: () => setSpeed(speed + 0.5)\n      },\n      incline: {\n        label: 'Incline (%)',\n        value: incline.toFixed(1) + '%',\n        onDecrease: () => setIncline(Math.max(-5, parseFloat((incline - 0.5).toFixed(1)))),\n        onIncrease: () => setIncline(Math.min(15, parseFloat((incline + 0.5).toFixed(1))))\n      },\n      cadence: {\n        label: selectedType === 'Run' ? 'Cadence (SPM)' : 'Cadence (RPM)',\n        value: cadence,\n        onDecrease: () => setCadence(Math.max(0, cadence - 5)),\n        onIncrease: () => setCadence(cadence + 5)\n      },\n      power: {\n        label: 'Power (W)',\n        value: power,\n        onDecrease: () => setPower(Math.max(0, power - 10)),\n        onIncrease: () => setPower(power + 10)\n      },\n      laps: {\n        label: 'Laps',\n        value: laps,\n        onDecrease: () => setLaps(Math.max(0, laps - 1)),\n        onIncrease: () => setLaps(laps + 1)\n      },\n      poolLength: {\n        label: 'Pool Length (m)',\n        value: poolLength,\n        onDecrease: () => setPoolLength(poolLength === 50 ? 25 : 25),\n        onIncrease: () => setPoolLength(poolLength === 25 ? 50 : 50)\n      }\n    };\n    \n    const control = controls[type];\n    if (!control) return null;\n    \n    const isEditing = editingField === type;\n    const canEdit = mode === 'retrospective';\n    \n    return React.createElement(\n      'div',\n      { className: 'tvs-control-row', key: type },\n      React.createElement('label', null, control.label),\n      React.createElement(\n        'div',\n        { className: 'tvs-control-buttons' },\n        (type === 'duration' || type === 'distance') && canEdit && React.createElement(\n          'button', \n          { \n            onClick: type === 'duration' ? () => setElapsedTime(Math.max(0, elapsedTime - 1)) : () => setDistance(Math.max(0, parseFloat((distance - 0.01).toFixed(2)))), \n            className: 'tvs-btn-small' \n          }, \n          type === 'duration' ? '\u22121s' : '\u22120.01'\n        ),\n        React.createElement('button', { onClick: control.onDecrease }, '\u2212'),\n        isEditing ? React.createElement('input', {\n          type: 'text',\n          className: 'tvs-inline-edit',\n          value: editValue,\n          onChange: (e) => setEditValue(e.target.value),\n          onBlur: () => handleInlineEdit(type, editValue),\n          onKeyDown: (e) => {\n            if (e.key === 'Enter') handleInlineEdit(type, editValue);\n            if (e.key === 'Escape') { setEditingField(null); setEditValue(''); }\n          },\n          autoFocus: true,\n          placeholder: type === 'duration' ? 'h:mm:ss' : control.value\n        }) : React.createElement(\n          'span',\n          { \n            onClick: canEdit ? () => {\n              setEditingField(type);\n              setEditValue(\n                type === 'duration' ? formatTime(elapsedTime) :\n                type === 'distance' ? distance.toFixed(2) :\n                type === 'speed' ? speed.toFixed(1) :\n                type === 'incline' ? incline.toFixed(1) :\n                String(control.value)\n              );\n            } : null,\n            className: canEdit ? 'tvs-editable' : '',\n            title: canEdit ? 'Click to edit' : ''\n          }, \n          control.value\n        ),\n        React.createElement('button', { onClick: control.onIncrease }, '+'),\n        (type === 'duration' || type === 'distance') && canEdit && React.createElement(\n          'button', \n          { \n            onClick: type === 'duration' ? () => setElapsedTime(elapsedTime + 1) : () => setDistance(parseFloat((distance + 0.01).toFixed(2))), \n            className: 'tvs-btn-small' \n          }, \n          type === 'duration' ? '+1s' : '+0.01'\n        )\n      )\n    );\n  };\n\n  // Render: Type selection\n  if (step === 'select') {\n    return React.createElement(\n      'div',\n      { className: 'tvs-manual-tracker tvs-card', ref: containerRef },\n      React.createElement('h3', { className: 'tvs-tracker-title' }, title),\n      \n      // Mode selector\n      React.createElement(\n        'div',\n        { className: 'tvs-mode-selector' },\n        React.createElement(\n          'button',\n          {\n            className: `tvs-mode-btn ${mode === 'live' ? 'active' : ''}`,\n            onClick: () => setMode('live')\n          },\n          '\u23F1\uFE0F Track Live',\n          React.createElement('span', { className: 'tvs-mode-desc' }, 'Real-time tracking')\n        ),\n        React.createElement(\n          'button',\n          {\n            className: `tvs-mode-btn ${mode === 'retrospective' ? 'active' : ''}`,\n            onClick: () => setMode('retrospective')\n          },\n          '\uD83D\uDCDD Log Past Activity',\n          React.createElement('span', { className: 'tvs-mode-desc' }, 'Enter completed activity')\n        )\n      ),\n      \n      showTypeSelector && React.createElement(\n        'div',\n        { className: 'tvs-type-selector' },\n        allowedTypes.map((type) =>\n          React.createElement(\n            'button',\n            {\n              key: type,\n              className: `tvs-type-btn ${selectedType === type ? 'active' : ''}`,\n              onClick: () => setSelectedType(type),\n              disabled: isLoading,\n            },\n            getActivityIcon(type),\n            React.createElement('span', null, type)\n          )\n        )\n      ),\n      React.createElement(\n        'button',\n        {\n          className: 'tvs-btn tvs-btn-primary',\n          onClick: () => handleStartActivity(selectedType),\n          disabled: isLoading,\n        },\n        isLoading ? 'Starting...' : `Start ${selectedType}`\n      )\n    );\n  }\n\n  // Render: Tracking dashboard\n  if (step === 'tracking') {\n    return React.createElement(\n      'div',\n      { className: 'tvs-manual-tracker tvs-dashboard tvs-card', ref: containerRef },\n      React.createElement(\n        'div',\n        { className: 'tvs-dashboard-header' },\n        React.createElement(\n          'div',\n          null,\n          React.createElement('h3', { className: 'tvs-tracker-title' }, `${selectedType} Activity`),\n          React.createElement(\n            'span',\n            { className: 'tvs-badge tvs-badge-accent', style: { fontSize: 'var(--tvs-text-xs)', marginTop: 'var(--tvs-space-1)' } },\n            mode === 'retrospective' ? '\uD83D\uDCDD Retrospective' : '\u23F1\uFE0F Live'\n          )\n        ),\n        editingMainTimer ? React.createElement('input', {\n          type: 'text',\n          className: 'tvs-timer-edit',\n          value: editValue,\n          onChange: (e) => setEditValue(e.target.value),\n          onBlur: () => {\n            handleInlineEdit('duration', editValue);\n            setEditingMainTimer(false);\n          },\n          onKeyDown: (e) => {\n            if (e.key === 'Enter') {\n              handleInlineEdit('duration', editValue);\n              setEditingMainTimer(false);\n            }\n            if (e.key === 'Escape') {\n              setEditingMainTimer(false);\n              setEditValue('');\n            }\n          },\n          autoFocus: true,\n          placeholder: 'h:mm:ss'\n        }) : React.createElement(\n          'div',\n          { \n            className: mode === 'retrospective' ? 'tvs-timer tvs-timer-editable' : 'tvs-timer',\n            onClick: mode === 'retrospective' ? () => {\n              setEditingMainTimer(true);\n              setEditValue(formatTime(elapsedTime));\n            } : null,\n            title: mode === 'retrospective' ? 'Click to edit time' : ''\n          },\n          formatTime(elapsedTime)\n        )\n      ),\n      \n      // Metrics display (activity-specific)\n      React.createElement(\n        'div',\n        { className: 'tvs-metrics-grid' },\n        metricsConfig.display.map(renderMetric)\n      ),\n\n      // Controls (activity-specific)\n      React.createElement(\n        'div',\n        { className: 'tvs-controls' },\n        React.createElement('h4', null, selectedType === 'Workout' ? 'Add Your Exercises' : 'Adjust Metrics'),\n        mode === 'retrospective' && React.createElement(\n          'p',\n          { className: 'tvs-controls-hint' },\n          '\uD83D\uDCA1 Click on any value to edit directly'\n        ),\n        metricsConfig.controls.map(renderControl)\n      ),\n\n      // Workout Circuits (only for Workout type)\n      selectedType === 'Workout' && React.createElement(\n        'div',\n        { className: 'tvs-workout-circuits' },\n        React.createElement('h4', null, 'Strength Training'),\n        React.createElement(\n          'p',\n          { className: 'tvs-workout-hint' },\n          `Organize your workout into circuits. Each circuit can have multiple exercises and rounds.`\n        ),\n        \n        // Render all circuits\n        workoutCircuits.map((circuit) =>\n          React.createElement(WorkoutCircuit, {\n            key: circuit.id,\n            circuit: circuit,\n            isActive: circuit.id === activeCircuitId,\n            onUpdate: (updatedCircuit) => {\n              setWorkoutCircuits(\n                workoutCircuits.map(c => c.id === updatedCircuit.id ? updatedCircuit : c)\n              );\n            },\n            onRemove: (circuitId) => {\n              const remaining = workoutCircuits.filter(c => c.id !== circuitId);\n              setWorkoutCircuits(remaining);\n              // Set next circuit as active, or create new if none left\n              if (remaining.length > 0) {\n                setActiveCircuitId(remaining[0].id);\n              } else {\n                const newCircuit = { \n                  id: Date.now(), \n                  name: 'Circuit 1', \n                  sets: 1, \n                  exercises: [] \n                };\n                setWorkoutCircuits([newCircuit]);\n                setActiveCircuitId(newCircuit.id);\n              }\n            },\n            onSetActive: setActiveCircuitId,\n            canRemove: workoutCircuits.length > 1\n          })\n        ),\n        \n        // Add new circuit button\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-secondary tvs-btn-add-circuit',\n            onClick: () => {\n              const newCircuit = {\n                id: Date.now(),\n                name: `Circuit ${workoutCircuits.length + 1}`,\n                sets: 1,\n                exercises: []\n              };\n              setWorkoutCircuits([...workoutCircuits, newCircuit]);\n              setActiveCircuitId(newCircuit.id);\n            }\n          },\n          '+ Add Circuit'\n        ),\n        \n        // Overall workout summary\n        (() => {\n          const hasExercises = workoutCircuits.some(c => c.exercises.length > 0);\n          if (!hasExercises) return null;\n          \n          const totalExercises = workoutCircuits.reduce((sum, c) => sum + c.exercises.length, 0);\n          const totalReps = workoutCircuits.reduce((sum, circuit) => {\n            const circuitReps = circuit.exercises.reduce((reps, ex) => {\n              return reps + (ex.metric_type === 'reps' ? ex.reps : 0);\n            }, 0);\n            return sum + (circuitReps * circuit.sets);\n          }, 0);\n          const totalVolume = workoutCircuits.reduce((sum, circuit) => {\n            const circuitVolume = circuit.exercises.reduce((vol, ex) => {\n              return vol + (ex.reps * ex.weight);\n            }, 0);\n            return sum + (circuitVolume * circuit.sets);\n          }, 0);\n          \n          return React.createElement(\n            'div',\n            { className: 'tvs-workout-summary' },\n            React.createElement('h5', null, 'Workout Totals'),\n            React.createElement('p', null, `\uD83D\uDCCB ${workoutCircuits.length} circuits \u2022 ${totalExercises} exercises`),\n            totalReps > 0 && React.createElement('p', null, `\uD83D\uDCAA ${totalReps} total reps`),\n            totalVolume > 0 && React.createElement('p', null, `\uD83C\uDFCB\uFE0F ${totalVolume.toFixed(1)}kg total volume`)\n          );\n        })()\n      ),\n\n      // Action buttons\n      React.createElement(\n        'div',\n        { className: 'tvs-action-buttons' },\n        mode === 'live' && React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-secondary',\n            onClick: handleTogglePause,\n            disabled: isLoading,\n          },\n          isPaused ? '\u25B6\uFE0F Resume' : '\u23F8 Pause'\n        ),\n        mode === 'live' && React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-secondary',\n            onClick: handleUpdateSession,\n            disabled: isLoading,\n          },\n          '\uD83D\uDCBE Save Progress'\n        ),\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-danger',\n            onClick: handleCancelActivity,\n            disabled: isLoading,\n          },\n          '\u2715 Cancel'\n        ),\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-finish',\n            onClick: () => {\n              // Guard: Workout must have at least one exercise in any circuit\n              if (selectedType === 'Workout') {\n                const hasExercises = workoutCircuits.some(c => c.exercises.length > 0);\n                if (!hasExercises) {\n                  if (typeof window.tvsFlash === 'function') {\n                    window.tvsFlash('\u26A0\uFE0F Add at least one exercise before finishing', 'error');\n                  }\n                  return;\n                }\n              }\n              \n              if (mode === 'live') {\n                // Go to calibration step for live activities\n                stopTimer();\n                // Initialize calibration values with current state\n                setCalibDuration(elapsedTime);\n                setCalibDistance(distance);\n                setCalibIncline(incline);\n                setCalibCadence(cadence);\n                setCalibPower(power);\n                setCalibLaps(laps);\n                setStep('calibration');\n              } else {\n                // Skip calibration for retrospective (already manually entered)\n                setShowConfirmModal(true);\n              }\n            },\n            disabled: isLoading,\n          },\n          isLoading ? 'Finishing...' : '\u2713 Finish Activity'\n        )\n      ),\n\n      isPaused && React.createElement(\n        'div',\n        { className: 'tvs-paused-notice tvs-badge tvs-badge-primary' },\n        '\u23F8 Activity paused'\n      ),\n\n      // Cancel Confirmation Modal\n      showCancelModal && React.createElement(\n        'div',\n        { className: 'tvs-modal-overlay', onClick: () => setShowCancelModal(false) },\n        React.createElement(\n          'div',\n          { \n            className: 'tvs-modal tvs-card',\n            onClick: (e) => e.stopPropagation()\n          },\n          React.createElement('h3', { className: 'tvs-modal-title' }, '\u26A0\uFE0F Cancel Activity?'),\n          React.createElement(\n            'p',\n            { className: 'tvs-modal-text' },\n            'Are you sure you want to cancel this activity? All data will be lost and cannot be recovered.'\n          ),\n          React.createElement(\n            'div',\n            { className: 'tvs-modal-actions' },\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-secondary',\n                onClick: () => setShowCancelModal(false)\n              },\n              'Keep Activity'\n            ),\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-danger',\n                onClick: handleConfirmCancel\n              },\n              '\u2715 Cancel Activity'\n            )\n          )\n        )\n      ),\n\n      // Finish Confirmation Modal\n      showConfirmModal && React.createElement(\n        'div',\n        { className: 'tvs-modal-overlay', onClick: () => setShowConfirmModal(false) },\n        React.createElement(\n          'div',\n          { \n            className: 'tvs-modal tvs-card',\n            onClick: (e) => e.stopPropagation()\n          },\n          React.createElement('h3', { className: 'tvs-modal-title' }, '\uD83C\uDFC1 Finish Activity?'),\n          React.createElement(\n            'p',\n            { className: 'tvs-modal-text' },\n            `Are you sure you want to finish this ${selectedType.toLowerCase()} activity?`\n          ),\n          React.createElement(\n            'div',\n            { className: 'tvs-modal-summary' },\n            React.createElement('div', null, `\u23F1 Duration: ${formatTime(elapsedTime)}`),\n            selectedType !== 'Workout' && React.createElement('div', null, `\uD83D\uDCCD Distance: ${distance.toFixed(2)} km`),\n            selectedType === 'Swim' && React.createElement('div', null, `\uD83C\uDFCA Laps: ${laps}`),\n            selectedType === 'Swim' && pace > 0 && React.createElement('div', null, `\u26A1 Pace: ${pace} sec/lap`),\n            selectedType === 'Workout' && workoutExercises.length > 0 && React.createElement('div', null, `\uD83D\uDCAA Exercises: ${workoutExercises.length}`)\n          ),\n          React.createElement(\n            'div',\n            { className: 'tvs-modal-actions' },\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-secondary',\n                onClick: () => setShowConfirmModal(false)\n              },\n              'Go Back'\n            ),\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-finish',\n                onClick: () => {\n                  setShowConfirmModal(false);\n                  handleFinishActivity();\n                },\n                disabled: isLoading\n              },\n              '\u2713 Finish'\n            )\n          )\n        )\n      )\n    );\n  }\n\n  // Render: Calibration (for live mode before finishing)\n  if (step === 'calibration') {\n    const handleCalibrationSave = () => {\n      setCalibratedValues({\n        duration: calibDuration,\n        distance: calibDistance,\n        incline: calibIncline,\n        cadence: calibCadence,\n        power: calibPower,\n        laps: calibLaps,\n        notes: calibNotes,\n        rating: calibRating,\n      });\n      setShowConfirmModal(true);\n    };\n\n    const handleBackToTracking = () => {\n      setStep('tracking');\n      if (mode === 'live') {\n        startTimer(); // Resume timer\n      }\n    };\n\n    const renderCalibrationField = (label, value, setter, unit = '', step = 0.01, type = 'number') => {\n      return React.createElement(\n        'div',\n        { className: 'tvs-calibration-field' },\n        React.createElement('label', null, label),\n        React.createElement(\n          'div',\n          { className: 'tvs-calibration-input-group' },\n          React.createElement('input', {\n            type: type,\n            value: type === 'text' ? formatTime(value) : value,\n            onChange: (e) => {\n              if (type === 'text') {\n                const seconds = parseTimeInput(e.target.value);\n                setter(seconds);\n              } else {\n                setter(parseFloat(e.target.value) || 0);\n              }\n            },\n            step: step,\n            min: 0,\n            className: 'tvs-calibration-input',\n            placeholder: label\n          }),\n          unit && React.createElement('span', { className: 'tvs-calibration-unit' }, unit)\n        )\n      );\n    };\n\n    return React.createElement(\n      'div',\n      { className: 'tvs-manual-tracker tvs-calibration', ref: containerRef },\n      React.createElement('h3', null, '\uD83C\uDFAF Calibrate Your Results'),\n      React.createElement(\n        'p',\n        { className: 'tvs-calibration-hint' },\n        'Adjust values to match your equipment (treadmill, bike computer, watch, etc.)'\n      ),\n      React.createElement(\n        'div',\n        { className: 'tvs-calibration-grid' },\n        renderCalibrationField('Duration', calibDuration, setCalibDuration, '', 1, 'text'),\n        ['Run', 'Walk', 'Hike', 'Ride'].includes(selectedType) && renderCalibrationField('Distance', calibDistance, setCalibDistance, 'km', 0.01),\n        ['Run', 'Walk', 'Hike', 'Ride'].includes(selectedType) && renderCalibrationField('Incline', calibIncline, setCalibIncline, '%', 0.5),\n        ['Run', 'Walk', 'Hike', 'Ride'].includes(selectedType) && renderCalibrationField('Cadence', calibCadence, setCalibCadence, 'spm', 1),\n        selectedType === 'Ride' && renderCalibrationField('Power', calibPower, setCalibPower, 'W', 1),\n        selectedType === 'Swim' && renderCalibrationField('Laps', calibLaps, setCalibLaps, '', 1)\n      ),\n      React.createElement(\n        'div',\n        { className: 'tvs-calibration-notes-rating' },\n        React.createElement(\n          'div',\n          { className: 'tvs-calibration-field' },\n          React.createElement('label', null, 'Notes'),\n          React.createElement('textarea', {\n            value: calibNotes,\n            onChange: (e) => setCalibNotes(e.target.value),\n            className: 'tvs-calibration-textarea',\n            placeholder: 'How did the activity feel? Any observations?',\n            rows: 2\n          })\n        ),\n        React.createElement(\n          'div',\n          { className: 'tvs-calibration-field' },\n          React.createElement('label', null, 'Rate Your Activity (1-10)'),\n          React.createElement(\n            'div',\n            { className: 'tvs-rating-scale' },\n            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(rating => \n              React.createElement(\n                'button',\n                {\n                  key: rating,\n                  type: 'button',\n                  className: `tvs-rating-btn ${calibRating === rating ? 'tvs-rating-btn--active' : ''}`,\n                  onClick: () => setCalibRating(rating)\n                },\n                rating\n              )\n            )\n          ),\n          calibRating > 0 ? React.createElement(\n            'div',\n            { className: 'tvs-rating-label' },\n            calibRating <= 3 ? 'Challenging' : calibRating <= 6 ? 'Moderate' : calibRating <= 8 ? 'Good' : 'Excellent'\n          ) : null\n        )\n      ),\n      React.createElement(\n        'div',\n        { className: 'tvs-calibration-actions' },\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-secondary',\n            onClick: handleBackToTracking\n          },\n          '\u2190 Back to Tracking'\n        ),\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-finish',\n            onClick: handleCalibrationSave\n          },\n          '\u2713 Confirm & Finish'\n        )\n      ),\n\n      // Finish Confirmation Modal (from calibration)\n      showConfirmModal && React.createElement(\n        'div',\n        { className: 'tvs-modal-overlay', onClick: () => setShowConfirmModal(false) },\n        React.createElement(\n          'div',\n          { \n            className: 'tvs-modal tvs-card',\n            onClick: (e) => e.stopPropagation()\n          },\n          React.createElement('h3', { className: 'tvs-modal-title' }, '\uD83C\uDFC1 Finish Activity?'),\n          React.createElement(\n            'p',\n            { className: 'tvs-modal-text' },\n            `Are you sure you want to finish this ${selectedType.toLowerCase()} activity with the calibrated values?`\n          ),\n          React.createElement(\n            'div',\n            { className: 'tvs-modal-summary' },\n            React.createElement('div', null, `\u23F1 Duration: ${formatTime(calibDuration)}`),\n            selectedType !== 'Workout' && React.createElement('div', null, `\uD83D\uDCCD Distance: ${calibDistance.toFixed(2)} km`),\n            selectedType === 'Swim' && React.createElement('div', null, `\uD83C\uDFCA Laps: ${calibLaps}`),\n            selectedType === 'Swim' && calibLaps > 0 && calibDuration > 0 && React.createElement('div', null, `\u26A1 Pace: ${Math.round(calibDuration / calibLaps)} sec/lap`),\n            selectedType === 'Workout' && (() => {\n              const totalExercises = workoutCircuits.reduce((sum, c) => sum + c.exercises.length, 0);\n              return totalExercises > 0 && React.createElement('div', null, `\uD83C\uDFCB\uFE0F ${workoutCircuits.length} circuits \u2022 ${totalExercises} exercises`);\n            })()\n          ),\n          React.createElement(\n            'div',\n            { className: 'tvs-modal-actions' },\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-secondary',\n                onClick: () => setShowConfirmModal(false)\n              },\n              'Go Back'\n            ),\n            React.createElement(\n              'button',\n              {\n                className: 'tvs-btn tvs-btn-finish',\n                onClick: () => {\n                  setShowConfirmModal(false);\n                  handleFinishActivity();\n                },\n                disabled: isLoading\n              },\n              '\u2713 Finish'\n            )\n          )\n        )\n      )\n    );\n  }\n\n  // Render: Finished\n  if (step === 'finished') {\n    // Build activity-specific summary\n    const summaryItems = [\n      React.createElement('p', { key: 'type' }, `Type: ${selectedType}`),\n      React.createElement('p', { key: 'duration' }, `\u23F1 Duration: ${formatTime(elapsedTime)}`)\n    ];\n\n    // Add activity-specific metrics\n    if (selectedType === 'Workout') {\n      const totalExercises = workoutCircuits.reduce((sum, c) => sum + c.exercises.length, 0);\n      const totalReps = workoutCircuits.reduce((sum, circuit) => {\n        const circuitReps = circuit.exercises.reduce((reps, ex) => {\n          return reps + (ex.metric_type === 'reps' ? ex.reps : 0);\n        }, 0);\n        return sum + (circuitReps * circuit.sets);\n      }, 0);\n      const totalVolume = workoutCircuits.reduce((sum, circuit) => {\n        const circuitVolume = circuit.exercises.reduce((vol, ex) => {\n          return vol + (ex.reps * ex.weight);\n        }, 0);\n        return sum + (circuitVolume * circuit.sets);\n      }, 0);\n      \n      summaryItems.push(\n        React.createElement('p', { key: 'circuits' }, `\uD83C\uDFCB\uFE0F ${workoutCircuits.length} circuits \u2022 ${totalExercises} exercises`)\n      );\n      \n      if (totalReps > 0) {\n        summaryItems.push(\n          React.createElement('p', { key: 'total' }, `\uD83D\uDD01 Total reps: ${totalReps}`)\n        );\n      }\n      \n      if (totalVolume > 0) {\n        summaryItems.push(\n          React.createElement('p', { key: 'volume' }, `\uD83D\uDCCA Total volume: ${totalVolume.toFixed(1)} kg`)\n        );\n      }\n      \n      // List all circuits with exercises\n      if (totalExercises > 0) {\n        summaryItems.push(\n          React.createElement(\n            'div',\n            { key: 'circuit-list', className: 'tvs-summary-circuits' },\n            workoutCircuits.map((circuit, circuitIdx) =>\n              circuit.exercises.length > 0 && React.createElement(\n                'div',\n                { key: circuitIdx, className: 'tvs-summary-circuit' },\n                React.createElement('h4', null, `${circuit.name} (${circuit.sets} ${circuit.sets === 1 ? 'round' : 'rounds'})`),\n                circuit.exercises.map((exercise, exIdx) =>\n                  React.createElement(\n                    'div',\n                    { key: exIdx, className: 'tvs-summary-exercise' },\n                    `${exIdx + 1}. ${exercise.name} (${exercise.reps}${exercise.metric_type === 'time' ? 's' : ''}${exercise.weight > 0 ? ` @ ${exercise.weight}kg` : ''})`\n                  )\n                )\n              )\n            )\n          )\n        );\n      }\n    } else if (selectedType === 'Swim') {\n      summaryItems.push(\n        React.createElement('p', { key: 'laps' }, `\uD83C\uDFCA Laps: ${laps}`),\n        React.createElement('p', { key: 'pool' }, `\uD83D\uDCCF Pool Length: ${poolLength}m`),\n        React.createElement('p', { key: 'distance' }, `\uD83D\uDCCD Distance: ${(laps * poolLength / 1000).toFixed(2)} km`)\n      );\n      if (pace > 0) {\n        summaryItems.push(\n          React.createElement('p', { key: 'pace' }, `\u26A1 Avg Pace: ${pace} sec/lap`)\n        );\n      }\n    } else {\n      // Run, Walk, Hike, Ride\n      summaryItems.push(\n        React.createElement('p', { key: 'distance' }, `\uD83D\uDCCD Distance: ${distance.toFixed(2)} km`)\n      );\n      if (distance > 0 && elapsedTime > 0) {\n        const avgSpeed = (distance / (elapsedTime / 3600)).toFixed(1);\n        summaryItems.push(\n          React.createElement('p', { key: 'speed' }, `\u26A1 Avg Speed: ${avgSpeed} km/h`)\n        );\n      }\n      if (incline > 0) {\n        summaryItems.push(\n          React.createElement('p', { key: 'incline' }, `\u26F0\uFE0F Incline: ${incline.toFixed(1)}%`)\n        );\n      }\n    }\n\n    return React.createElement(\n      'div',\n      { className: 'tvs-manual-tracker tvs-finished', ref: containerRef },\n      React.createElement('h3', null, '\uD83C\uDF89 Activity Saved!'),\n      React.createElement(\n        'div',\n        { className: 'tvs-summary' },\n        summaryItems\n      ),\n      React.createElement(\n        'div',\n        { className: 'tvs-finished-actions' },\n        permalink && React.createElement(\n          'a',\n          { href: permalink, className: 'tvs-btn tvs-btn-primary' },\n          'View Activity'\n        ),\n        activityId && React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-strava',\n            onClick: uploadToStrava,\n            disabled: uploadingToStrava\n          },\n          uploadingToStrava ? 'Uploading...' : React.createElement(\n            React.Fragment,\n            null,\n            React.createElement(\n              'svg',\n              {\n                width: '18',\n                height: '18',\n                viewBox: '0 0 24 24',\n                fill: 'currentColor',\n                style: { marginRight: '8px', verticalAlign: 'middle' }\n              },\n              React.createElement('path', {\n                d: 'M15.387 17.944l-2.089-4.116h-3.065L15.387 24l5.15-10.172h-3.066m-7.008-5.599l2.836 5.598h4.172L10.463 0l-7 13.828h4.169'\n              })\n            ),\n            'Upload to Strava'\n          )\n        ),\n        React.createElement(\n          'button',\n          {\n            className: 'tvs-btn tvs-btn-secondary',\n            onClick: () => {\n              setStep('select');\n              setSessionId(null);\n              setElapsedTime(0);\n              setDistance(0);\n              setSpeed(0);\n              setPace(0);\n              setIncline(0);\n              setCadence(0);\n              setPower(0);\n              setLaps(0);\n              setSets(0);\n              setReps(0);\n            },\n          },\n          'Start Another Activity'\n        )\n      )\n    );\n  }\n\n  return null;\n}\n\n// Helper: Get activity icon emoji\nfunction getActivityIcon(type) {\n  const icons = {\n    Run: '\uD83C\uDFC3',\n    Ride: '\uD83D\uDEB4',\n    Walk: '\uD83D\uDEB6',\n    Hike: '\uD83E\uDD7E',\n    Swim: '\uD83C\uDFCA',\n    Workout: '\uD83D\uDCAA',\n  };\n  return icons[type] || '\uD83C\uDFC3';\n}\n", "import { mountReact, React } from '../../utils/reactMount.js';\nimport { DEBUG, log } from '../../utils/debug.js';\nimport ManualActivityTracker from '../../components/ManualActivityTracker.js';\n\nfunction mountAll() {\n  const nodes = document.querySelectorAll('.tvs-manual-activity-tracker');\n  nodes.forEach((node, idx) => {\n    if (!node.__tvsMounted) {\n      const id = node.id || `tvs-manual-tracker-${idx}`;\n      if (!node.id) node.id = id;\n      if (DEBUG) log('Mounting ManualActivityTracker block (view.js) on:', id);\n\n      // Read server-provided attributes from data-*\n      const title = node.getAttribute('data-title') || 'Start Activity';\n      const showTypeSelector = node.getAttribute('data-show-type-selector') === '1';\n      const allowedTypesRaw = node.getAttribute('data-allowed-types') || '[]';\n      const allowedTypes = JSON.parse(allowedTypesRaw);\n      const autoStart = node.getAttribute('data-auto-start') === '1';\n      const defaultType = node.getAttribute('data-default-type') || 'Run';\n\n      mountReact(\n        ManualActivityTracker,\n        {\n          React,\n          title,\n          showTypeSelector,\n          allowedTypes,\n          autoStart,\n          defaultType,\n        },\n        node\n      );\n      node.__tvsMounted = true;\n    }\n  });\n}\n\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', mountAll);\n} else {\n  mountAll();\n}\n"],
  "mappings": "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",
  "names": ["DEBUG", "log", "args", "err", "hasWindowReact", "hasWpElement", "wpEl", "React", "ReactDOM", "tvsRoots", "hasCreateRoot", "mountReact", "Component", "props", "node", "existingRoot", "root", "legacyRender", "err", "e", "useState", "useEffect", "useRef", "React", "useDebounce", "value", "delay", "debouncedValue", "setDebouncedValue", "handler", "ExerciseSearchDropdown", "onChange", "onSelect", "placeholder", "className", "results", "setResults", "isSearching", "setIsSearching", "showDropdown", "setShowDropdown", "selectedIndex", "setSelectedIndex", "error", "setError", "dropdownPosition", "setDropdownPosition", "inputRef", "dropdownRef", "debouncedSearchTerm", "rect", "updatePosition", "url", "response", "data", "err", "handleClickOutside", "event", "handleKeyDown", "e", "prev", "handleSelect", "exercise", "getDifficultyColor", "difficulty", "renderDropdown", "ReactDOM", "idx", "ExerciseSearchDropdown_default", "useState", "React", "WorkoutCircuit", "circuit", "isActive", "onUpdate", "onRemove", "onSetActive", "canRemove", "currentExerciseName", "setCurrentExerciseName", "currentExerciseId", "setCurrentExerciseId", "currentReps", "setCurrentReps", "currentWeight", "setCurrentWeight", "currentMetricType", "setCurrentMetricType", "isEditingName", "setIsEditingName", "editName", "setEditName", "handleAddExercise", "newExercise", "handleRemoveExercise", "index", "_", "i", "handleUpdateSets", "sets", "handleSaveName", "totals", "totalRepsPerRound", "sum", "ex", "totalVolumePerRound", "e", "exercise", "idx", "ExerciseSearchDropdown_default", "value", "WorkoutCircuit_default", "useState", "useEffect", "useRef", "apiFetch", "url", "options", "fullUrl", "response", "errorData", "ManualActivityTracker", "React", "title", "showTypeSelector", "allowedTypes", "autoStart", "defaultType", "step", "setStep", "mode", "setMode", "selectedType", "setSelectedType", "calibratedValues", "setCalibratedValues", "sessionId", "setSessionId", "sessionData", "setSessionData", "isPaused", "setIsPaused", "isLoading", "setIsLoading", "error", "setError", "activityId", "setActivityId", "permalink", "setPermalink", "uploadingToStrava", "setUploadingToStrava", "showConfirmModal", "setShowConfirmModal", "showCancelModal", "setShowCancelModal", "editingField", "setEditingField", "editValue", "setEditValue", "editingMainTimer", "setEditingMainTimer", "elapsedTime", "setElapsedTime", "distance", "setDistance", "speed", "setSpeed", "pace", "setPace", "incline", "setIncline", "cadence", "setCadence", "power", "setPower", "laps", "setLaps", "poolLength", "setPoolLength", "workoutCircuits", "setWorkoutCircuits", "activeCircuitId", "setActiveCircuitId", "workoutExercises", "setWorkoutExercises", "currentExerciseName", "setCurrentExerciseName", "currentExerciseId", "setCurrentExerciseId", "currentSets", "setCurrentSets", "currentReps", "setCurrentReps", "currentWeight", "setCurrentWeight", "currentMetricType", "setCurrentMetricType", "calibDuration", "setCalibDuration", "calibDistance", "setCalibDistance", "calibIncline", "setCalibIncline", "calibCadence", "setCalibCadence", "calibPower", "setCalibPower", "calibLaps", "setCalibLaps", "calibNotes", "setCalibNotes", "calibRating", "setCalibRating", "timerRef", "autoSaveRef", "startTimeRef", "containerRef", "wakeLockRef", "distanceKm", "paceValue", "handleStartActivity", "saved", "data", "startTimer", "e", "DEBUG", "log", "elapsed", "stopTimer", "handleUpdateSession", "requestWakeLock", "err", "releaseWakeLock", "type", "result", "showMessage", "payload", "circuit", "ex", "handleFinishActivity", "resolve", "uploadToStrava", "handleCancelActivity", "handleConfirmCancel", "handleTogglePause", "formatTime", "seconds", "h", "m", "s", "formatTimePace", "totalMinutes", "parseTimeInput", "input", "parts", "p", "handleInlineEdit", "field", "value", "metricsConfig", "config", "renderMetric", "metric", "renderControl", "control", "isEditing", "canEdit", "getActivityIcon", "WorkoutCircuit_default", "updatedCircuit", "c", "circuitId", "remaining", "newCircuit", "totalExercises", "sum", "totalReps", "circuitReps", "reps", "totalVolume", "circuitVolume", "vol", "handleCalibrationSave", "handleBackToTracking", "renderCalibrationField", "label", "setter", "unit", "rating", "summaryItems", "circuitIdx", "exercise", "exIdx", "avgSpeed", "mountAll", "node", "idx", "id", "DEBUG", "log", "title", "showTypeSelector", "allowedTypesRaw", "allowedTypes", "autoStart", "defaultType", "mountReact", "ManualActivityTracker", "React"]
}
