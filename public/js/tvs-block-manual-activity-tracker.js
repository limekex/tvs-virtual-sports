(()=>{var se=new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1";function pe(...e){se&&console.debug("[TVS]",...e)}function Ae(...e){console.error("[TVS]",...e)}var rt=!!(window.React&&window.ReactDOM),xt=!!(window.wp&&window.wp.element),G=xt?window.wp.element:{},m=rt?window.React:G||{},_=rt?window.ReactDOM:G||null,Pe=new WeakMap,Ft=_&&typeof _.createRoot=="function"||G&&typeof G.createRoot=="function";function ot(e,r,h){try{let u=Pe.get(h);if(u&&typeof u.unmount=="function"?(u.unmount(),Pe.delete(h)):_&&typeof _.unmountComponentAtNode=="function"&&_.unmountComponentAtNode(h),Ft){let p=(_&&_.createRoot||G&&G.createRoot)(h);Pe.set(h,p),p.render(m.createElement(e,r));return}let S=_&&_.render||G&&G.render;if(S){S(m.createElement(e,r),h);return}Ae("Ingen render-funksjon tilgjengelig.")}catch(u){Ae("Mount feilet:",u)}}var{useState:ne,useEffect:_e,useRef:ct}=m;function Tt(e,r){let[h,u]=ne(e);return _e(()=>{let S=setTimeout(()=>{u(e)},r);return()=>{clearTimeout(S)}},[e,r]),h}function $t({value:e,onChange:r,onSelect:h,placeholder:u="Search exercises...",className:S=""}){let[w,p]=ne([]),[C,o]=ne(!1),[M,n]=ne(!1),[A,v]=ne(-1),[fe,N]=ne(""),L=ct(null),ae=ct(null),W=Tt(e,300);_e(()=>{(async()=>{if(W.length<2){p([]),n(!1),N("");return}o(!0),N("");try{let E=`${window.TVS_SETTINGS.restRoot}tvs/v1/exercises/search?q=${encodeURIComponent(W)}&limit=10`,V=await fetch(E,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS.nonce}});if(!V.ok)throw new Error(`Search failed: ${V.status}`);let le=await V.json();p(le.results||[]),n(!0),v(-1)}catch(E){console.error("Exercise search error:",E),N("Search failed. Try again."),p([]),n(!1)}finally{o(!1)}})()},[W]),_e(()=>{let i=E=>{ae.current&&!ae.current.contains(E.target)&&L.current&&!L.current.contains(E.target)&&n(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[]);let H=i=>{if(!(!M||w.length===0))switch(i.key){case"ArrowDown":i.preventDefault(),v(E=>E<w.length-1?E+1:E);break;case"ArrowUp":i.preventDefault(),v(E=>E>0?E-1:-1);break;case"Enter":i.preventDefault(),A>=0&&A<w.length&&Y(w[A]);break;case"Escape":i.preventDefault(),n(!1),v(-1);break;default:break}},Y=i=>{console.log("Exercise selected:",i),h({id:i.id,name:i.name,default_metric:i.default_metric||"reps"}),p([]),n(!1),v(-1)},x=i=>{switch(i){case"beginner":return"#10b981";case"intermediate":return"#f59e0b";case"advanced":return"#ef4444";default:return"#6b7280"}};return m.createElement("div",{className:`tvs-exercise-search-container ${S}`},m.createElement("input",{ref:L,type:"text",placeholder:u,value:e,onChange:i=>r(i.target.value),onKeyDown:H,onFocus:()=>{w.length>0&&n(!0)},className:"tvs-exercise-input tvs-input-name",autoComplete:"off"}),C&&m.createElement("div",{className:"tvs-search-spinner"},"\u{1F50D}"),fe&&m.createElement("div",{className:"tvs-search-error"},fe),M&&w.length>0&&m.createElement("div",{ref:ae,className:"tvs-exercise-dropdown"},w.map((i,E)=>m.createElement("div",{key:i.id,className:`tvs-exercise-result ${E===A?"tvs-exercise-result-selected":""}`,onClick:()=>Y(i),onMouseEnter:()=>v(E)},m.createElement("div",null,m.createElement("div",null,m.createElement("div",null,i.name),m.createElement("div",null,i.category&&m.createElement("span",{className:"tvs-badge tvs-badge-category"},i.category),i.difficulty&&m.createElement("span",{className:"tvs-badge tvs-badge-difficulty",style:{background:x(i.difficulty)}},i.difficulty),i.default_metric&&m.createElement("span",{className:"tvs-badge-metric"},i.default_metric==="reps"?"\u{1F522} Reps":"\u23F1 Time")))))),w.length===0&&!C&&W.length>=2&&m.createElement("div",{style:{padding:"12px 16px",color:"var(--tvs-text-secondary)",fontSize:"14px"}},"No exercises found")),M&&w.length===0&&W.length<2&&m.createElement("div",{ref:ae,className:"tvs-exercise-dropdown-hint",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",padding:"8px 12px",background:"var(--tvs-bg-secondary)",border:"1px solid var(--tvs-border)",borderRadius:"var(--tvs-radius)",fontSize:"12px",color:"var(--tvs-text-secondary)",zIndex:1e3}},"Type at least 2 characters to search"))}var dt=$t;var{useState:a,useEffect:B,useRef:Ne}=window.React;async function Le(e,r={}){let h=e.startsWith("/wp-json")?e:`/wp-json${e}`,u=await fetch(h,{...r,headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||"",...r.headers},credentials:"include"});if(!u.ok){let S=await u.json().catch(()=>({}));throw new Error(S.message||`HTTP ${u.status}: ${u.statusText}`)}return u.json()}function We({React:e,title:r,showTypeSelector:h,allowedTypes:u,autoStart:S,defaultType:w}){let[p,C]=a("select"),[o,M]=a("live"),[n,A]=a(w),[v,fe]=a(null),[N,L]=a(null),[ae,W]=a(null),[H,Y]=a(!1),[x,i]=a(!1),[E,V]=a(null),[le,ut]=a(null),[Ve,vt]=a(null),[je,Ue]=a(!1),[Oe,j]=a(!1),[pt,he]=a(!1),[ft,Se]=a(null),[Q,K]=a(""),[ht,Ee]=a(!1),[c,D]=a(0),[g,T]=a(0),[y,Z]=a(0),[$,ie]=a(0),[F,J]=a(0),[P,z]=a(0),[U,q]=a(0),[k,R]=a(0),[I,Ce]=a(25),[b,xe]=a([]),[be,ge]=a(""),[Ge,Fe]=a(null),[Be,Te]=a(3),[He,re]=a(10),[Ke,$e]=a(0),[oe,ce]=a("reps"),[de,Je]=a(0),[De,ze]=a(0),[qe,Xe]=a(0),[Ye,Qe]=a(0),[Ze,Re]=a(0),[me,et]=a(0),ue=Ne(null),ee=Ne(null),ve=Ne(null),te=Ne(null);B(()=>{te.current&&te.current.scrollIntoView({behavior:"smooth",block:"start"})},[p]),B(()=>{if(n==="Swim"&&k>0&&I>0){let t=parseFloat((k*I/1e3).toFixed(2));if(T(t),c>0&&k>0){let s=Math.round(c/k);ie(s)}}},[k,I,c,n]),B(()=>{S&&!h&&o==="live"&&tt(w)},[]),B(()=>{let t=localStorage.getItem("tvs_manual_session");if(t)try{let s=JSON.parse(t);s.sessionId&&s.type&&(confirm("You have an unfinished activity. Do you want to continue?")?(L(s.sessionId),A(s.type),M(s.mode||"live"),D(s.elapsed_time||0),T(s.distance||0),Z(s.speed||0),ie(s.pace||0),J(s.incline||0),z(s.cadence||0),q(s.power||0),C("tracking"),o==="live"&&(ve.current=Date.now()-(s.elapsed_time||0)*1e3,we())):localStorage.removeItem("tvs_manual_session"))}catch(s){se&&pe("Failed to parse saved session:",s),localStorage.removeItem("tvs_manual_session")}},[]);let we=()=>{ue.current||o==="retrospective"||(ue.current=setInterval(()=>{if(ve.current){let t=Math.floor((Date.now()-ve.current)/1e3);if(D(t),o==="live"&&y>0){let s=y*t/3600;T(parseFloat(s.toFixed(2)))}}},1e3))},ye=()=>{ue.current&&(clearInterval(ue.current),ue.current=null)};B(()=>(p==="tracking"&&N&&!H&&(ee.current=setInterval(()=>{Ie(!1)},3e4)),()=>{ee.current&&(clearInterval(ee.current),ee.current=null)}),[p,N,H,c,g,y,$,F,P,U]),B(()=>{p==="tracking"&&N&&localStorage.setItem("tvs_manual_session",JSON.stringify({sessionId:N,type:n,mode:o,elapsed_time:c,distance:g,speed:y,pace:$,incline:F,cadence:P,power:U}))},[p,N,c,g,y,$,F,P,U]),B(()=>()=>{ye(),ee.current&&clearInterval(ee.current)},[]);let tt=async t=>{i(!0),V(null);try{let s=await Le("/tvs/v1/activities/manual/start",{method:"POST",body:JSON.stringify({type:t})});if(s.success&&s.session_id)L(s.session_id),W(s.session_data),A(t),C("tracking"),o==="live"&&(ve.current=Date.now(),we()),typeof window.tvsFlash=="function"&&window.tvsFlash(`${t} activity started!`,"success");else throw new Error(data.message||"Failed to start activity")}catch(s){V(s.message),typeof window.tvsFlash=="function"&&window.tvsFlash(s.message,"error")}finally{i(!1)}},Ie=async(t=!0)=>{if(N)try{let s={elapsed_time:c,distance:g,speed:y,pace:$,incline:F,cadence:P,power:U};n==="Workout"&&(s.exercises=b),n==="Swim"&&(s.laps=k,s.pool_length=I);let l=await Le(`/tvs/v1/activities/manual/${N}`,{method:"PATCH",body:JSON.stringify(s)});l.success&&(W(l.session_data),t&&typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F4BE} Progress saved","success"))}catch(s){se&&pe("Failed to update session:",s)}},st=async()=>{if(N){v&&(v.duration!==void 0&&D(v.duration),v.distance!==void 0&&T(v.distance),v.incline!==void 0&&J(v.incline),v.cadence!==void 0&&z(v.cadence),v.power!==void 0&&q(v.power),v.laps!==void 0&&R(v.laps),await new Promise(t=>setTimeout(t,10))),await Ie(!1),i(!0),V(null);try{let t=await Le(`/tvs/v1/activities/manual/${N}/finish`,{method:"POST"});if(t.success&&t.activity_id)ut(t.activity_id),vt(t.permalink),C("finished"),ye(),localStorage.removeItem("tvs_manual_session"),window.dispatchEvent(new CustomEvent("tvs:activity-updated")),typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F389} Activity saved successfully!","success");else throw new Error(data.message||"Failed to finish activity")}catch(t){V(t.message),typeof window.tvsFlash=="function"&&window.tvsFlash(t.message,"error")}finally{i(!1)}}},Et=async()=>{if(le)try{Ue(!0);let t=await fetch(`/wp-json/tvs/v1/activities/${le}/strava`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||""},credentials:"same-origin"}),s=await t.json();if(!t.ok)throw new Error(s.message||"Upload failed");typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F44D} Uploaded to Strava!","success"),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(t){console.error("Strava upload failed:",t),typeof window.tvsFlash=="function"&&window.tvsFlash("Failed to upload to Strava: "+(t?.message||String(t)),"error")}finally{Ue(!1)}},bt=()=>{he(!0)},gt=()=>{localStorage.removeItem("tvsManualActivitySession"),A(""),D(0),T(0),Z(0),J(0),z(0),q(0),R(0),Ce(25),xe([]),ge(""),Te(3),re(10),$e(0),ce("reps"),Y(!1),L(null),C("select"),he(!1),typeof window.tvsFlash=="function"&&window.tvsFlash("Activity cancelled","info")},wt=()=>{H?(ve.current=Date.now()-c*1e3,Y(!1),we(),typeof window.tvsFlash=="function"&&window.tvsFlash("\u25B6\uFE0F Activity resumed","success")):(ye(),Y(!0),typeof window.tvsFlash=="function"&&window.tvsFlash("\u23F8 Activity paused","info"))},O=t=>{let s=Math.floor(t/3600),l=Math.floor(t%3600/60),d=t%60;return`${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`},yt=t=>{let s=Math.floor(t/60),l=t%60;return`${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},nt=t=>{if(!t)return 0;let s=t.split(":").map(l=>parseInt(l,10)||0);return s.length===3?s[0]*3600+s[1]*60+s[2]:s.length===2?s[0]*60+s[1]:s[0]},ke=(t,s)=>{switch(t){case"duration":let l=nt(s);D(Math.max(0,l));break;case"distance":T(Math.max(0,parseFloat(s)||0));break;case"speed":Z(Math.max(0,parseFloat(s)||0));break;case"incline":J(Math.max(-5,Math.min(15,parseFloat(s)||0)));break;case"cadence":z(Math.max(0,parseInt(s,10)||0));break;case"power":q(Math.max(0,parseInt(s,10)||0));break;case"laps":R(Math.max(0,parseInt(s,10)||0));break}Se(null),K("")};B(()=>{y>0?ie(parseFloat((60/y).toFixed(2))):ie(0)},[y]);let at=(()=>{let s={Run:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Walk:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Hike:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Ride:{display:["distance","speed","incline","cadence"],controls:["speed","incline","cadence","power"]},Swim:{display:["laps","poolLength","distance","pace"],controls:["laps","poolLength"]},Workout:{display:[],controls:[]}}[n]||{display:["distance","speed","pace"],controls:["speed"]};return o==="retrospective"&&(["Run","Walk","Hike","Ride"].includes(n)?(s.controls=["distance","duration","incline","cadence"],n==="Ride"&&s.controls.push("power")):n==="Swim"?s.controls=["laps","poolLength","duration"]:n==="Workout"&&(s.controls=["duration"])),s})(),kt=t=>{let l={distance:{label:"Distance (km)",value:g.toFixed(2)},speed:{label:"Speed (km/h)",value:y.toFixed(1)},pace:{label:n==="Swim"?"Pace (sec/lap)":"Pace (min/km)",value:$>0?n==="Swim"?$:yt($):"\u2014"},incline:{label:"Incline (%)",value:F.toFixed(1)},cadence:{label:n==="Run"?"Cadence (SPM)":"Cadence (RPM)",value:P},laps:{label:"Laps",value:k},poolLength:{label:"Pool Length (m)",value:I}}[t];return l?e.createElement("div",{className:"tvs-metric",key:t},e.createElement("label",null,l.label),e.createElement("div",{className:"tvs-metric-value"},l.value)):null},Nt=t=>{let l={distance:{label:"Distance (km)",value:g.toFixed(2),onDecrease:()=>T(Math.max(0,parseFloat((g-.1).toFixed(2)))),onIncrease:()=>T(parseFloat((g+.1).toFixed(2)))},duration:{label:"Duration (h:mm:ss)",value:O(c),onDecrease:()=>D(Math.max(0,c-60)),onIncrease:()=>D(c+60)},speed:{label:"Speed (km/h)",value:y.toFixed(1),onDecrease:()=>Z(Math.max(0,y-.5)),onIncrease:()=>Z(y+.5)},incline:{label:"Incline (%)",value:F.toFixed(1)+"%",onDecrease:()=>J(Math.max(-5,parseFloat((F-.5).toFixed(1)))),onIncrease:()=>J(Math.min(15,parseFloat((F+.5).toFixed(1))))},cadence:{label:n==="Run"?"Cadence (SPM)":"Cadence (RPM)",value:P,onDecrease:()=>z(Math.max(0,P-5)),onIncrease:()=>z(P+5)},power:{label:"Power (W)",value:U,onDecrease:()=>q(Math.max(0,U-10)),onIncrease:()=>q(U+10)},laps:{label:"Laps",value:k,onDecrease:()=>R(Math.max(0,k-1)),onIncrease:()=>R(k+1)},poolLength:{label:"Pool Length (m)",value:I,onDecrease:()=>Ce(25),onIncrease:()=>Ce(50)}}[t];if(!l)return null;let d=ft===t,f=o==="retrospective";return e.createElement("div",{className:"tvs-control-row",key:t},e.createElement("label",null,l.label),e.createElement("div",{className:"tvs-control-buttons"},(t==="duration"||t==="distance")&&f&&e.createElement("button",{onClick:t==="duration"?()=>D(Math.max(0,c-1)):()=>T(Math.max(0,parseFloat((g-.01).toFixed(2)))),className:"tvs-btn-small"},t==="duration"?"\u22121s":"\u22120.01"),e.createElement("button",{onClick:l.onDecrease},"\u2212"),d?e.createElement("input",{type:"text",className:"tvs-inline-edit",value:Q,onChange:X=>K(X.target.value),onBlur:()=>ke(t,Q),onKeyDown:X=>{X.key==="Enter"&&ke(t,Q),X.key==="Escape"&&(Se(null),K(""))},autoFocus:!0,placeholder:t==="duration"?"h:mm:ss":l.value}):e.createElement("span",{onClick:f?()=>{Se(t),K(t==="duration"?O(c):t==="distance"?g.toFixed(2):t==="speed"?y.toFixed(1):t==="incline"?F.toFixed(1):String(l.value))}:null,className:f?"tvs-editable":"",title:f?"Click to edit":""},l.value),e.createElement("button",{onClick:l.onIncrease},"+"),(t==="duration"||t==="distance")&&f&&e.createElement("button",{onClick:t==="duration"?()=>D(c+1):()=>T(parseFloat((g+.01).toFixed(2))),className:"tvs-btn-small"},t==="duration"?"+1s":"+0.01")))};if(p==="select")return e.createElement("div",{className:"tvs-manual-tracker tvs-card",ref:te},e.createElement("h3",{className:"tvs-tracker-title"},r),e.createElement("div",{className:"tvs-mode-selector"},e.createElement("button",{className:`tvs-mode-btn ${o==="live"?"active":""}`,onClick:()=>M("live")},"\u23F1\uFE0F Track Live",e.createElement("span",{className:"tvs-mode-desc"},"Real-time tracking")),e.createElement("button",{className:`tvs-mode-btn ${o==="retrospective"?"active":""}`,onClick:()=>M("retrospective")},"\u{1F4DD} Log Past Activity",e.createElement("span",{className:"tvs-mode-desc"},"Enter completed activity"))),h&&e.createElement("div",{className:"tvs-type-selector"},u.map(t=>e.createElement("button",{key:t,className:`tvs-type-btn ${n===t?"active":""}`,onClick:()=>A(t),disabled:x},Dt(t),e.createElement("span",null,t)))),e.createElement("button",{className:"tvs-btn tvs-btn-primary",onClick:()=>tt(n),disabled:x},x?"Starting...":`Start ${n}`));if(p==="tracking")return e.createElement("div",{className:"tvs-manual-tracker tvs-dashboard tvs-card",ref:te},e.createElement("div",{className:"tvs-dashboard-header"},e.createElement("div",null,e.createElement("h3",{className:"tvs-tracker-title"},`${n} Activity`),e.createElement("span",{className:"tvs-badge tvs-badge-accent",style:{fontSize:"var(--tvs-text-xs)",marginTop:"var(--tvs-space-1)"}},o==="retrospective"?"\u{1F4DD} Retrospective":"\u23F1\uFE0F Live")),ht?e.createElement("input",{type:"text",className:"tvs-timer-edit",value:Q,onChange:t=>K(t.target.value),onBlur:()=>{ke("duration",Q),Ee(!1)},onKeyDown:t=>{t.key==="Enter"&&(ke("duration",Q),Ee(!1)),t.key==="Escape"&&(Ee(!1),K(""))},autoFocus:!0,placeholder:"h:mm:ss"}):e.createElement("div",{className:o==="retrospective"?"tvs-timer tvs-timer-editable":"tvs-timer",onClick:o==="retrospective"?()=>{Ee(!0),K(O(c))}:null,title:o==="retrospective"?"Click to edit time":""},O(c))),e.createElement("div",{className:"tvs-metrics-grid"},at.display.map(kt)),e.createElement("div",{className:"tvs-controls"},e.createElement("h4",null,"Adjust Metrics"),o==="retrospective"&&e.createElement("p",{className:"tvs-controls-hint"},"\u{1F4A1} Click on any value to edit directly"),at.controls.map(Nt)),n==="Workout"&&e.createElement("div",{className:"tvs-workout-exercises"},e.createElement("h4",null,"Strength Training"),e.createElement("p",{className:"tvs-workout-hint"},"Add each exercise with its sets, reps, and weight. Track different loads per exercise."),b.length>0&&e.createElement("div",{className:"tvs-exercise-list"},b.map((t,s)=>e.createElement("div",{key:s,className:"tvs-exercise-item"},e.createElement("span",{className:"tvs-exercise-number"},`${s+1}.`),e.createElement("span",{className:"tvs-exercise-name"},t.name),e.createElement("span",{className:"tvs-exercise-stats"},`${t.sets} \xD7 ${t.reps}${t.metric_type==="time"?"s":""}${t.weight>0?` @ ${t.weight}kg`:""}`),e.createElement("button",{className:"tvs-btn-icon",onClick:()=>{xe(b.filter((l,d)=>d!==s))},title:"Remove exercise"},"\u2715")))),e.createElement("div",{className:"tvs-add-exercise"},e.createElement("div",{className:"tvs-exercise-form-header"},e.createElement("label",{className:"tvs-form-label tvs-form-label-name"},"Exercise Name"),e.createElement("label",{className:"tvs-form-label tvs-form-label-sets"},"Sets"),e.createElement("div",{className:"tvs-form-label tvs-form-label-reps tvs-metric-type-toggle"},e.createElement("button",{type:"button",className:oe==="reps"?"tvs-toggle-btn tvs-toggle-active":"tvs-toggle-btn",onClick:()=>ce("reps"),title:"Repetitions"},"\u{1F522}"),e.createElement("button",{type:"button",className:oe==="time"?"tvs-toggle-btn tvs-toggle-active":"tvs-toggle-btn",onClick:()=>ce("time"),title:"Time (seconds)"},"\u23F1")),e.createElement("label",{className:"tvs-form-label tvs-form-label-weight"},"Weight (kg)")),e.createElement("div",{className:"tvs-exercise-form-inputs"},e.createElement(dt,{value:be,onChange:t=>{ge(t),Ge&&Fe(null)},onSelect:t=>{console.log("ManualActivityTracker: Exercise selected",t),ge(t.name),Fe(t.id),ce(t.default_metric||"reps"),t.default_metric==="time"?re(60):re(10)},placeholder:"Search or type exercise name...",className:"tvs-exercise-search"}),e.createElement("input",{type:"number",placeholder:"3",value:Be,min:"1",onChange:t=>Te(Math.max(1,parseInt(t.target.value)||1)),className:"tvs-exercise-number tvs-input-sets"}),e.createElement("input",{type:"number",placeholder:oe==="reps"?"10":"60",value:He,min:"1",onChange:t=>re(Math.max(1,parseInt(t.target.value)||1)),className:"tvs-exercise-number tvs-input-reps",title:oe==="reps"?"Repetitions":"Seconds"}),e.createElement("input",{type:"number",placeholder:"0",value:Ke,min:"0",step:"0.5",onChange:t=>$e(Math.max(0,parseFloat(t.target.value)||0)),className:"tvs-exercise-number tvs-input-weight"}),e.createElement("button",{className:"tvs-btn tvs-btn-secondary tvs-btn-add-exercise",onClick:()=>{be.trim()&&(xe([...b,{name:be.trim(),exercise_id:Ge,sets:Be,reps:He,weight:Ke,metric_type:oe}]),ge(""),Fe(null),Te(3),re(10),$e(0),ce("reps"))},disabled:!be.trim()},"+ Add"))),b.length>0&&e.createElement("div",{className:"tvs-circuit-summary"},e.createElement("p",null,`\u{1F4CB} ${b.length} exercises`),e.createElement("p",null,`\u{1F4AA} ${b.reduce((t,s)=>t+s.sets*s.reps,0)} total reps`),(()=>{let t=b.reduce((s,l)=>s+l.sets*l.reps*l.weight,0);return t>0&&e.createElement("p",null,`\u{1F3CB}\uFE0F Total volume: ${t.toFixed(1)} kg`)})())),e.createElement("div",{className:"tvs-action-buttons"},o==="live"&&e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:wt,disabled:x},H?"\u25B6\uFE0F Resume":"\u23F8 Pause"),o==="live"&&e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:Ie,disabled:x},"\u{1F4BE} Save Progress"),e.createElement("button",{className:"tvs-btn tvs-btn-danger",onClick:bt,disabled:x},"\u2715 Cancel"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{if(n==="Workout"&&b.length===0){typeof window.tvsFlash=="function"&&window.tvsFlash("\u26A0\uFE0F Add at least one exercise before finishing","error");return}o==="live"?(ye(),Je(c),ze(g),Xe(F),Qe(P),Re(U),et(k),C("calibration")):j(!0)},disabled:x},x?"Finishing...":"\u2713 Finish Activity")),H&&e.createElement("div",{className:"tvs-paused-notice tvs-badge tvs-badge-primary"},"\u23F8 Activity paused"),pt&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>he(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u26A0\uFE0F Cancel Activity?"),e.createElement("p",{className:"tvs-modal-text"},"Are you sure you want to cancel this activity? All data will be lost and cannot be recovered."),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>he(!1)},"Keep Activity"),e.createElement("button",{className:"tvs-btn tvs-btn-danger",onClick:gt},"\u2715 Cancel Activity")))),Oe&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>j(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u{1F3C1} Finish Activity?"),e.createElement("p",{className:"tvs-modal-text"},`Are you sure you want to finish this ${n.toLowerCase()} activity?`),e.createElement("div",{className:"tvs-modal-summary"},e.createElement("div",null,`\u23F1 Duration: ${O(c)}`),n!=="Workout"&&e.createElement("div",null,`\u{1F4CD} Distance: ${g.toFixed(2)} km`),n==="Swim"&&e.createElement("div",null,`\u{1F3CA} Laps: ${k}`),n==="Swim"&&$>0&&e.createElement("div",null,`\u26A1 Pace: ${$} sec/lap`),n==="Workout"&&e.createElement("div",null,`\u{1F4AA} Sets: ${sets} \xD7 ${reps} reps`)),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>j(!1)},"Go Back"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{j(!1),st()},disabled:x},"\u2713 Finish")))));if(p==="calibration"){let t=()=>{fe({duration:de,distance:De,incline:qe,cadence:Ye,power:Ze,laps:me}),j(!0)},s=()=>{C("tracking"),o==="live"&&we()},l=(d,f,X,lt="",St=.01,Me="number")=>e.createElement("div",{className:"tvs-calibration-field"},e.createElement("label",null,d),e.createElement("div",{className:"tvs-calibration-input-group"},e.createElement("input",{type:Me,value:Me==="text"?O(f):f,onChange:it=>{if(Me==="text"){let Ct=nt(it.target.value);X(Ct)}else X(parseFloat(it.target.value)||0)},step:St,min:0,className:"tvs-calibration-input",placeholder:d}),lt&&e.createElement("span",{className:"tvs-calibration-unit"},lt)));return e.createElement("div",{className:"tvs-manual-tracker tvs-calibration",ref:te},e.createElement("h3",null,"\u{1F3AF} Calibrate Your Results"),e.createElement("p",{className:"tvs-calibration-hint"},"Adjust values to match your equipment (treadmill, bike computer, watch, etc.)"),e.createElement("div",{className:"tvs-calibration-grid"},l("Duration",de,Je,"",1,"text"),["Run","Walk","Hike","Ride"].includes(n)&&l("Distance",De,ze,"km",.01),["Run","Walk","Hike","Ride"].includes(n)&&l("Incline",qe,Xe,"%",.5),["Run","Walk","Hike","Ride"].includes(n)&&l("Cadence",Ye,Qe,"spm",1),n==="Ride"&&l("Power",Ze,Re,"W",1),n==="Swim"&&l("Laps",me,et,"",1)),e.createElement("div",{className:"tvs-calibration-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:s},"\u2190 Back to Tracking"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:t},"\u2713 Confirm & Finish")),Oe&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>j(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:d=>d.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u{1F3C1} Finish Activity?"),e.createElement("p",{className:"tvs-modal-text"},`Are you sure you want to finish this ${n.toLowerCase()} activity with the calibrated values?`),e.createElement("div",{className:"tvs-modal-summary"},e.createElement("div",null,`\u23F1 Duration: ${O(de)}`),n!=="Workout"&&e.createElement("div",null,`\u{1F4CD} Distance: ${De.toFixed(2)} km`),n==="Swim"&&e.createElement("div",null,`\u{1F3CA} Laps: ${me}`),n==="Swim"&&me>0&&de>0&&e.createElement("div",null,`\u26A1 Pace: ${Math.round(de/me)} sec/lap`),n==="Workout"&&b.length>0&&e.createElement("div",null,`\u{1F3CB}\uFE0F Exercises: ${b.length}`)),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>j(!1)},"Go Back"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{j(!1),st()},disabled:x},"\u2713 Finish")))))}if(p==="finished"){let t=[e.createElement("p",{key:"type"},`Type: ${n}`),e.createElement("p",{key:"duration"},`\u23F1 Duration: ${O(c)}`)];if(n==="Workout"){let s=b.reduce((d,f)=>d+f.sets*f.reps,0),l=b.reduce((d,f)=>d+f.sets*f.reps*f.weight,0);t.push(e.createElement("p",{key:"exercises"},`\u{1F3CB}\uFE0F Exercises: ${b.length}`)),s>0&&t.push(e.createElement("p",{key:"total"},`\u{1F501} Total reps: ${s}`)),l>0&&t.push(e.createElement("p",{key:"volume"},`\u{1F4CA} Total volume: ${l.toFixed(1)} kg`)),b.length>0&&t.push(e.createElement("div",{key:"exercise-list",className:"tvs-summary-exercises"},e.createElement("h4",null,"Exercises:"),b.map((d,f)=>e.createElement("div",{key:f,className:"tvs-summary-exercise"},`${f+1}. ${d.name} (${d.sets} \xD7 ${d.reps}${d.metric_type==="time"?"s":""}${d.weight>0?` @ ${d.weight}kg`:""})`))))}else if(n==="Swim")t.push(e.createElement("p",{key:"laps"},`\u{1F3CA} Laps: ${k}`),e.createElement("p",{key:"pool"},`\u{1F4CF} Pool Length: ${I}m`),e.createElement("p",{key:"distance"},`\u{1F4CD} Distance: ${(k*I/1e3).toFixed(2)} km`)),$>0&&t.push(e.createElement("p",{key:"pace"},`\u26A1 Avg Pace: ${$} sec/lap`));else{if(t.push(e.createElement("p",{key:"distance"},`\u{1F4CD} Distance: ${g.toFixed(2)} km`)),g>0&&c>0){let s=(g/(c/3600)).toFixed(1);t.push(e.createElement("p",{key:"speed"},`\u26A1 Avg Speed: ${s} km/h`))}F>0&&t.push(e.createElement("p",{key:"incline"},`\u26F0\uFE0F Incline: ${F.toFixed(1)}%`))}return e.createElement("div",{className:"tvs-manual-tracker tvs-finished",ref:te},e.createElement("h3",null,"\u{1F389} Activity Saved!"),e.createElement("div",{className:"tvs-summary"},t),Ve&&e.createElement("a",{href:Ve,className:"tvs-btn tvs-btn-primary"},"View Activity"),le&&e.createElement("button",{className:"tvs-btn tvs-btn-strava",onClick:Et,disabled:je},je?"Uploading...":"\u{1F6B4} Upload to Strava"),e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>{C("select"),L(null),D(0),T(0),Z(0),ie(0),J(0),z(0),q(0),R(0),setSets(0),setReps(0)}},"Start Another Activity"))}return null}function Dt(e){return{Run:"\u{1F3C3}",Ride:"\u{1F6B4}",Walk:"\u{1F6B6}",Hike:"\u{1F97E}",Swim:"\u{1F3CA}",Workout:"\u{1F4AA}"}[e]||"\u{1F3C3}"}function mt(){document.querySelectorAll(".tvs-manual-activity-tracker").forEach((r,h)=>{if(!r.__tvsMounted){let u=r.id||`tvs-manual-tracker-${h}`;r.id||(r.id=u),se&&pe("Mounting ManualActivityTracker block (view.js) on:",u);let S=r.getAttribute("data-title")||"Start Activity",w=r.getAttribute("data-show-type-selector")==="1",p=r.getAttribute("data-allowed-types")||"[]",C=JSON.parse(p),o=r.getAttribute("data-auto-start")==="1",M=r.getAttribute("data-default-type")||"Run";ot(We,{React:m,title:S,showTypeSelector:w,allowedTypes:C,autoStart:o,defaultType:M},r),r.__tvsMounted=!0}})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",mt):mt();})();
//# sourceMappingURL=tvs-block-manual-activity-tracker.js.map
