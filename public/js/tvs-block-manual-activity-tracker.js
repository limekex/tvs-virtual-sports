(()=>{var J=new URLSearchParams(location.search).get("tvsdebug")==="1"||window.TVS_DEBUG===!0||localStorage.getItem("tvsDev")==="1";function te(...e){J&&console.debug("[TVS]",...e)}function xe(...e){console.error("[TVS]",...e)}var et=!!(window.React&&window.ReactDOM),Et=!!(window.wp&&window.wp.element),D=Et?window.wp.element:{},ve=et?window.React:D||{},$=et?window.ReactDOM:D||null,$e=new WeakMap,gt=$&&typeof $.createRoot=="function"||D&&typeof D.createRoot=="function";function tt(e,c,b){try{let u=$e.get(b);if(u&&typeof u.unmount=="function"?(u.unmount(),$e.delete(b)):$&&typeof $.unmountComponentAtNode=="function"&&$.unmountComponentAtNode(b),gt){let p=($&&$.createRoot||D&&D.createRoot)(b);$e.set(b,p),p.render(ve.createElement(e,c));return}let M=$&&$.render||D&&D.render;if(M){M(ve.createElement(e,c),b);return}xe("Ingen render-funksjon tilgjengelig.")}catch(u){xe("Mount feilet:",u)}}var{useState:a,useEffect:P,useRef:pe}=window.React;async function Me(e,c={}){let b=e.startsWith("/wp-json")?e:`/wp-json${e}`,u=await fetch(b,{...c,headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||"",...c.headers},credentials:"include"});if(!u.ok){let M=await u.json().catch(()=>({}));throw new Error(M.message||`HTTP ${u.status}: ${u.statusText}`)}return u.json()}function Te({React:e,title:c,showTypeSelector:b,allowedTypes:u,autoStart:M,defaultType:K}){let[p,S]=a("select"),[l,q]=a("live"),[n,se]=a(K),[E,nt]=a(null),[F,ne]=a(null),[yt,Ie]=a(null),[X,fe]=a(!1),[k,ae]=a(!1),[kt,ie]=a(null),[he,at]=a(null),[Ae,it]=a(null),[De,Pe]=a(!1),[_e,T]=a(!1),[lt,le]=a(!1),[ot,be]=a(null),[O,_]=a(""),[rt,oe]=a(!1),[o,N]=a(0),[v,w]=a(0),[f,U]=a(0),[y,Y]=a(0),[g,L]=a(0),[x,W]=a(0),[I,V]=a(0),[h,B]=a(0),[C,Ee]=a(25),[d,ge]=a([]),[re,we]=a(""),[Le,ye]=a(3),[We,ke]=a(10),[Ve,Ne]=a(0),[z,ce]=a("reps"),[Q,je]=a(0),[Ce,Oe]=a(0),[Ue,Be]=a(0),[Ge,He]=a(0),[Je,Ke]=a(0),[Z,qe]=a(0),R=pe(null),G=pe(null),ee=pe(null),H=pe(null);P(()=>{H.current&&H.current.scrollIntoView({behavior:"smooth",block:"start"})},[p]),P(()=>{if(n==="Swim"&&h>0&&C>0){let t=parseFloat((h*C/1e3).toFixed(2));if(w(t),o>0&&h>0){let s=Math.round(o/h);Y(s)}}},[h,C,o,n]),P(()=>{M&&!b&&l==="live"&&Xe(K)},[]),P(()=>{let t=localStorage.getItem("tvs_manual_session");if(t)try{let s=JSON.parse(t);s.sessionId&&s.type&&(confirm("You have an unfinished activity. Do you want to continue?")?(ne(s.sessionId),se(s.type),q(s.mode||"live"),N(s.elapsed_time||0),w(s.distance||0),U(s.speed||0),Y(s.pace||0),L(s.incline||0),W(s.cadence||0),V(s.power||0),S("tracking"),l==="live"&&(ee.current=Date.now()-(s.elapsed_time||0)*1e3,me())):localStorage.removeItem("tvs_manual_session"))}catch(s){J&&te("Failed to parse saved session:",s),localStorage.removeItem("tvs_manual_session")}},[]);let me=()=>{R.current||l==="retrospective"||(R.current=setInterval(()=>{if(ee.current){let t=Math.floor((Date.now()-ee.current)/1e3);if(N(t),l==="live"&&f>0){let s=f*t/3600;w(parseFloat(s.toFixed(2)))}}},1e3))},de=()=>{R.current&&(clearInterval(R.current),R.current=null)};P(()=>(p==="tracking"&&F&&!X&&(G.current=setInterval(()=>{Se(!1)},3e4)),()=>{G.current&&(clearInterval(G.current),G.current=null)}),[p,F,X,o,v,f,y,g,x,I]),P(()=>{p==="tracking"&&F&&localStorage.setItem("tvs_manual_session",JSON.stringify({sessionId:F,type:n,mode:l,elapsed_time:o,distance:v,speed:f,pace:y,incline:g,cadence:x,power:I}))},[p,F,o,v,f,y,g,x,I]),P(()=>()=>{de(),G.current&&clearInterval(G.current)},[]);let Xe=async t=>{ae(!0),ie(null);try{let s=await Me("/tvs/v1/activities/manual/start",{method:"POST",body:JSON.stringify({type:t})});if(s.success&&s.session_id)ne(s.session_id),Ie(s.session_data),se(t),S("tracking"),l==="live"&&(ee.current=Date.now(),me()),typeof window.tvsFlash=="function"&&window.tvsFlash(`${t} activity started!`,"success");else throw new Error(data.message||"Failed to start activity")}catch(s){ie(s.message),typeof window.tvsFlash=="function"&&window.tvsFlash(s.message,"error")}finally{ae(!1)}},Se=async(t=!0)=>{if(F)try{let s={elapsed_time:o,distance:v,speed:f,pace:y,incline:g,cadence:x,power:I};n==="Workout"&&(s.exercises=d),n==="Swim"&&(s.laps=h,s.pool_length=C);let i=await Me(`/tvs/v1/activities/manual/${F}`,{method:"PATCH",body:JSON.stringify(s)});i.success&&(Ie(i.session_data),t&&typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F4BE} Progress saved","success"))}catch(s){J&&te("Failed to update session:",s)}},Ye=async()=>{if(F){E&&(E.duration!==void 0&&N(E.duration),E.distance!==void 0&&w(E.distance),E.incline!==void 0&&L(E.incline),E.cadence!==void 0&&W(E.cadence),E.power!==void 0&&V(E.power),E.laps!==void 0&&B(E.laps),await new Promise(t=>setTimeout(t,10))),await Se(!1),ae(!0),ie(null);try{let t=await Me(`/tvs/v1/activities/manual/${F}/finish`,{method:"POST"});if(t.success&&t.activity_id)at(t.activity_id),it(t.permalink),S("finished"),de(),localStorage.removeItem("tvs_manual_session"),window.dispatchEvent(new CustomEvent("tvs:activity-updated")),typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F389} Activity saved successfully!","success");else throw new Error(data.message||"Failed to finish activity")}catch(t){ie(t.message),typeof window.tvsFlash=="function"&&window.tvsFlash(t.message,"error")}finally{ae(!1)}}},ct=async()=>{if(he)try{Pe(!0);let t=await fetch(`/wp-json/tvs/v1/activities/${he}/strava`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.TVS_SETTINGS?.nonce||""},credentials:"same-origin"}),s=await t.json();if(!t.ok)throw new Error(s.message||"Upload failed");typeof window.tvsFlash=="function"&&window.tvsFlash("\u{1F44D} Uploaded to Strava!","success"),window.dispatchEvent(new CustomEvent("tvs:activity-updated"))}catch(t){console.error("Strava upload failed:",t),typeof window.tvsFlash=="function"&&window.tvsFlash("Failed to upload to Strava: "+(t?.message||String(t)),"error")}finally{Pe(!1)}},mt=()=>{le(!0)},dt=()=>{localStorage.removeItem("tvsManualActivitySession"),se(""),N(0),w(0),U(0),L(0),W(0),V(0),B(0),Ee(25),ge([]),we(""),ye(3),ke(10),Ne(0),ce("reps"),fe(!1),ne(null),S("select"),le(!1),typeof window.tvsFlash=="function"&&window.tvsFlash("Activity cancelled","info")},ut=()=>{X?(ee.current=Date.now()-o*1e3,fe(!1),me(),typeof window.tvsFlash=="function"&&window.tvsFlash("\u25B6\uFE0F Activity resumed","success")):(de(),fe(!0),typeof window.tvsFlash=="function"&&window.tvsFlash("\u23F8 Activity paused","info"))},A=t=>{let s=Math.floor(t/3600),i=Math.floor(t%3600/60),r=t%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},vt=t=>{let s=Math.floor(t/60),i=t%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},ze=t=>{if(!t)return 0;let s=t.split(":").map(i=>parseInt(i,10)||0);return s.length===3?s[0]*3600+s[1]*60+s[2]:s.length===2?s[0]*60+s[1]:s[0]},ue=(t,s)=>{switch(t){case"duration":let i=ze(s);N(Math.max(0,i));break;case"distance":w(Math.max(0,parseFloat(s)||0));break;case"speed":U(Math.max(0,parseFloat(s)||0));break;case"incline":L(Math.max(-5,Math.min(15,parseFloat(s)||0)));break;case"cadence":W(Math.max(0,parseInt(s,10)||0));break;case"power":V(Math.max(0,parseInt(s,10)||0));break;case"laps":B(Math.max(0,parseInt(s,10)||0));break}be(null),_("")};P(()=>{f>0?Y(parseFloat((60/f).toFixed(2))):Y(0)},[f]);let Qe=(()=>{let s={Run:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Walk:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Hike:{display:["distance","speed","pace","incline"],controls:["speed","incline","cadence"]},Ride:{display:["distance","speed","incline","cadence"],controls:["speed","incline","cadence","power"]},Swim:{display:["laps","poolLength","distance","pace"],controls:["laps","poolLength"]},Workout:{display:[],controls:[]}}[n]||{display:["distance","speed","pace"],controls:["speed"]};return l==="retrospective"&&(["Run","Walk","Hike","Ride"].includes(n)?(s.controls=["distance","duration","incline","cadence"],n==="Ride"&&s.controls.push("power")):n==="Swim"?s.controls=["laps","poolLength","duration"]:n==="Workout"&&(s.controls=["duration"])),s})(),pt=t=>{let i={distance:{label:"Distance (km)",value:v.toFixed(2)},speed:{label:"Speed (km/h)",value:f.toFixed(1)},pace:{label:n==="Swim"?"Pace (sec/lap)":"Pace (min/km)",value:y>0?n==="Swim"?y:vt(y):"\u2014"},incline:{label:"Incline (%)",value:g.toFixed(1)},cadence:{label:n==="Run"?"Cadence (SPM)":"Cadence (RPM)",value:x},laps:{label:"Laps",value:h},poolLength:{label:"Pool Length (m)",value:C}}[t];return i?e.createElement("div",{className:"tvs-metric",key:t},e.createElement("label",null,i.label),e.createElement("div",{className:"tvs-metric-value"},i.value)):null},ft=t=>{let i={distance:{label:"Distance (km)",value:v.toFixed(2),onDecrease:()=>w(Math.max(0,parseFloat((v-.1).toFixed(2)))),onIncrease:()=>w(parseFloat((v+.1).toFixed(2)))},duration:{label:"Duration (h:mm:ss)",value:A(o),onDecrease:()=>N(Math.max(0,o-60)),onIncrease:()=>N(o+60)},speed:{label:"Speed (km/h)",value:f.toFixed(1),onDecrease:()=>U(Math.max(0,f-.5)),onIncrease:()=>U(f+.5)},incline:{label:"Incline (%)",value:g.toFixed(1)+"%",onDecrease:()=>L(Math.max(-5,parseFloat((g-.5).toFixed(1)))),onIncrease:()=>L(Math.min(15,parseFloat((g+.5).toFixed(1))))},cadence:{label:n==="Run"?"Cadence (SPM)":"Cadence (RPM)",value:x,onDecrease:()=>W(Math.max(0,x-5)),onIncrease:()=>W(x+5)},power:{label:"Power (W)",value:I,onDecrease:()=>V(Math.max(0,I-10)),onIncrease:()=>V(I+10)},laps:{label:"Laps",value:h,onDecrease:()=>B(Math.max(0,h-1)),onIncrease:()=>B(h+1)},poolLength:{label:"Pool Length (m)",value:C,onDecrease:()=>Ee(25),onIncrease:()=>Ee(50)}}[t];if(!i)return null;let r=ot===t,m=l==="retrospective";return e.createElement("div",{className:"tvs-control-row",key:t},e.createElement("label",null,i.label),e.createElement("div",{className:"tvs-control-buttons"},(t==="duration"||t==="distance")&&m&&e.createElement("button",{onClick:t==="duration"?()=>N(Math.max(0,o-1)):()=>w(Math.max(0,parseFloat((v-.01).toFixed(2)))),className:"tvs-btn-small"},t==="duration"?"\u22121s":"\u22120.01"),e.createElement("button",{onClick:i.onDecrease},"\u2212"),r?e.createElement("input",{type:"text",className:"tvs-inline-edit",value:O,onChange:j=>_(j.target.value),onBlur:()=>ue(t,O),onKeyDown:j=>{j.key==="Enter"&&ue(t,O),j.key==="Escape"&&(be(null),_(""))},autoFocus:!0,placeholder:t==="duration"?"h:mm:ss":i.value}):e.createElement("span",{onClick:m?()=>{be(t),_(t==="duration"?A(o):t==="distance"?v.toFixed(2):t==="speed"?f.toFixed(1):t==="incline"?g.toFixed(1):String(i.value))}:null,className:m?"tvs-editable":"",title:m?"Click to edit":""},i.value),e.createElement("button",{onClick:i.onIncrease},"+"),(t==="duration"||t==="distance")&&m&&e.createElement("button",{onClick:t==="duration"?()=>N(o+1):()=>w(parseFloat((v+.01).toFixed(2))),className:"tvs-btn-small"},t==="duration"?"+1s":"+0.01")))};if(p==="select")return e.createElement("div",{className:"tvs-manual-tracker tvs-card",ref:H},e.createElement("h3",{className:"tvs-tracker-title"},c),e.createElement("div",{className:"tvs-mode-selector"},e.createElement("button",{className:`tvs-mode-btn ${l==="live"?"active":""}`,onClick:()=>q("live")},"\u23F1\uFE0F Track Live",e.createElement("span",{className:"tvs-mode-desc"},"Real-time tracking")),e.createElement("button",{className:`tvs-mode-btn ${l==="retrospective"?"active":""}`,onClick:()=>q("retrospective")},"\u{1F4DD} Log Past Activity",e.createElement("span",{className:"tvs-mode-desc"},"Enter completed activity"))),b&&e.createElement("div",{className:"tvs-type-selector"},u.map(t=>e.createElement("button",{key:t,className:`tvs-type-btn ${n===t?"active":""}`,onClick:()=>se(t),disabled:k},wt(t),e.createElement("span",null,t)))),e.createElement("button",{className:"tvs-btn tvs-btn-primary",onClick:()=>Xe(n),disabled:k},k?"Starting...":`Start ${n}`));if(p==="tracking")return e.createElement("div",{className:"tvs-manual-tracker tvs-dashboard tvs-card",ref:H},e.createElement("div",{className:"tvs-dashboard-header"},e.createElement("div",null,e.createElement("h3",{className:"tvs-tracker-title"},`${n} Activity`),e.createElement("span",{className:"tvs-badge tvs-badge-accent",style:{fontSize:"var(--tvs-text-xs)",marginTop:"var(--tvs-space-1)"}},l==="retrospective"?"\u{1F4DD} Retrospective":"\u23F1\uFE0F Live")),rt?e.createElement("input",{type:"text",className:"tvs-timer-edit",value:O,onChange:t=>_(t.target.value),onBlur:()=>{ue("duration",O),oe(!1)},onKeyDown:t=>{t.key==="Enter"&&(ue("duration",O),oe(!1)),t.key==="Escape"&&(oe(!1),_(""))},autoFocus:!0,placeholder:"h:mm:ss"}):e.createElement("div",{className:l==="retrospective"?"tvs-timer tvs-timer-editable":"tvs-timer",onClick:l==="retrospective"?()=>{oe(!0),_(A(o))}:null,title:l==="retrospective"?"Click to edit time":""},A(o))),e.createElement("div",{className:"tvs-metrics-grid"},Qe.display.map(pt)),e.createElement("div",{className:"tvs-controls"},e.createElement("h4",null,"Adjust Metrics"),l==="retrospective"&&e.createElement("p",{className:"tvs-controls-hint"},"\u{1F4A1} Click on any value to edit directly"),Qe.controls.map(ft)),n==="Workout"&&e.createElement("div",{className:"tvs-workout-exercises"},e.createElement("h4",null,"Strength Training"),e.createElement("p",{className:"tvs-workout-hint"},"Add each exercise with its sets, reps, and weight. Track different loads per exercise."),d.length>0&&e.createElement("div",{className:"tvs-exercise-list"},d.map((t,s)=>e.createElement("div",{key:s,className:"tvs-exercise-item"},e.createElement("span",{className:"tvs-exercise-number"},`${s+1}.`),e.createElement("span",{className:"tvs-exercise-name"},t.name),e.createElement("span",{className:"tvs-exercise-stats"},`${t.sets} \xD7 ${t.reps}${t.metric_type==="time"?"s":""}${t.weight>0?` @ ${t.weight}kg`:""}`),e.createElement("button",{className:"tvs-btn-icon",onClick:()=>{ge(d.filter((i,r)=>r!==s))},title:"Remove exercise"},"\u2715")))),e.createElement("div",{className:"tvs-add-exercise"},e.createElement("div",{className:"tvs-exercise-form-header"},e.createElement("label",{className:"tvs-form-label tvs-form-label-name"},"Exercise Name"),e.createElement("label",{className:"tvs-form-label tvs-form-label-sets"},"Sets"),e.createElement("div",{className:"tvs-form-label tvs-form-label-reps tvs-metric-type-toggle"},e.createElement("button",{type:"button",className:z==="reps"?"tvs-toggle-btn tvs-toggle-active":"tvs-toggle-btn",onClick:()=>ce("reps"),title:"Repetitions"},"\u{1F522}"),e.createElement("button",{type:"button",className:z==="time"?"tvs-toggle-btn tvs-toggle-active":"tvs-toggle-btn",onClick:()=>ce("time"),title:"Time (seconds)"},"\u23F1")),e.createElement("label",{className:"tvs-form-label tvs-form-label-weight"},"Weight (kg)")),e.createElement("div",{className:"tvs-exercise-form-inputs"},e.createElement("input",{type:"text",placeholder:"e.g., Squats, Bench Press",value:re,onChange:t=>we(t.target.value),className:"tvs-exercise-input tvs-input-name"}),e.createElement("input",{type:"number",placeholder:"3",value:Le,min:"1",onChange:t=>ye(Math.max(1,parseInt(t.target.value)||1)),className:"tvs-exercise-number tvs-input-sets"}),e.createElement("input",{type:"number",placeholder:z==="reps"?"10":"60",value:We,min:"1",onChange:t=>ke(Math.max(1,parseInt(t.target.value)||1)),className:"tvs-exercise-number tvs-input-reps",title:z==="reps"?"Repetitions":"Seconds"}),e.createElement("input",{type:"number",placeholder:"0",value:Ve,min:"0",step:"0.5",onChange:t=>Ne(Math.max(0,parseFloat(t.target.value)||0)),className:"tvs-exercise-number tvs-input-weight"}),e.createElement("button",{className:"tvs-btn tvs-btn-secondary tvs-btn-add-exercise",onClick:()=>{re.trim()&&(ge([...d,{name:re.trim(),sets:Le,reps:We,weight:Ve,metric_type:z}]),we(""),ye(3),ke(10),Ne(0),ce("reps"))},disabled:!re.trim()},"+ Add"))),d.length>0&&e.createElement("div",{className:"tvs-circuit-summary"},e.createElement("p",null,`\u{1F4CB} ${d.length} exercises`),e.createElement("p",null,`\u{1F4AA} ${d.reduce((t,s)=>t+s.sets*s.reps,0)} total reps`),(()=>{let t=d.reduce((s,i)=>s+i.sets*i.reps*i.weight,0);return t>0&&e.createElement("p",null,`\u{1F3CB}\uFE0F Total volume: ${t.toFixed(1)} kg`)})())),e.createElement("div",{className:"tvs-action-buttons"},l==="live"&&e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:ut,disabled:k},X?"\u25B6\uFE0F Resume":"\u23F8 Pause"),l==="live"&&e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:Se,disabled:k},"\u{1F4BE} Save Progress"),e.createElement("button",{className:"tvs-btn tvs-btn-danger",onClick:mt,disabled:k},"\u2715 Cancel"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{if(n==="Workout"&&d.length===0){typeof window.tvsFlash=="function"&&window.tvsFlash("\u26A0\uFE0F Add at least one exercise before finishing","error");return}l==="live"?(de(),je(o),Oe(v),Be(g),He(x),Ke(I),qe(h),S("calibration")):T(!0)},disabled:k},k?"Finishing...":"\u2713 Finish Activity")),X&&e.createElement("div",{className:"tvs-paused-notice tvs-badge tvs-badge-primary"},"\u23F8 Activity paused"),lt&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>le(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u26A0\uFE0F Cancel Activity?"),e.createElement("p",{className:"tvs-modal-text"},"Are you sure you want to cancel this activity? All data will be lost and cannot be recovered."),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>le(!1)},"Keep Activity"),e.createElement("button",{className:"tvs-btn tvs-btn-danger",onClick:dt},"\u2715 Cancel Activity")))),_e&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>T(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u{1F3C1} Finish Activity?"),e.createElement("p",{className:"tvs-modal-text"},`Are you sure you want to finish this ${n.toLowerCase()} activity?`),e.createElement("div",{className:"tvs-modal-summary"},e.createElement("div",null,`\u23F1 Duration: ${A(o)}`),n!=="Workout"&&e.createElement("div",null,`\u{1F4CD} Distance: ${v.toFixed(2)} km`),n==="Swim"&&e.createElement("div",null,`\u{1F3CA} Laps: ${h}`),n==="Swim"&&y>0&&e.createElement("div",null,`\u26A1 Pace: ${y} sec/lap`),n==="Workout"&&e.createElement("div",null,`\u{1F4AA} Sets: ${sets} \xD7 ${reps} reps`)),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>T(!1)},"Go Back"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{T(!1),Ye()},disabled:k},"\u2713 Finish")))));if(p==="calibration"){let t=()=>{nt({duration:Q,distance:Ce,incline:Ue,cadence:Ge,power:Je,laps:Z}),T(!0)},s=()=>{S("tracking"),l==="live"&&me()},i=(r,m,j,Ze="",ht=.01,Fe="number")=>e.createElement("div",{className:"tvs-calibration-field"},e.createElement("label",null,r),e.createElement("div",{className:"tvs-calibration-input-group"},e.createElement("input",{type:Fe,value:Fe==="text"?A(m):m,onChange:Re=>{if(Fe==="text"){let bt=ze(Re.target.value);j(bt)}else j(parseFloat(Re.target.value)||0)},step:ht,min:0,className:"tvs-calibration-input",placeholder:r}),Ze&&e.createElement("span",{className:"tvs-calibration-unit"},Ze)));return e.createElement("div",{className:"tvs-manual-tracker tvs-calibration",ref:H},e.createElement("h3",null,"\u{1F3AF} Calibrate Your Results"),e.createElement("p",{className:"tvs-calibration-hint"},"Adjust values to match your equipment (treadmill, bike computer, watch, etc.)"),e.createElement("div",{className:"tvs-calibration-grid"},i("Duration",Q,je,"",1,"text"),["Run","Walk","Hike","Ride"].includes(n)&&i("Distance",Ce,Oe,"km",.01),["Run","Walk","Hike","Ride"].includes(n)&&i("Incline",Ue,Be,"%",.5),["Run","Walk","Hike","Ride"].includes(n)&&i("Cadence",Ge,He,"spm",1),n==="Ride"&&i("Power",Je,Ke,"W",1),n==="Swim"&&i("Laps",Z,qe,"",1)),e.createElement("div",{className:"tvs-calibration-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:s},"\u2190 Back to Tracking"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:t},"\u2713 Confirm & Finish")),_e&&e.createElement("div",{className:"tvs-modal-overlay",onClick:()=>T(!1)},e.createElement("div",{className:"tvs-modal tvs-card",onClick:r=>r.stopPropagation()},e.createElement("h3",{className:"tvs-modal-title"},"\u{1F3C1} Finish Activity?"),e.createElement("p",{className:"tvs-modal-text"},`Are you sure you want to finish this ${n.toLowerCase()} activity with the calibrated values?`),e.createElement("div",{className:"tvs-modal-summary"},e.createElement("div",null,`\u23F1 Duration: ${A(Q)}`),n!=="Workout"&&e.createElement("div",null,`\u{1F4CD} Distance: ${Ce.toFixed(2)} km`),n==="Swim"&&e.createElement("div",null,`\u{1F3CA} Laps: ${Z}`),n==="Swim"&&Z>0&&Q>0&&e.createElement("div",null,`\u26A1 Pace: ${Math.round(Q/Z)} sec/lap`),n==="Workout"&&d.length>0&&e.createElement("div",null,`\u{1F3CB}\uFE0F Exercises: ${d.length}`)),e.createElement("div",{className:"tvs-modal-actions"},e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>T(!1)},"Go Back"),e.createElement("button",{className:"tvs-btn tvs-btn-finish",onClick:()=>{T(!1),Ye()},disabled:k},"\u2713 Finish")))))}if(p==="finished"){let t=[e.createElement("p",{key:"type"},`Type: ${n}`),e.createElement("p",{key:"duration"},`\u23F1 Duration: ${A(o)}`)];if(n==="Workout"){let s=d.reduce((r,m)=>r+m.sets*m.reps,0),i=d.reduce((r,m)=>r+m.sets*m.reps*m.weight,0);t.push(e.createElement("p",{key:"exercises"},`\u{1F3CB}\uFE0F Exercises: ${d.length}`)),s>0&&t.push(e.createElement("p",{key:"total"},`\u{1F501} Total reps: ${s}`)),i>0&&t.push(e.createElement("p",{key:"volume"},`\u{1F4CA} Total volume: ${i.toFixed(1)} kg`)),d.length>0&&t.push(e.createElement("div",{key:"exercise-list",className:"tvs-summary-exercises"},e.createElement("h4",null,"Exercises:"),d.map((r,m)=>e.createElement("div",{key:m,className:"tvs-summary-exercise"},`${m+1}. ${r.name} (${r.sets} \xD7 ${r.reps}${r.metric_type==="time"?"s":""}${r.weight>0?` @ ${r.weight}kg`:""})`))))}else if(n==="Swim")t.push(e.createElement("p",{key:"laps"},`\u{1F3CA} Laps: ${h}`),e.createElement("p",{key:"pool"},`\u{1F4CF} Pool Length: ${C}m`),e.createElement("p",{key:"distance"},`\u{1F4CD} Distance: ${(h*C/1e3).toFixed(2)} km`)),y>0&&t.push(e.createElement("p",{key:"pace"},`\u26A1 Avg Pace: ${y} sec/lap`));else{if(t.push(e.createElement("p",{key:"distance"},`\u{1F4CD} Distance: ${v.toFixed(2)} km`)),v>0&&o>0){let s=(v/(o/3600)).toFixed(1);t.push(e.createElement("p",{key:"speed"},`\u26A1 Avg Speed: ${s} km/h`))}g>0&&t.push(e.createElement("p",{key:"incline"},`\u26F0\uFE0F Incline: ${g.toFixed(1)}%`))}return e.createElement("div",{className:"tvs-manual-tracker tvs-finished",ref:H},e.createElement("h3",null,"\u{1F389} Activity Saved!"),e.createElement("div",{className:"tvs-summary"},t),Ae&&e.createElement("a",{href:Ae,className:"tvs-btn tvs-btn-primary"},"View Activity"),he&&e.createElement("button",{className:"tvs-btn tvs-btn-strava",onClick:ct,disabled:De},De?"Uploading...":"\u{1F6B4} Upload to Strava"),e.createElement("button",{className:"tvs-btn tvs-btn-secondary",onClick:()=>{S("select"),ne(null),N(0),w(0),U(0),Y(0),L(0),W(0),V(0),B(0),setSets(0),setReps(0)}},"Start Another Activity"))}return null}function wt(e){return{Run:"\u{1F3C3}",Ride:"\u{1F6B4}",Walk:"\u{1F6B6}",Hike:"\u{1F97E}",Swim:"\u{1F3CA}",Workout:"\u{1F4AA}"}[e]||"\u{1F3C3}"}function st(){document.querySelectorAll(".tvs-manual-activity-tracker").forEach((c,b)=>{if(!c.__tvsMounted){let u=c.id||`tvs-manual-tracker-${b}`;c.id||(c.id=u),J&&te("Mounting ManualActivityTracker block (view.js) on:",u);let M=c.getAttribute("data-title")||"Start Activity",K=c.getAttribute("data-show-type-selector")==="1",p=c.getAttribute("data-allowed-types")||"[]",S=JSON.parse(p),l=c.getAttribute("data-auto-start")==="1",q=c.getAttribute("data-default-type")||"Run";tt(Te,{React:ve,title:M,showTypeSelector:K,allowedTypes:S,autoStart:l,defaultType:q},c),c.__tvsMounted=!0}})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",st):st();})();
//# sourceMappingURL=tvs-block-manual-activity-tracker.js.map
