{
  "version": 3,
  "sources": ["../../src/blocks/activity-stats-dashboard/view.js"],
  "sourcesContent": ["/**\n * Activity Stats Dashboard Block - Frontend View\n * \n * Displays comprehensive activity statistics with optional charts\n */\n\nconst { createElement: h, useState, useEffect } = window.React;\n\nfunction StatCard({ label, value, unit, icon }) {\n    return h('div', { className: 'tvs-stat-card' },\n        icon && h('div', { className: 'tvs-stat-card__icon' }, icon),\n        h('div', { className: 'tvs-stat-card__content' },\n            h('div', { className: 'tvs-stat-card__label' }, label),\n            h('div', { className: 'tvs-stat-card__value' },\n                value,\n                unit && h('span', { className: 'tvs-stat-card__unit' }, ` ${unit}`)\n            )\n        )\n    );\n}\n\nfunction TypeBreakdown({ data }) {\n    if (!data || !data.length) {\n        return null;\n    }\n\n    const total = data.reduce((sum, item) => sum + item.count, 0);\n\n    return h('div', { className: 'tvs-type-breakdown' },\n        h('h4', { className: 'tvs-type-breakdown__title' }, 'Activity Types'),\n        h('div', { className: 'tvs-type-breakdown__list' },\n            data.map((item, idx) => {\n                const percentage = Math.round((item.count / total) * 100);\n                return h('div', { key: idx, className: 'tvs-type-breakdown__item' },\n                    h('div', { className: 'tvs-type-breakdown__bar-wrapper' },\n                        h('div', { \n                            className: 'tvs-type-breakdown__bar',\n                            style: { width: `${percentage}%` }\n                        })\n                    ),\n                    h('div', { className: 'tvs-type-breakdown__label' },\n                        h('span', { className: 'tvs-type-breakdown__name' }, item.name || 'Unknown'),\n                        h('span', { className: 'tvs-type-breakdown__count' }, `${item.count} (${percentage}%)`)\n                    )\n                );\n            })\n        )\n    );\n}\n\nfunction PeriodSelector({ current, onChange }) {\n    const periods = [\n        { value: '7d', label: '7 Days' },\n        { value: '30d', label: '30 Days' },\n        { value: '90d', label: '90 Days' },\n        { value: 'all', label: 'All Time' }\n    ];\n\n    return h('div', { className: 'tvs-period-selector' },\n        periods.map(period =>\n            h('button', {\n                key: period.value,\n                className: `tvs-period-selector__button ${current === period.value ? 'tvs-period-selector__button--active' : ''}`,\n                onClick: () => onChange(period.value)\n            }, period.label)\n        )\n    );\n}\n\nfunction ActivityStatsDashboard({ userId, initialPeriod, title, showCharts }) {\n    const [stats, setStats] = useState(null);\n    const [period, setPeriod] = useState(initialPeriod);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    useEffect(() => {\n        fetchStats();\n    }, [period, userId]);\n\n    const fetchStats = async () => {\n        setLoading(true);\n        setError(null);\n\n        try {\n            const url = `${window.TVS_SETTINGS.restRoot}tvs/v1/activities/stats?user_id=${userId}&period=${period}`;\n            const response = await fetch(url, {\n                headers: {\n                    'X-WP-Nonce': window.TVS_SETTINGS.nonce\n                }\n            });\n\n            if (!response.ok) {\n                throw new Error('Failed to fetch statistics');\n            }\n\n            const data = await response.json();\n            setStats(data);\n        } catch (err) {\n            console.error('Error fetching stats:', err);\n            setError(err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (loading) {\n        return h('div', { className: 'tvs-stats-dashboard tvs-stats-dashboard--loading' },\n            h('div', { className: 'tvs-loading-spinner' })\n        );\n    }\n\n    if (error) {\n        return h('div', { className: 'tvs-stats-dashboard tvs-stats-dashboard--error' },\n            h('p', { className: 'tvs-error-message' }, error)\n        );\n    }\n\n    if (!stats || stats.total_activities === 0) {\n        return h('div', { className: 'tvs-stats-dashboard tvs-stats-dashboard--empty' },\n            h('p', { className: 'tvs-empty-message' }, 'No activities found for this period.')\n        );\n    }\n\n    // Format distance (meters to km)\n    const distanceKm = (stats.total_distance_m / 1000).toFixed(1);\n    \n    // Format duration (seconds to hours:minutes)\n    const hours = Math.floor(stats.total_duration_s / 3600);\n    const minutes = Math.floor((stats.total_duration_s % 3600) / 60);\n    const durationFormatted = hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;\n    \n    // Format average rating\n    const avgRating = stats.avg_rating ? stats.avg_rating.toFixed(1) : 'N/A';\n\n    return h('div', { className: 'tvs-stats-dashboard' },\n        h('div', { className: 'tvs-stats-dashboard__header' },\n            h('h3', { className: 'tvs-stats-dashboard__title' }, title),\n            h(PeriodSelector, { current: period, onChange: setPeriod })\n        ),\n        \n        h('div', { className: 'tvs-stats-dashboard__summary' },\n            h(StatCard, { \n                label: 'Total Activities', \n                value: stats.total_activities,\n                icon: '\uD83C\uDFC3'\n            }),\n            h(StatCard, { \n                label: 'Total Distance', \n                value: distanceKm, \n                unit: 'km',\n                icon: '\uD83D\uDCCF'\n            }),\n            h(StatCard, { \n                label: 'Total Time', \n                value: durationFormatted,\n                icon: '\u23F1\uFE0F'\n            }),\n            h(StatCard, { \n                label: 'Average Rating', \n                value: avgRating,\n                icon: '\u2B50'\n            })\n        ),\n\n        showCharts && stats.activity_type_counts && stats.activity_type_counts.length > 0 &&\n            h('div', { className: 'tvs-stats-dashboard__charts' },\n                h(TypeBreakdown, { data: stats.activity_type_counts })\n            )\n    );\n}\n\n// Mount component when DOM is ready\nfunction mountDashboard() {\n    const containers = document.querySelectorAll('.tvs-stats-dashboard-block');\n    \n    containers.forEach(container => {\n        const userId = parseInt(container.dataset.userId) || 0;\n        const period = container.dataset.period || '30d';\n        const title = container.dataset.title || 'Activity Dashboard';\n        const showCharts = container.dataset.showCharts === '1';\n\n        const root = window.ReactDOM.createRoot(container);\n        root.render(\n            h(ActivityStatsDashboard, {\n                userId,\n                initialPeriod: period,\n                title,\n                showCharts\n            })\n        );\n    });\n}\n\n// Auto-mount on DOM ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', mountDashboard);\n} else {\n    mountDashboard();\n}\n"],
  "mappings": "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",
  "names": ["h", "useState", "useEffect", "StatCard", "label", "value", "unit", "icon", "TypeBreakdown", "data", "total", "sum", "item", "idx", "percentage", "PeriodSelector", "current", "onChange", "period", "ActivityStatsDashboard", "userId", "initialPeriod", "title", "showCharts", "stats", "setStats", "setPeriod", "loading", "setLoading", "error", "setError", "fetchStats", "url", "response", "err", "distanceKm", "hours", "minutes", "durationFormatted", "avgRating", "mountDashboard", "container"]
}
