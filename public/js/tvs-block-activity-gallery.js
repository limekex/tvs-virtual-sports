(()=>{var{createElement:t,useState:b,useEffect:F}=window.React;function P({userId:e,limit:s,title:o,layout:r,columns:i,showFilters:n}){let[c,v]=b([]),[m,g]=b(!0),[d,u]=b(null),[f,k]=b("all"),[y,p]=b("all"),[x,C]=b("newest"),[z,R]=b(null),[A,T]=b(1),[S,D]=b(0);F(()=>{$()},[A]);let $=async()=>{g(!0),u(null);try{let a=`${window.TVS_SETTINGS.restRoot}tvs/v1/activities/me?per_page=${s}&page=${A}`,l=await fetch(a,{headers:{"X-WP-Nonce":window.TVS_SETTINGS.nonce}});if(!l.ok)throw new Error("Failed to fetch activities");let h=await l.json(),N=parseInt(l.headers.get("X-WP-Total")||"0"),B=parseInt(l.headers.get("X-WP-TotalPages")||"1");v(h||[]),D(B)}catch(a){console.error("Error fetching activities:",a),u(a.message)}finally{g(!1)}},W=c.filter(a=>{if(f!=="all"){let l=a.meta.activity_type;if(Array.isArray(l)&&l.length>0&&(l=l[0]),typeof l!="string"&&(l="workout"),l.toLowerCase()!==f.toLowerCase())return!1}if(y!=="all"){let l=new Date(a.date),N=Math.floor((new Date-l)/(1e3*60*60*24));if(y==="7d"&&N>7||y==="30d"&&N>30||y==="90d"&&N>90)return!1}return!0}).sort((a,l)=>{if(x==="newest")return new Date(l.date)-new Date(a.date);if(x==="oldest")return new Date(a.date)-new Date(l.date);if(x==="distance"){let h=parseFloat(Array.isArray(a.meta.distance_m)?a.meta.distance_m[0]:a.meta.distance_m)||0;return(parseFloat(Array.isArray(l.meta.distance_m)?l.meta.distance_m[0]:l.meta.distance_m)||0)-h}if(x==="rating"){let h=parseInt(Array.isArray(a.meta.rating)?a.meta.rating[0]:a.meta.rating)||0;return(parseInt(Array.isArray(l.meta.rating)?l.meta.rating[0]:l.meta.rating)||0)-h}return 0});return m?t("div",{className:"tvs-gallery-loading"},t("div",{className:"tvs-loading-spinner"})):d?t("div",{className:"tvs-gallery-error"},t("p",null,`Error: ${d}`)):t("div",{className:"tvs-activity-gallery"},[t("div",{className:"tvs-gallery-header"},[t("h2",{className:"tvs-gallery-title"},o),n&&t("div",{className:"tvs-gallery-filters"},[t("select",{className:"tvs-filter-select",value:f,onChange:a=>k(a.target.value)},[t("option",{value:"all"},"All Types"),t("option",{value:"run"},"\u{1F3C3} Run"),t("option",{value:"ride"},"\u{1F6B4} Ride"),t("option",{value:"walk"},"\u{1F6B6} Walk"),t("option",{value:"hike"},"\u26F0\uFE0F Hike"),t("option",{value:"swim"},"\u{1F3CA} Swim"),t("option",{value:"workout"},"\u{1F4AA} Workout")]),t("select",{className:"tvs-filter-select",value:y,onChange:a=>p(a.target.value)},[t("option",{value:"all"},"All Time"),t("option",{value:"7d"},"Last 7 Days"),t("option",{value:"30d"},"Last 30 Days"),t("option",{value:"90d"},"Last 90 Days")]),t("select",{className:"tvs-filter-select",value:x,onChange:a=>C(a.target.value)},[t("option",{value:"newest"},"Newest First"),t("option",{value:"oldest"},"Oldest First"),t("option",{value:"distance"},"Longest Distance"),t("option",{value:"rating"},"Best Rating")])])]),W.length===0?t("div",{className:"tvs-gallery-empty"},t("p",null,"No activities found matching your filters.")):t("div",{className:`tvs-gallery-grid tvs-gallery-grid--${r} tvs-gallery-grid--cols-${i}`},W.map(a=>t(L,{key:a.id,activity:a,onClick:()=>R(a)}))),S>1&&t("div",{className:"tvs-gallery-pagination"},[t("button",{className:"tvs-pagination-btn",disabled:A===1,onClick:()=>T(a=>a-1)},"\u2190 Previous"),t("span",{className:"tvs-pagination-info"},`Page ${A} of ${S}`),t("button",{className:"tvs-pagination-btn",disabled:A===S,onClick:()=>T(a=>a+1)},"Next \u2192")]),z&&t(E,{activity:z,onClose:()=>R(null)})])}function L({activity:e,onClick:s}){let o=e.meta.activity_type;Array.isArray(o)&&o.length>0&&(o=o[0]),typeof o!="string"&&(o="Workout");let r=e.meta.route_id;Array.isArray(r)&&r.length>0&&(r=r[0]),r=parseInt(r)||0;let i=e.meta.distance_m;Array.isArray(i)&&i.length>0&&(i=i[0]),i=parseFloat(i)||0;let n=e.meta.duration_s;Array.isArray(n)&&n.length>0&&(n=n[0]),n=parseInt(n)||0;let c=e.meta.rating;Array.isArray(c)&&c.length>0&&(c=c[0]),c=parseInt(c)||0;let v=e.meta.source;Array.isArray(v)&&v.length>0&&(v=v[0]),v=String(v||"manual").toLowerCase();let m=e.meta._tvs_manual_exercises;Array.isArray(m)&&(m=m[0]);let g=0;if(m)try{let p=JSON.parse(m);Array.isArray(p)&&(g=p.length)}catch{}let d=_(o),u=r>0,f=e.thumbnail,k=o==="Workout",y=I(v,o);return t("div",{className:`tvs-gallery-card tvs-gallery-card--${d.className}`,onClick:s,style:{background:"var(--tvs-glass-bg)",backdropFilter:"blur(var(--tvs-glass-blur))",border:"1px solid var(--tvs-glass-border)",borderRadius:"var(--tvs-radius-lg)",overflow:"hidden",cursor:"pointer",transition:"all 0.2s ease"}},[t("div",{className:"tvs-gallery-card-image",style:{display:"flex",alignItems:"center",justifyContent:"center"}},f?t("img",{className:"tvs-gallery-card-thumbnail",src:f,alt:e.title||"Activity",loading:"lazy",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center"}}):t("img",{className:"tvs-gallery-card-icon-img",src:y,alt:`${d.label} icon`,loading:"lazy",style:{maxWidth:"60%",maxHeight:"60%",width:"auto",height:"auto",objectFit:"contain"}})),t("div",{className:"tvs-gallery-card-overlay"},[t("div",{className:"tvs-gallery-card-badge"},t("span",null,d.label)),c>0&&t("div",{className:"tvs-gallery-card-rating"},Array.from({length:10}).map((p,x)=>t("span",{key:x,className:`tvs-star ${x<c?"tvs-star--filled":""}`},"\u2605")))]),t("div",{className:"tvs-gallery-card-info"},[t("div",{className:"tvs-gallery-card-metrics"},k?[g>0&&t("span",{className:"tvs-metric"},`${g} exercises`),t("span",{className:"tvs-metric"},w(n))].filter(Boolean):[t("span",{className:"tvs-metric"},`${(i/1e3).toFixed(2)} km`),t("span",{className:"tvs-metric"},w(n))]),t("div",{className:"tvs-gallery-card-date"},M(e.date))])])}function E({activity:e,onClose:s}){let o=e.meta.activity_type;Array.isArray(o)&&(o=o[0]);let r=e.meta.distance_m;Array.isArray(r)&&(r=r[0]),r=parseFloat(r)||0;let i=e.meta.duration_s;Array.isArray(i)&&(i=i[0]),i=parseInt(i)||0;let n=e.meta.rating;Array.isArray(n)&&(n=n[0]),n=parseInt(n)||0;let c=e.meta.notes;Array.isArray(c)&&(c=c[0]),c=String(c||"");let v=e.meta.source;Array.isArray(v)&&(v=v[0]),v=String(v||"manual").toLowerCase();let m=e.meta._tvs_manual_exercises;Array.isArray(m)&&(m=m[0]);let g=0;if(m)try{let p=JSON.parse(m);Array.isArray(p)&&(g=p.length)}catch{}let d=e.meta._tvs_manual_sets;Array.isArray(d)&&(d=d[0]),d=parseInt(d)||0;let u=e.meta._tvs_manual_reps;Array.isArray(u)&&(u=u[0]),u=parseInt(u)||0;let f=_(o),k=I(v,o),y=o==="Workout";return t("div",{className:"tvs-gallery-modal-overlay",onClick:s,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"var(--tvs-color-overlay-heavy)",backdropFilter:"blur(var(--tvs-blur-lg))",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"var(--tvs-z-modal)",padding:"var(--tvs-space-4)"}},[t("div",{className:"tvs-gallery-modal",onClick:p=>p.stopPropagation(),style:{background:"var(--tvs-glass-bg)",backdropFilter:"blur(var(--tvs-glass-blur))",border:"1px solid var(--tvs-glass-border)",borderRadius:"var(--tvs-radius-xl)",padding:"var(--tvs-space-8)",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"var(--tvs-shadow-2xl)",position:"relative"}},[t("button",{className:"tvs-modal-close",onClick:s,style:{position:"absolute",top:"var(--tvs-space-4)",right:"var(--tvs-space-4)",zIndex:10,background:"transparent",border:"none",fontSize:"28px",color:"var(--tvs-color-text-primary)",cursor:"pointer",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"var(--tvs-radius-md)",transition:"background 0.2s ease"}},"\xD7"),t("div",{className:"tvs-modal-header",style:{display:"flex",alignItems:"center",gap:"var(--tvs-space-3)",marginBottom:"var(--tvs-space-6)"}},[t("img",{src:k,alt:f.label,className:"tvs-modal-icon",style:{width:"40px",height:"40px",objectFit:"contain"}}),t("h3",{style:{flex:1,margin:0,fontSize:"var(--tvs-text-xl)",fontWeight:"var(--tvs-font-semibold)"}},e.title),t("span",{className:"tvs-modal-type",style:{padding:"var(--tvs-badge-padding-y) var(--tvs-badge-padding-x)",fontSize:"var(--tvs-badge-font-size)",fontWeight:"var(--tvs-badge-font-weight)",borderRadius:"var(--tvs-badge-radius)",background:"var(--tvs-color-surface-raised)",color:"var(--tvs-color-text-secondary)",textTransform:"uppercase",letterSpacing:"0.05em"}},f.label)]),t("div",{className:"tvs-modal-metrics",style:{display:"grid",gridTemplateColumns:y?"repeat(2, 1fr)":"repeat(3, 1fr)",gap:"var(--tvs-space-4)",marginBottom:"var(--tvs-space-6)"}},y?[t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Duration"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},w(i))]),g>0&&t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Exercises"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},g)]),d>0&&t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Sets"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},d)]),u>0&&t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Reps"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},u)]),n>0&&t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Rating"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},`${n}/10 \u2605`)])].filter(Boolean):[t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Distance"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},`${(r/1e3).toFixed(2)} km`)]),t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Duration"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},w(i))]),t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Pace"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},i&&r?`${(i/60/(r/1e3)).toFixed(2)} min/km`:"N/A")]),n>0&&t("div",{className:"tvs-modal-metric",style:{background:"var(--tvs-color-surface-raised)",padding:"var(--tvs-space-4)",borderRadius:"var(--tvs-radius-lg)",textAlign:"center"}},[t("span",{className:"tvs-modal-metric-label",style:{display:"block",fontSize:"var(--tvs-text-xs)",color:"var(--tvs-color-text-tertiary)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"var(--tvs-space-2)"}},"Rating"),t("span",{className:"tvs-modal-metric-value",style:{display:"block",fontSize:"var(--tvs-text-2xl)",fontWeight:"var(--tvs-font-bold)",color:"var(--tvs-color-text-primary)"}},`${n}/10 \u2605`)])].filter(Boolean)),c&&t("div",{className:"tvs-modal-notes"},[t("h4",null,"Notes"),t("p",null,c)]),t("div",{className:"tvs-modal-footer"},[t("a",{href:e.permalink,className:"tvs-modal-btn tvs-modal-btn--primary",style:{display:"inline-block",padding:"var(--tvs-button-padding-y) var(--tvs-button-padding-x)",fontSize:"var(--tvs-button-font-size)",fontWeight:"var(--tvs-button-font-weight)",borderRadius:"var(--tvs-button-radius)",background:"var(--tvs-color-primary)",color:"var(--tvs-color-text-on-primary)",textDecoration:"none",border:"none",cursor:"pointer",transition:"all 0.2s ease",textAlign:"center"}},"View Full Details"),t("button",{className:"tvs-modal-btn",onClick:s,style:{padding:"var(--tvs-button-padding-y) var(--tvs-button-padding-x)",fontSize:"var(--tvs-button-font-size)",fontWeight:"var(--tvs-button-font-weight)",borderRadius:"var(--tvs-button-radius)",background:"var(--tvs-color-surface-raised)",color:"var(--tvs-color-text-primary)",border:"1px solid var(--tvs-color-border-default)",cursor:"pointer",transition:"all 0.2s ease"}},"Close")])])])}function _(e){let s={Run:{icon:"\u{1F3C3}",label:"Run",className:"run",color:"#3b82f6"},Ride:{icon:"\u{1F6B4}",label:"Ride",className:"ride",color:"#10b981"},Walk:{icon:"\u{1F6B6}",label:"Walk",className:"walk",color:"#f59e0b"},Hike:{icon:"\u26F0\uFE0F",label:"Hike",className:"hike",color:"#f97316"},Swim:{icon:"\u{1F3CA}",label:"Swim",className:"swim",color:"#06b6d4"},Workout:{icon:"\u{1F4AA}",label:"Workout",className:"workout",color:"#a855f7"}};return s[e]||s.Workout}function w(e){if(!e)return"0m";let s=Math.floor(e/3600),o=Math.floor(e%3600/60);return s>0?`${s}h ${o}m`:`${o}m`}function M(e){let s=new Date(e),r=Math.floor((new Date-s)/(1e3*60*60*24));return r===0?"Today":r===1?"Yesterday":r<7?`${r} days ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function I(e,s){let r={Run:"run",Ride:"ride",Walk:"walk",Hike:"hike",Swim:"swim",Workout:"workout"}[s]||"workout",i=e.toLowerCase();return`${window.TVS_SETTINGS?.themeUrl||"/wp-content/themes/tvs-theme"}/assets/icons/icon-${i}-${r}.png`}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".tvs-activity-gallery-block").forEach(s=>{let o={userId:parseInt(s.dataset.userId)||0,limit:parseInt(s.dataset.limit)||12,title:s.dataset.title||"Activity Gallery",layout:s.dataset.layout||"grid",columns:parseInt(s.dataset.columns)||3,showFilters:s.dataset.showFilters==="1"};window.ReactDOM.createRoot(s).render(t(P,o))})});})();
//# sourceMappingURL=tvs-block-activity-gallery.js.map
