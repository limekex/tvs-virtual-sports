(()=>{var{createElement:t,useState:d,useEffect:T}=window.React;function i({label:r,value:e,unit:o,icon:s}){return t("div",{className:"tvs-stat-card"},s&&t("div",{className:"tvs-stat-card__icon"},s),t("div",{className:"tvs-stat-card__content"},t("div",{className:"tvs-stat-card__label"},r),t("div",{className:"tvs-stat-card__value"},e,o&&t("span",{className:"tvs-stat-card__unit"},` ${o}`))))}function $({data:r}){if(!r||!r.length)return null;let e=r.reduce((o,s)=>o+s.count,0);return t("div",{className:"tvs-type-breakdown"},t("h4",{className:"tvs-type-breakdown__title"},"Activity Types"),t("div",{className:"tvs-type-breakdown__list"},r.map((o,s)=>{let a=Math.round(o.count/e*100);return t("div",{key:s,className:"tvs-type-breakdown__item"},t("div",{className:"tvs-type-breakdown__bar-wrapper"},t("div",{className:"tvs-type-breakdown__bar",style:{width:`${a}%`}})),t("div",{className:"tvs-type-breakdown__label"},t("span",{className:"tvs-type-breakdown__name"},o.name||"Unknown"),t("span",{className:"tvs-type-breakdown__count"},`${o.count} (${a}%)`)))})))}function D({current:r,onChange:e}){return t("div",{className:"tvs-period-selector"},[{value:"7d",label:"7 Days"},{value:"30d",label:"30 Days"},{value:"90d",label:"90 Days"},{value:"all",label:"All Time"}].map(s=>t("button",{key:s.value,className:`tvs-period-selector__button ${r===s.value?"tvs-period-selector__button--active":""}`,onClick:()=>e(s.value)},s.label)))}function E({userId:r,initialPeriod:e,title:o,showCharts:s}){let[a,l]=d(null),[n,y]=d(e),[N,v]=d(!0),[u,_]=d(null);T(()=>{w()},[n,r]);let w=async()=>{v(!0),_(null);try{let c=`${window.TVS_SETTINGS.restRoot}tvs/v1/activities/stats?user_id=${r}&period=${n}`,b=await fetch(c,{headers:{"X-WP-Nonce":window.TVS_SETTINGS.nonce}});if(!b.ok)throw new Error("Failed to fetch statistics");let S=await b.json();l(S)}catch(c){console.error("Error fetching stats:",c),_(c.message)}finally{v(!1)}};if(N)return t("div",{className:"tvs-stats-dashboard tvs-stats-dashboard--loading"},t("div",{className:"tvs-loading-spinner"}));if(u)return t("div",{className:"tvs-stats-dashboard tvs-stats-dashboard--error"},t("p",{className:"tvs-error-message"},u));if(!a||a.total_activities===0)return t("div",{className:"tvs-stats-dashboard tvs-stats-dashboard--empty"},t("p",{className:"tvs-empty-message"},"No activities found for this period."));let f=(a.total_distance_m/1e3).toFixed(1),m=Math.floor(a.total_duration_s/3600),h=Math.floor(a.total_duration_s%3600/60),g=m>0?`${m}h ${h}m`:`${h}m`,k=a.avg_rating?a.avg_rating.toFixed(1):"N/A";return t("div",{className:"tvs-stats-dashboard"},t("div",{className:"tvs-stats-dashboard__header"},t("h3",{className:"tvs-stats-dashboard__title"},o),t(D,{current:n,onChange:y})),t("div",{className:"tvs-stats-dashboard__summary"},t(i,{label:"Total Activities",value:a.total_activities,icon:"\u{1F3C3}"}),t(i,{label:"Total Distance",value:f,unit:"km",icon:"\u{1F4CF}"}),t(i,{label:"Total Time",value:g,icon:"\u23F1\uFE0F"}),t(i,{label:"Average Rating",value:k,icon:"\u2B50"})),s&&a.activity_type_counts&&a.activity_type_counts.length>0&&t("div",{className:"tvs-stats-dashboard__charts"},t($,{data:a.activity_type_counts})))}function p(){document.querySelectorAll(".tvs-stats-dashboard-block").forEach(e=>{let o=parseInt(e.dataset.userId)||0,s=e.dataset.period||"30d",a=e.dataset.title||"Activity Dashboard",l=e.dataset.showCharts==="1";window.ReactDOM.createRoot(e).render(t(E,{userId:o,initialPeriod:s,title:a,showCharts:l}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();})();
//# sourceMappingURL=tvs-block-activity-stats-dashboard.js.map
